<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Controllable cardiac synthesis via disentangled anatomy arithmetic | MICCAI 2021 - Accepted Papers and Reviews</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Controllable cardiac synthesis via disentangled anatomy arithmetic" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Spyridon Thermos, Xiao Liu, Alison O’Neil, Sotirios A. Tsaftaris Abstract Acquiring annotated data at scale with rare diseases or conditions remains a challenge. It would be extremely useful to have a method that controllably synthesizes images that can correct such underrepresentation. Assuming a proper latent representation, the idea of a “latent vector arithmetic’” could offer the means of achieving such synthesis. A proper representation must encode the fidelity of the input data, preserve invariance and equivariance, and permit arithmetic operations. Motivated by the ability to disentangle images into spatial anatomy (tensor) factors and accompanying imaging (vector) representations, we propose a framework termed “disentangled anatomy arithmetic”, in which a generative model learns to combine anatomical factors of different input images such that when they are re-entangled with the desired imaging modality (e.g. MRI), plausible new cardiac images are created with the target characteristics. To encourage a realistic combination of anatomy factors after the arithmetic step, we propose a localized noise injection network that precedes the generator. Our model is used to generate realistic images, pathology labels, and segmentation masks that are used to augment the existing datasets and subsequently improve post-hoc classification and segmentation tasks. Code is publicly available at https://github.com/vios-s/DAA-GAN. Link to paper https://doi.org/10.1007/978-3-030-87199-4_15 Link to the code repository https://github.com/vios-s/DAA-GAN Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The paper proposes a novel method for cardiac image synthesis based on a Disentangled arithmetic notion. As a preprocessing step images are encoded into disentangled features that represent the anatomy of the heart and the image characteristics. Feature arithmetic is done on the anatomical factors , then Gaussian noise is introduced to them and a generator composes the end image. A discriminator and a pathology classifier are used to aid training Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Interesting and to the best of my knowledge novel framework Very well analyzed in terms of experiments, ablations and comparisons to other existing methods. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Not so much weaknesses but definitely questions that arose. The anatomical feature arithmetic, how is it conducted ? Is it simple arithmetic on the feature vectors of the anatomy ? If yes i take it that it is assumed a Euclidean underlying manifold, my concern is that in practice this assumption does not always stand, see Latent space oddity, Arvanitidis et al 2017. It would be a good idea to analyze the implicit curvature of the empirical manifold the preprocessing method creates. This way the arithmetic would be far more accurate and theoretically sound. -In general the concept of the latent space arithmetic could be better explained in the paper Technically speaking the Gaussian noise is not injected via residual connections, since residuals require the same input to be added to the output of the layer(s). AdaIN layer, please write it in full the first time it is introduced it in the text. At the top of page 5, it is mentioned that C is of the same dimension as image I, that means they are 224x224, how does this affect the computational performance of the algorithm? How does it scale as images scale ? Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The main paper together with the supplement appear to provide the required information for reproducing this paper, if the authors improve the description of the latent arithmetic then I can see no issue for reproducing this paper. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Mainly covered with my comments above Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? This is a solid paper. It proposes a novel method, that is evaluated in a very good manner and compared both in experiments and in theory with the related literature. I’ve noted a series of minor points that could be addressed to improve it event further. But I’m more than happy with the current quality of the paper, hence my acceptance rating. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper The authors proposed a novel framework that can generate realistic cardiac images with certain level of controllability of anatomical factors for data augmentation. First, disentangled anatomical representation are learnt from SDNET. Next, based on these controllable factors, a series of operations are designed to generate realistic images for augmentation. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. +The proposed method is solving an important problem of data augmentation for medical image with controllable anatomical factors, which may be very interesting to the MICCAI community. +Texts are well written and easy to follow. +Experiments are good with multiple runs and statistic test. Several important aspects of data augmentations are discussed in the results. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. -If I understand correctly, the disentanglement and the semantic meaning of anatomical factors from SDNET is not guaranteed. For example, you can not force the model to learn the factor of “left ventricular” in one specific channel. Did the authors encounter situations where no good factors are found for swapping? How did the authors chose good anatomical factors from SDNET? Eyeballing or using some metrics? -I have some concerns for applying the loss of Pathology Classifier. When the proposed networks are optimized by this loss, does it encourage the network to generate images that are easier to be classified? This somehow against the goal of data augmentation and may introduce bias when evaluating. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance method: clear dataset: open dataset and clear evaluation: clear Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html SDNET also infer a modality representation along with the anatomical representations. I might miss it, but it seems that the proposed network doesn’t use that? Why? Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Very good paper aiming at an important problem. Novel and interesting methods. No obvious flaws. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper tackles an important problem in medical imaging—generating scarce samples to facilitate downstream tasks (e.g., classification). The proposed DAA-GAN model generates new images in a target domain (usually with pathologies) in a controllable way; by first disentangling anatomical and imaging factors, manipulating the anatomical factors by plugging in pathological data, then re-entangling these factors using an image generator. Evaluations include both classification and segmentation tasks using a variety of cardiac datasets. Results are superior to comparison methods. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Comprehensive evaluation. Two cardiac datasets (ACDC and MM) with a fairly large number of subjects were used in evaluation. Quantitative comparisons including AC-GAN and SPADE show promising results after using the proposed data augmentation. Well established methodology. The paper combines several existing methods in the literature (mainly SDNet and styleGAN). The way of using injective noise to handle topology issues after label arithmetic is novel. Ablation study to show contribution of each network components. Good reproducibility. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The proposed method depends on the disentangling outputs from another model, SDNet, to obtain anatomical and imaging representations. However, SDNet is a “synthesis-segmentation” hybrid model, and it requires training labels. It is unclear how many training samples are needed to train an SDNet to produce reliable anatomy labels for DAA-GAN. The fact that multiple labels from multiple populations can be combined freely (after registration) is intriguing. However, this could also be the limitation of the work if considering that some combinations may never be observed in real data (wrong topology), despite of the noise injection. I guess this also explains why the anatomy in Fig. 4 can only be changed by a limited amount. Therefore, there is a risk of generating out-of-real-distribution data that could bias the downstream tasks. Moreover, the biggest assumption in this paper is that replacing a healthy label with a pathology label could generate an image with the corresponding disease. This assumption is questionable. One missing element in the evaluation is to quantitatively evaluate (pix-to-pix) the other regions, i.e., 1-M regions. It is necessary to show that other anatomies are preserved after manipulating anatomical factors of the ROI. Please rate the clarity and organization of this paper Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Good. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Code is available upon acceptance. A little concern is that the proposed DAA-GAN depends on the outputs of SDNet. The fact that two deep learning models need to be trained for data augmentation could potentially limit the re-implementation of the proposed method. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Some comments for clarity: Figure 1 top row was hard to understand when first referenced in the Introduction. A more detailed caption might help. Figure 2 notation \mathcal{L}_{att} was not defined or was mislabeled. Several suggestions for future work: Quantitative evaluations on the other regions—1-M regions—are necessary. It is really important to show that other anatomies are preserved after manipulating anatomical factors within the ROI. A suggested reference on hallucination: Cohen et al. Distribution matching losses can hallucinate features in medical image translation. MICCAI 2018. The effects of noise injection network can be further studied, as this is one of the core innovations of the paper. For example, after the model is trained, what would the image look like if increase the std of the Gaussian noise? A suggested reference: Zuo et al. Synthesizing Realistic Brain MR Images with Noise Control. MICCAI-SASHIMI 2020. How to extend this work to a large number of labels and control topology in the augmented images? Extension to other anatomies, e.g., brain MRIs. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Despite the limitations pointed out above, this research overall is very interesting. The paper is well-written. The novelty of including injective Gaussian noise to tackle label overlapping issues and the completeness of the evaluations are the key factors that make this work stand out from other submissions. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. All the reviewers indicate “Accept” for the paper, although they also raise concerns. From my reading of the paper I agree there are some concerns in the paper in relation to description of latent arithmetic, and loss from pathology classifier. While there are merits of the paper I believe the authors should clarify those in the final version. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 1 Author Feedback We thank the reviewers and the meta-reviewer for their valuable comments. Brief responses and clarifications to the most critical ones follow. Straightforward comments will be nevertheless addressed in the camera-ready version. R1: Rather than vectors, our arithmetic is based on spatial (tensor) factors and is realized as a swapping operation between factors of different patients. However, building on reviewer’s comment, in future work we plan to learn an explorable manifold based on spatial factors thus enabling arithmetic operations between factor values. Regarding the resolution of the input anatomical factors, the current version of DAA-GAN requires the preservation of the original image (i.e. patient’s MRI slice) resolution, thus the computational complexity of the model scales linearly with the image size. However, our DAA can be combined with any anatomy-conditioned generator architecture that may receive down-sampled spatial latent variables and use up-sampling layers to generate high-fidelity images. R2: We agree that DAA-GAN is limited by the “correctness” of the input, hence the ability of SDNet to effectively disentangle the anatomical factors. As a matter of fact, SDNet learns to encode specific factors to specific channels, and since the factors are spatial and semantic (due to the supervision with semantic masks), they are interpretable. For DAA-GAN training/testing we used factors generated by samples with high DICE score (i.e. high segmentation performance). We pretrained SDNet in a fully supervised setting, without the discriminator. Regarding the pathology classification loss, we agree with the comment that the classifier encourages “easy-to-classify” pathology generation. However, we believe that this effect is mitigated by the discriminator, which encourages in-distribution sample generation. In fact, we choose to trade intra-pathology variance (e.g. severity, as a very severe pathology is easier to classify) for introducing inter-pathology variance through the factor mixing process. Nevertheless, this observation is very interesting, and we plan to further explore the impact of the classifier in future work. Regarding the imaging factors, since SDNet encodes them in a vector latent variable using a variational setup, DAA-GAN can either sample imaging information from the learned distribution or use the extracted imaging vector of the corresponding input. In this work we follow the latter approach. R3: Regarding the limitations introduced by freely combining labels from multiple populations, we believe that realistic medical image generation is an open challenge that is far from being addressed solely by quantitative evaluation, i.e. a qualitative assessment from experts/clinicians is always required. However, our pathology classifier and our discriminator play an adversarial game with the generator, as the former encourages easy-to-classify pathologies and the latter penalizes out-of-distribution samples. We believe that this game, coupled with the mixing of existing (and not sampled from a Gaussian prior) anatomical factors, is an important step towards realistic medical image synthesis back to top" />
<meta property="og:description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Spyridon Thermos, Xiao Liu, Alison O’Neil, Sotirios A. Tsaftaris Abstract Acquiring annotated data at scale with rare diseases or conditions remains a challenge. It would be extremely useful to have a method that controllably synthesizes images that can correct such underrepresentation. Assuming a proper latent representation, the idea of a “latent vector arithmetic’” could offer the means of achieving such synthesis. A proper representation must encode the fidelity of the input data, preserve invariance and equivariance, and permit arithmetic operations. Motivated by the ability to disentangle images into spatial anatomy (tensor) factors and accompanying imaging (vector) representations, we propose a framework termed “disentangled anatomy arithmetic”, in which a generative model learns to combine anatomical factors of different input images such that when they are re-entangled with the desired imaging modality (e.g. MRI), plausible new cardiac images are created with the target characteristics. To encourage a realistic combination of anatomy factors after the arithmetic step, we propose a localized noise injection network that precedes the generator. Our model is used to generate realistic images, pathology labels, and segmentation masks that are used to augment the existing datasets and subsequently improve post-hoc classification and segmentation tasks. Code is publicly available at https://github.com/vios-s/DAA-GAN. Link to paper https://doi.org/10.1007/978-3-030-87199-4_15 Link to the code repository https://github.com/vios-s/DAA-GAN Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The paper proposes a novel method for cardiac image synthesis based on a Disentangled arithmetic notion. As a preprocessing step images are encoded into disentangled features that represent the anatomy of the heart and the image characteristics. Feature arithmetic is done on the anatomical factors , then Gaussian noise is introduced to them and a generator composes the end image. A discriminator and a pathology classifier are used to aid training Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Interesting and to the best of my knowledge novel framework Very well analyzed in terms of experiments, ablations and comparisons to other existing methods. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Not so much weaknesses but definitely questions that arose. The anatomical feature arithmetic, how is it conducted ? Is it simple arithmetic on the feature vectors of the anatomy ? If yes i take it that it is assumed a Euclidean underlying manifold, my concern is that in practice this assumption does not always stand, see Latent space oddity, Arvanitidis et al 2017. It would be a good idea to analyze the implicit curvature of the empirical manifold the preprocessing method creates. This way the arithmetic would be far more accurate and theoretically sound. -In general the concept of the latent space arithmetic could be better explained in the paper Technically speaking the Gaussian noise is not injected via residual connections, since residuals require the same input to be added to the output of the layer(s). AdaIN layer, please write it in full the first time it is introduced it in the text. At the top of page 5, it is mentioned that C is of the same dimension as image I, that means they are 224x224, how does this affect the computational performance of the algorithm? How does it scale as images scale ? Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The main paper together with the supplement appear to provide the required information for reproducing this paper, if the authors improve the description of the latent arithmetic then I can see no issue for reproducing this paper. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Mainly covered with my comments above Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? This is a solid paper. It proposes a novel method, that is evaluated in a very good manner and compared both in experiments and in theory with the related literature. I’ve noted a series of minor points that could be addressed to improve it event further. But I’m more than happy with the current quality of the paper, hence my acceptance rating. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper The authors proposed a novel framework that can generate realistic cardiac images with certain level of controllability of anatomical factors for data augmentation. First, disentangled anatomical representation are learnt from SDNET. Next, based on these controllable factors, a series of operations are designed to generate realistic images for augmentation. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. +The proposed method is solving an important problem of data augmentation for medical image with controllable anatomical factors, which may be very interesting to the MICCAI community. +Texts are well written and easy to follow. +Experiments are good with multiple runs and statistic test. Several important aspects of data augmentations are discussed in the results. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. -If I understand correctly, the disentanglement and the semantic meaning of anatomical factors from SDNET is not guaranteed. For example, you can not force the model to learn the factor of “left ventricular” in one specific channel. Did the authors encounter situations where no good factors are found for swapping? How did the authors chose good anatomical factors from SDNET? Eyeballing or using some metrics? -I have some concerns for applying the loss of Pathology Classifier. When the proposed networks are optimized by this loss, does it encourage the network to generate images that are easier to be classified? This somehow against the goal of data augmentation and may introduce bias when evaluating. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance method: clear dataset: open dataset and clear evaluation: clear Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html SDNET also infer a modality representation along with the anatomical representations. I might miss it, but it seems that the proposed network doesn’t use that? Why? Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Very good paper aiming at an important problem. Novel and interesting methods. No obvious flaws. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper tackles an important problem in medical imaging—generating scarce samples to facilitate downstream tasks (e.g., classification). The proposed DAA-GAN model generates new images in a target domain (usually with pathologies) in a controllable way; by first disentangling anatomical and imaging factors, manipulating the anatomical factors by plugging in pathological data, then re-entangling these factors using an image generator. Evaluations include both classification and segmentation tasks using a variety of cardiac datasets. Results are superior to comparison methods. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Comprehensive evaluation. Two cardiac datasets (ACDC and MM) with a fairly large number of subjects were used in evaluation. Quantitative comparisons including AC-GAN and SPADE show promising results after using the proposed data augmentation. Well established methodology. The paper combines several existing methods in the literature (mainly SDNet and styleGAN). The way of using injective noise to handle topology issues after label arithmetic is novel. Ablation study to show contribution of each network components. Good reproducibility. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The proposed method depends on the disentangling outputs from another model, SDNet, to obtain anatomical and imaging representations. However, SDNet is a “synthesis-segmentation” hybrid model, and it requires training labels. It is unclear how many training samples are needed to train an SDNet to produce reliable anatomy labels for DAA-GAN. The fact that multiple labels from multiple populations can be combined freely (after registration) is intriguing. However, this could also be the limitation of the work if considering that some combinations may never be observed in real data (wrong topology), despite of the noise injection. I guess this also explains why the anatomy in Fig. 4 can only be changed by a limited amount. Therefore, there is a risk of generating out-of-real-distribution data that could bias the downstream tasks. Moreover, the biggest assumption in this paper is that replacing a healthy label with a pathology label could generate an image with the corresponding disease. This assumption is questionable. One missing element in the evaluation is to quantitatively evaluate (pix-to-pix) the other regions, i.e., 1-M regions. It is necessary to show that other anatomies are preserved after manipulating anatomical factors of the ROI. Please rate the clarity and organization of this paper Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Good. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Code is available upon acceptance. A little concern is that the proposed DAA-GAN depends on the outputs of SDNet. The fact that two deep learning models need to be trained for data augmentation could potentially limit the re-implementation of the proposed method. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Some comments for clarity: Figure 1 top row was hard to understand when first referenced in the Introduction. A more detailed caption might help. Figure 2 notation \mathcal{L}_{att} was not defined or was mislabeled. Several suggestions for future work: Quantitative evaluations on the other regions—1-M regions—are necessary. It is really important to show that other anatomies are preserved after manipulating anatomical factors within the ROI. A suggested reference on hallucination: Cohen et al. Distribution matching losses can hallucinate features in medical image translation. MICCAI 2018. The effects of noise injection network can be further studied, as this is one of the core innovations of the paper. For example, after the model is trained, what would the image look like if increase the std of the Gaussian noise? A suggested reference: Zuo et al. Synthesizing Realistic Brain MR Images with Noise Control. MICCAI-SASHIMI 2020. How to extend this work to a large number of labels and control topology in the augmented images? Extension to other anatomies, e.g., brain MRIs. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Despite the limitations pointed out above, this research overall is very interesting. The paper is well-written. The novelty of including injective Gaussian noise to tackle label overlapping issues and the completeness of the evaluations are the key factors that make this work stand out from other submissions. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. All the reviewers indicate “Accept” for the paper, although they also raise concerns. From my reading of the paper I agree there are some concerns in the paper in relation to description of latent arithmetic, and loss from pathology classifier. While there are merits of the paper I believe the authors should clarify those in the final version. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 1 Author Feedback We thank the reviewers and the meta-reviewer for their valuable comments. Brief responses and clarifications to the most critical ones follow. Straightforward comments will be nevertheless addressed in the camera-ready version. R1: Rather than vectors, our arithmetic is based on spatial (tensor) factors and is realized as a swapping operation between factors of different patients. However, building on reviewer’s comment, in future work we plan to learn an explorable manifold based on spatial factors thus enabling arithmetic operations between factor values. Regarding the resolution of the input anatomical factors, the current version of DAA-GAN requires the preservation of the original image (i.e. patient’s MRI slice) resolution, thus the computational complexity of the model scales linearly with the image size. However, our DAA can be combined with any anatomy-conditioned generator architecture that may receive down-sampled spatial latent variables and use up-sampling layers to generate high-fidelity images. R2: We agree that DAA-GAN is limited by the “correctness” of the input, hence the ability of SDNet to effectively disentangle the anatomical factors. As a matter of fact, SDNet learns to encode specific factors to specific channels, and since the factors are spatial and semantic (due to the supervision with semantic masks), they are interpretable. For DAA-GAN training/testing we used factors generated by samples with high DICE score (i.e. high segmentation performance). We pretrained SDNet in a fully supervised setting, without the discriminator. Regarding the pathology classification loss, we agree with the comment that the classifier encourages “easy-to-classify” pathology generation. However, we believe that this effect is mitigated by the discriminator, which encourages in-distribution sample generation. In fact, we choose to trade intra-pathology variance (e.g. severity, as a very severe pathology is easier to classify) for introducing inter-pathology variance through the factor mixing process. Nevertheless, this observation is very interesting, and we plan to further explore the impact of the classifier in future work. Regarding the imaging factors, since SDNet encodes them in a vector latent variable using a variational setup, DAA-GAN can either sample imaging information from the learned distribution or use the extracted imaging vector of the corresponding input. In this work we follow the latter approach. R3: Regarding the limitations introduced by freely combining labels from multiple populations, we believe that realistic medical image generation is an open challenge that is far from being addressed solely by quantitative evaluation, i.e. a qualitative assessment from experts/clinicians is always required. However, our pathology classifier and our discriminator play an adversarial game with the generator, as the former encourages easy-to-classify pathologies and the latter penalizes out-of-distribution samples. We believe that this game, coupled with the mixing of existing (and not sampled from a Gaussian prior) anatomical factors, is an important step towards realistic medical image synthesis back to top" />
<link rel="canonical" href="https://kittywong.github.io/kittywong/0314/12/31/Paper0527" />
<meta property="og:url" content="https://kittywong.github.io/kittywong/0314/12/31/Paper0527" />
<meta property="og:site_name" content="MICCAI 2021 - Accepted Papers and Reviews" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0314-12-31T23:58:56-05:17" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Controllable cardiac synthesis via disentangled anatomy arithmetic" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://kittywong.github.io/kittywong/0314/12/31/Paper0527"},"@type":"BlogPosting","url":"https://kittywong.github.io/kittywong/0314/12/31/Paper0527","headline":"Controllable cardiac synthesis via disentangled anatomy arithmetic","dateModified":"0315-01-02T00:00:00-05:17","datePublished":"0314-12-31T23:58:56-05:17","description":"Paper Info Reviews Meta-review(s) Author Feedback Authors Spyridon Thermos, Xiao Liu, Alison O’Neil, Sotirios A. Tsaftaris Abstract Acquiring annotated data at scale with rare diseases or conditions remains a challenge. It would be extremely useful to have a method that controllably synthesizes images that can correct such underrepresentation. Assuming a proper latent representation, the idea of a “latent vector arithmetic’” could offer the means of achieving such synthesis. A proper representation must encode the fidelity of the input data, preserve invariance and equivariance, and permit arithmetic operations. Motivated by the ability to disentangle images into spatial anatomy (tensor) factors and accompanying imaging (vector) representations, we propose a framework termed “disentangled anatomy arithmetic”, in which a generative model learns to combine anatomical factors of different input images such that when they are re-entangled with the desired imaging modality (e.g. MRI), plausible new cardiac images are created with the target characteristics. To encourage a realistic combination of anatomy factors after the arithmetic step, we propose a localized noise injection network that precedes the generator. Our model is used to generate realistic images, pathology labels, and segmentation masks that are used to augment the existing datasets and subsequently improve post-hoc classification and segmentation tasks. Code is publicly available at https://github.com/vios-s/DAA-GAN. Link to paper https://doi.org/10.1007/978-3-030-87199-4_15 Link to the code repository https://github.com/vios-s/DAA-GAN Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The paper proposes a novel method for cardiac image synthesis based on a Disentangled arithmetic notion. As a preprocessing step images are encoded into disentangled features that represent the anatomy of the heart and the image characteristics. Feature arithmetic is done on the anatomical factors , then Gaussian noise is introduced to them and a generator composes the end image. A discriminator and a pathology classifier are used to aid training Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Interesting and to the best of my knowledge novel framework Very well analyzed in terms of experiments, ablations and comparisons to other existing methods. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Not so much weaknesses but definitely questions that arose. The anatomical feature arithmetic, how is it conducted ? Is it simple arithmetic on the feature vectors of the anatomy ? If yes i take it that it is assumed a Euclidean underlying manifold, my concern is that in practice this assumption does not always stand, see Latent space oddity, Arvanitidis et al 2017. It would be a good idea to analyze the implicit curvature of the empirical manifold the preprocessing method creates. This way the arithmetic would be far more accurate and theoretically sound. -In general the concept of the latent space arithmetic could be better explained in the paper Technically speaking the Gaussian noise is not injected via residual connections, since residuals require the same input to be added to the output of the layer(s). AdaIN layer, please write it in full the first time it is introduced it in the text. At the top of page 5, it is mentioned that C is of the same dimension as image I, that means they are 224x224, how does this affect the computational performance of the algorithm? How does it scale as images scale ? Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The main paper together with the supplement appear to provide the required information for reproducing this paper, if the authors improve the description of the latent arithmetic then I can see no issue for reproducing this paper. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Mainly covered with my comments above Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? This is a solid paper. It proposes a novel method, that is evaluated in a very good manner and compared both in experiments and in theory with the related literature. I’ve noted a series of minor points that could be addressed to improve it event further. But I’m more than happy with the current quality of the paper, hence my acceptance rating. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper The authors proposed a novel framework that can generate realistic cardiac images with certain level of controllability of anatomical factors for data augmentation. First, disentangled anatomical representation are learnt from SDNET. Next, based on these controllable factors, a series of operations are designed to generate realistic images for augmentation. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. +The proposed method is solving an important problem of data augmentation for medical image with controllable anatomical factors, which may be very interesting to the MICCAI community. +Texts are well written and easy to follow. +Experiments are good with multiple runs and statistic test. Several important aspects of data augmentations are discussed in the results. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. -If I understand correctly, the disentanglement and the semantic meaning of anatomical factors from SDNET is not guaranteed. For example, you can not force the model to learn the factor of “left ventricular” in one specific channel. Did the authors encounter situations where no good factors are found for swapping? How did the authors chose good anatomical factors from SDNET? Eyeballing or using some metrics? -I have some concerns for applying the loss of Pathology Classifier. When the proposed networks are optimized by this loss, does it encourage the network to generate images that are easier to be classified? This somehow against the goal of data augmentation and may introduce bias when evaluating. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance method: clear dataset: open dataset and clear evaluation: clear Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html SDNET also infer a modality representation along with the anatomical representations. I might miss it, but it seems that the proposed network doesn’t use that? Why? Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Very good paper aiming at an important problem. Novel and interesting methods. No obvious flaws. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper tackles an important problem in medical imaging—generating scarce samples to facilitate downstream tasks (e.g., classification). The proposed DAA-GAN model generates new images in a target domain (usually with pathologies) in a controllable way; by first disentangling anatomical and imaging factors, manipulating the anatomical factors by plugging in pathological data, then re-entangling these factors using an image generator. Evaluations include both classification and segmentation tasks using a variety of cardiac datasets. Results are superior to comparison methods. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Comprehensive evaluation. Two cardiac datasets (ACDC and MM) with a fairly large number of subjects were used in evaluation. Quantitative comparisons including AC-GAN and SPADE show promising results after using the proposed data augmentation. Well established methodology. The paper combines several existing methods in the literature (mainly SDNet and styleGAN). The way of using injective noise to handle topology issues after label arithmetic is novel. Ablation study to show contribution of each network components. Good reproducibility. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The proposed method depends on the disentangling outputs from another model, SDNet, to obtain anatomical and imaging representations. However, SDNet is a “synthesis-segmentation” hybrid model, and it requires training labels. It is unclear how many training samples are needed to train an SDNet to produce reliable anatomy labels for DAA-GAN. The fact that multiple labels from multiple populations can be combined freely (after registration) is intriguing. However, this could also be the limitation of the work if considering that some combinations may never be observed in real data (wrong topology), despite of the noise injection. I guess this also explains why the anatomy in Fig. 4 can only be changed by a limited amount. Therefore, there is a risk of generating out-of-real-distribution data that could bias the downstream tasks. Moreover, the biggest assumption in this paper is that replacing a healthy label with a pathology label could generate an image with the corresponding disease. This assumption is questionable. One missing element in the evaluation is to quantitatively evaluate (pix-to-pix) the other regions, i.e., 1-M regions. It is necessary to show that other anatomies are preserved after manipulating anatomical factors of the ROI. Please rate the clarity and organization of this paper Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Good. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Code is available upon acceptance. A little concern is that the proposed DAA-GAN depends on the outputs of SDNet. The fact that two deep learning models need to be trained for data augmentation could potentially limit the re-implementation of the proposed method. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Some comments for clarity: Figure 1 top row was hard to understand when first referenced in the Introduction. A more detailed caption might help. Figure 2 notation \\mathcal{L}_{att} was not defined or was mislabeled. Several suggestions for future work: Quantitative evaluations on the other regions—1-M regions—are necessary. It is really important to show that other anatomies are preserved after manipulating anatomical factors within the ROI. A suggested reference on hallucination: Cohen et al. Distribution matching losses can hallucinate features in medical image translation. MICCAI 2018. The effects of noise injection network can be further studied, as this is one of the core innovations of the paper. For example, after the model is trained, what would the image look like if increase the std of the Gaussian noise? A suggested reference: Zuo et al. Synthesizing Realistic Brain MR Images with Noise Control. MICCAI-SASHIMI 2020. How to extend this work to a large number of labels and control topology in the augmented images? Extension to other anatomies, e.g., brain MRIs. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Despite the limitations pointed out above, this research overall is very interesting. The paper is well-written. The novelty of including injective Gaussian noise to tackle label overlapping issues and the completeness of the evaluations are the key factors that make this work stand out from other submissions. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. All the reviewers indicate “Accept” for the paper, although they also raise concerns. From my reading of the paper I agree there are some concerns in the paper in relation to description of latent arithmetic, and loss from pathology classifier. While there are merits of the paper I believe the authors should clarify those in the final version. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 1 Author Feedback We thank the reviewers and the meta-reviewer for their valuable comments. Brief responses and clarifications to the most critical ones follow. Straightforward comments will be nevertheless addressed in the camera-ready version. R1: Rather than vectors, our arithmetic is based on spatial (tensor) factors and is realized as a swapping operation between factors of different patients. However, building on reviewer’s comment, in future work we plan to learn an explorable manifold based on spatial factors thus enabling arithmetic operations between factor values. Regarding the resolution of the input anatomical factors, the current version of DAA-GAN requires the preservation of the original image (i.e. patient’s MRI slice) resolution, thus the computational complexity of the model scales linearly with the image size. However, our DAA can be combined with any anatomy-conditioned generator architecture that may receive down-sampled spatial latent variables and use up-sampling layers to generate high-fidelity images. R2: We agree that DAA-GAN is limited by the “correctness” of the input, hence the ability of SDNet to effectively disentangle the anatomical factors. As a matter of fact, SDNet learns to encode specific factors to specific channels, and since the factors are spatial and semantic (due to the supervision with semantic masks), they are interpretable. For DAA-GAN training/testing we used factors generated by samples with high DICE score (i.e. high segmentation performance). We pretrained SDNet in a fully supervised setting, without the discriminator. Regarding the pathology classification loss, we agree with the comment that the classifier encourages “easy-to-classify” pathology generation. However, we believe that this effect is mitigated by the discriminator, which encourages in-distribution sample generation. In fact, we choose to trade intra-pathology variance (e.g. severity, as a very severe pathology is easier to classify) for introducing inter-pathology variance through the factor mixing process. Nevertheless, this observation is very interesting, and we plan to further explore the impact of the classifier in future work. Regarding the imaging factors, since SDNet encodes them in a vector latent variable using a variational setup, DAA-GAN can either sample imaging information from the learned distribution or use the extracted imaging vector of the corresponding input. In this work we follow the latter approach. R3: Regarding the limitations introduced by freely combining labels from multiple populations, we believe that realistic medical image generation is an open challenge that is far from being addressed solely by quantitative evaluation, i.e. a qualitative assessment from experts/clinicians is always required. However, our pathology classifier and our discriminator play an adversarial game with the generator, as the former encourages easy-to-classify pathologies and the latter penalizes out-of-distribution samples. We believe that this game, coupled with the mixing of existing (and not sampled from a Gaussian prior) anatomical factors, is an important step towards realistic medical image synthesis back to top","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<meta
  name="keywords"
  content="Thermos, Spyridon,Liu, Xiao,O'Neil, Alison,Tsaftaris, Sotirios A." />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<link
  rel="alternate"
  type="application/rss+xml"
  title="MICCAI 2021 - Accepted Papers and Reviews - "
  href="kittywong/feed.xml" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/base.css" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/highlight.css" />

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async>
</script>


<script src="/assets/scripts/jekyllpaper.js" async></script>
<script
  src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"
  onload="javascript:loadMermaid();"
  async>
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
    //,
    //displayAlign: "left",
    //displayIndent: "2em"
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  </head>
  <body>
    <div class="container-wrapper">
      <header class="container-header">
        <div class="header-info">
  <!-- Added by Elvis Chen -->
  <img src="https://kittywong.github.io/assets/images/miccai2021header.jpg" alt="MICCAI banner">
  <!-- END Added by Elvis Chen -->
  <span class="header-info-name">MICCAI 2021 - Accepted Papers and Reviews</span>
  <span class="header-info-desc"></span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
    <h2>
    
    <li class="header-main-nav-item">
      <a href="kittywong/">
        
          <b>List of Papers</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/categories">
        
          <b>By topics</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/tags">
        
          <b>Author List</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/about">
        
          <b>About</b>
        
      </a>
    </li>
      
    </h2>
  </ul>
</nav>
      </header>
      <main class="container-main">
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<article class="container-post">
  <div class="post-title">
    <h1><span style="color:#1040a7"><b>Controllable cardiac synthesis via disentangled anatomy arithmetic</b></span></h1>
  </div>
  
  <div class="post-author print-post-author">
    <span>Kitty K. Wong</span>
  </div>
  <hr>
    
   
  <div class="post-content">
    <!--
    <div class="post-categories">
      <h2><span style="color:#1040a7">Paper Topic(s):</span></h2> 
      
      
      <a 
        href="kittywong/categories#Machine Learning - Domain adaptation"
        class="post-category">
        Machine Learning - Domain adaptation
      </a>
      
      <a 
        href="kittywong/categories#Clinical applications - Cardiac"
        class="post-category">
        Clinical applications - Cardiac
      </a>
      
      <a 
        href="kittywong/categories#Image Segmentation"
        class="post-category">
        Image Segmentation
      </a>
      
      <a 
        href="kittywong/categories#Machine Learning - Interpretability / Explainability"
        class="post-category">
        Machine Learning - Interpretability / Explainability
      </a>
      
      <a 
        href="kittywong/categories#Modalities - MRI"
        class="post-category">
        Modalities - MRI
      </a>
      
      <a 
        href="kittywong/categories#Outcome/disease prediction"
        class="post-category">
        Outcome/disease prediction
      </a>
      
    
    </div>
    <div class="post-tags">
      
      <h2><span style="color:#1040a7">Author(s):</span></h2> 
      
      <a href="kittywong/tags#Thermos, Spyridon"
        class="post-tags">
        Thermos, Spyridon
      </a> |  
      
      <a href="kittywong/tags#Liu, Xiao"
        class="post-tags">
        Liu, Xiao
      </a> |  
      
      <a href="kittywong/tags#O'Neil, Alison"
        class="post-tags">
        O'Neil, Alison
      </a> |  
      
      <a href="kittywong/tags#Tsaftaris, Sotirios A."
        class="post-tags">
        Tsaftaris, Sotirios A.
      </a> |  
      
    </div>
  -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

    .sidenav {
      width: 200px;
      position: fixed;
      z-index: 1;
      top: 150px;
      left: 50px;
      background: #eee;
      overflow-x: hidden;
      padding: 0px 0;
    }
  
    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 16px;
      color: #2196F3;
      color: #FF4500;
      display: block;
    }
  
    .sidenav a:hover {
      color: #064579;
    }
    </style>
  </head>

  <div class="sidenav">
    <a href="#author-id">Paper Info</a>
    <a href="#review-id">Reviews</a>
    <a href="#metareview-id">Meta-Review(s)</a>
    <a href="#authorFeedback-id">Author Feedback</a>
    <a href="">Back to top</a>
    <a href="https://kittywong.github.io">Back to List of papers</a>
  </div>

    <table>
  <tbody>
    <tr>
      <td><a href="#author-id"><span style="color:#ff9900"><b>Paper Info</b></span></a></td>
      <td><a href="#review-id"><span style="color:#ff9900"><b>Reviews</b></span></a></td>
      <td><a href="#metareview-id"><span style="color:#ff9900"><b>Meta-review(s)</b></span></a></td>
      <td><a href="#authorFeedback-id"><span style="color:#ff9900"><b>Author Feedback</b></span></a></td>
    </tr>
  </tbody>
</table>

<h1 id="author-id">Authors</h1>
<p>Spyridon Thermos, Xiao Liu, Alison O’Neil, Sotirios A. Tsaftaris
<br /><br /></p>

<h1 id="abstract-id">Abstract</h1>
<p>Acquiring annotated data at scale with rare diseases or conditions remains a challenge. It would be extremely useful to have a method that controllably synthesizes images that can correct such underrepresentation. Assuming a proper latent representation, the idea of a “latent vector arithmetic’” could offer the means of achieving such synthesis. A proper representation must encode the fidelity of the input data, preserve invariance and equivariance, and permit arithmetic operations. Motivated by the ability to disentangle images into spatial anatomy (tensor) factors and accompanying imaging (vector) representations, we propose  a  framework  termed “disentangled anatomy arithmetic”, in which a generative model learns to combine anatomical factors of different input images such that when they are re-entangled with the desired imaging modality (e.g. MRI), plausible new cardiac images are created with the target characteristics. To encourage a realistic combination of anatomy factors after the arithmetic step, we propose a localized noise injection network that precedes the generator. Our model is used to generate realistic images, pathology labels, and segmentation masks that are used to augment the existing datasets and subsequently improve post-hoc classification and segmentation tasks. Code is publicly available
at https://github.com/vios-s/DAA-GAN.
<br /><br /></p>

<h1 id="link-id">Link to paper</h1>
<p><a href="https://doi.org/10.1007/978-3-030-87199-4_15">https://doi.org/10.1007/978-3-030-87199-4_15</a>
<br /><br /></p>

<h1 id="code-id">Link to the code repository</h1>
<p>https://github.com/vios-s/DAA-GAN
<br /><br /></p>

<h1 id="dataset-id">Link to the dataset(s)</h1>
<p>N/A
<br /><br /></p>

<hr />
<h1 id="review-id">Reviews</h1>

<h3 id="review-1">Review #1</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The paper proposes a novel method for cardiac image synthesis based on a Disentangled arithmetic notion. As a preprocessing step images are encoded into disentangled features that represent the anatomy of the heart and the image characteristics. Feature arithmetic is done on the anatomical factors , then Gaussian noise is introduced to them and a generator composes the end image. A discriminator and a pathology classifier are used to aid training</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ul>
        <li>Interesting and to the best of my knowledge novel framework</li>
        <li>Very well analyzed in terms of experiments, ablations and comparisons to other existing methods.</li>
      </ul>

    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>Not so much  weaknesses but definitely questions that arose.</p>
      <ul>
        <li>The anatomical feature arithmetic, how is it conducted ? Is it simple arithmetic on the feature vectors of the anatomy ? If yes i take it that it is  assumed a Euclidean underlying manifold, my concern is that in practice this assumption does not always stand, see Latent space oddity, Arvanitidis et al 2017. It would be a good idea to analyze the implicit curvature of the empirical manifold the preprocessing method creates. This way the arithmetic would be far more accurate and theoretically sound.</li>
      </ul>

      <p>-In general the concept of the latent space arithmetic could be better explained in the paper</p>

      <ul>
        <li>
          <p>Technically speaking the Gaussian noise is not injected via residual connections,  since residuals require the same input to be added to the output of the layer(s).</p>
        </li>
        <li>
          <p>AdaIN layer, please write it in full the first time it is introduced it in the text.</p>
        </li>
        <li>
          <p>At the top of page 5, it is mentioned that C is of the same dimension as image  I, that means they are 224x224, how does this affect the computational performance of the algorithm? How does it scale as images scale ?</p>
        </li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Excellent</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>The main paper together with the supplement appear to provide the required information for reproducing this paper, if the authors improve the description of the latent arithmetic then I can see no issue for reproducing this paper.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>Mainly covered with my comments above</p>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>accept (8)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>This is a solid paper. It proposes a novel method, that is evaluated in a very good manner and compared both in experiments and in theory with the related literature. I’ve noted a series of minor points that could be addressed to improve it event further. But I’m more than happy with the current quality of the paper, hence my acceptance rating.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-2">Review #2</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The authors proposed a novel framework that can generate realistic cardiac images with certain level of controllability of anatomical factors for data augmentation. First, disentangled anatomical representation are learnt from SDNET. Next, based on these controllable factors, a series of operations are designed to generate realistic images for augmentation.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>+The proposed method is solving an important problem of data augmentation for medical image with controllable anatomical factors, which may be very interesting to the MICCAI community.
+Texts are well written and easy to follow. 
+Experiments are good with multiple runs and statistic test. Several important aspects of data augmentations are discussed in the results.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>-If I understand correctly, the disentanglement and the semantic meaning of anatomical factors from SDNET is not guaranteed. For example, you can not force the model to learn the factor of “left ventricular” in one specific channel. Did the authors encounter situations where no good factors are found for swapping? How did the authors chose good anatomical factors from SDNET? Eyeballing or using some metrics?
-I have some concerns for applying the loss of Pathology Classifier. When the proposed networks are optimized by this loss, does it encourage the network to generate images that are easier to be classified? This somehow against the goal of data augmentation and may introduce bias when evaluating.</p>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Excellent</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>method: clear
dataset: open dataset and clear
evaluation: clear</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>SDNET also infer a modality representation along with the anatomical representations. I might miss it, but it seems that the proposed network doesn’t use that? Why?</p>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>accept (8)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>Very good paper aiming at an important problem. Novel and interesting methods. No obvious flaws.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Very confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-3">Review #3</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>This paper tackles an important problem in medical imaging—generating scarce samples to facilitate downstream tasks (e.g., classification). The proposed DAA-GAN model generates new images in a target domain (usually with pathologies) in a controllable way; by first disentangling anatomical and imaging factors, manipulating the anatomical factors by plugging in pathological data, then re-entangling these factors using an image generator. Evaluations include both classification and segmentation tasks using a variety of cardiac datasets. Results are superior to comparison methods.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ul>
        <li>Comprehensive evaluation. Two cardiac datasets (ACDC and MM) with a fairly large number of subjects were used in evaluation. Quantitative comparisons including AC-GAN and SPADE show promising results after using the proposed data augmentation.</li>
        <li>Well established methodology. The paper combines several existing methods in the literature (mainly SDNet and styleGAN). The way of using injective noise to handle topology issues after label arithmetic is novel.</li>
        <li>Ablation study to show contribution of each network components.</li>
        <li>Good reproducibility. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available.</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <ul>
        <li>The proposed method depends on the disentangling outputs from another model, SDNet, to obtain anatomical and imaging representations. However, SDNet is a “synthesis-segmentation” hybrid model, and it requires training labels. It is unclear how many training samples are needed to train an SDNet to produce reliable anatomy labels for DAA-GAN.</li>
        <li>The fact that multiple labels from multiple populations can be combined freely (after registration) is intriguing. However, this could also be the limitation of the work if considering that some combinations may never be observed in real data (wrong topology), despite of the noise injection. I guess this also explains why the anatomy in Fig. 4 can only be changed by a limited amount. Therefore, there is a risk of generating out-of-real-distribution data that could bias the downstream tasks. Moreover, the biggest assumption in this paper is that replacing a healthy label with a pathology label could generate an image with the corresponding disease. This assumption is questionable.</li>
        <li>One missing element in the evaluation is to <em>quantitatively</em> evaluate (pix-to-pix) the other regions, i.e., 1-M regions. It is necessary to show that other anatomies are preserved after manipulating anatomical factors of the ROI.</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Good</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>Good. The authors have provided essential experimental and implementation details. Datasets used in evaluation are publicly available. Code is available upon acceptance. A little concern is that the proposed DAA-GAN depends on the outputs of SDNet. The fact that two deep learning models need to be trained for data augmentation could potentially limit the re-implementation of the proposed method.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>Some comments for clarity:</p>
      <ul>
        <li>Figure 1 top row was hard to understand when first referenced in the Introduction. A more detailed caption might help.</li>
        <li>Figure 2 notation \mathcal{L}_{att} was not defined or was mislabeled.</li>
      </ul>

      <p>Several suggestions for future work:</p>
      <ul>
        <li>Quantitative evaluations on the other regions—1-M regions—are necessary. It is really important to show that other anatomies are preserved after manipulating anatomical factors within the ROI. A suggested reference on hallucination: Cohen et al. Distribution matching losses can hallucinate features in medical image translation. MICCAI 2018.</li>
        <li>The effects of noise injection network can be further studied, as this is one of the core innovations of the paper. For example, after the model is trained, what would the image look like if increase the std of the Gaussian noise? A suggested reference: Zuo et al. Synthesizing Realistic Brain MR Images with Noise Control. MICCAI-SASHIMI 2020.</li>
        <li>How to extend this work to a large number of labels and control topology in the augmented images?</li>
        <li>Extension to other anatomies, e.g., brain MRIs.</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>accept (8)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>Despite the limitations pointed out above, this research overall is very interesting. The paper is well-written. The novelty of including injective Gaussian noise to tackle label overlapping issues and the completeness of the evaluations are the key factors that make this work stand out from other submissions.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="metareview-id">Meta-Review(s)</h1>

<h2 id="primary-meta-review">Primary Meta-Review</h2>
<ul>
  <li><strong>Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal.</strong>
    <blockquote>
      <p>All the reviewers indicate “Accept” for the paper, although they also raise concerns. From my reading of the paper I agree there are some concerns in the paper in relation to description of latent arithmetic, and loss from pathology classifier. While there are merits of the paper I believe the authors should clarify those in the final version.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="authorFeedback-id">Author Feedback</h1>
<blockquote>
  <p>We thank the reviewers and the meta-reviewer for their valuable comments. Brief responses and clarifications to the most critical ones follow. Straightforward comments will be nevertheless addressed in the camera-ready version.</p>

  <p>R1: Rather than vectors, our arithmetic is based on spatial (tensor) factors and is realized as a swapping operation between factors of different patients. However, building on reviewer’s comment, in future work we plan to learn an explorable manifold based on spatial factors thus enabling arithmetic operations between factor values. Regarding the resolution of the input anatomical factors, the current version of DAA-GAN requires the preservation of the original image (i.e. patient’s MRI slice) resolution, thus the computational complexity of the model scales linearly with the image size. However, our DAA can be combined with any anatomy-conditioned generator architecture that may receive down-sampled spatial latent variables and use up-sampling layers to generate high-fidelity images.</p>

  <p>R2: We agree that DAA-GAN is limited by the “correctness” of the input, hence the ability of SDNet to effectively disentangle the anatomical factors. As a matter of fact, SDNet learns to encode specific factors to specific channels, and since the factors are spatial and semantic (due to the supervision with semantic masks), they are interpretable. For DAA-GAN training/testing we used factors generated by samples with high DICE score (i.e. high segmentation performance). We pretrained SDNet in a fully supervised setting, without the discriminator.
 Regarding the pathology classification loss, we agree with the comment that the classifier encourages “easy-to-classify” pathology generation. However, we believe that this effect is mitigated by the discriminator, which encourages in-distribution sample generation. In fact, we choose to trade intra-pathology variance (e.g. severity, as a very severe pathology is easier to classify) for introducing inter-pathology variance through the factor mixing process. Nevertheless, this observation is very interesting, and we plan to further explore the impact of the classifier in future work.
 Regarding the imaging factors, since SDNet encodes them in a vector latent variable using a variational setup, DAA-GAN can either sample imaging information from the learned distribution or use the extracted imaging vector of the corresponding input. In this work we follow the latter approach.</p>

  <p>R3: Regarding the limitations introduced by freely combining labels from multiple populations, we believe that realistic medical image generation is an open challenge that is far from being addressed solely by quantitative evaluation, i.e. a qualitative assessment from experts/clinicians is always required. However, our pathology classifier and our discriminator play an adversarial game with the generator, as the former encourages easy-to-classify pathologies and the latter penalizes out-of-distribution samples. We believe that this game, coupled with the mixing of existing (and not sampled from a Gaussian prior) anatomical factors, is an important step towards realistic medical image synthesis</p>

</blockquote>

<p><br /><br />
<a href=""><span style="color:#ff9900"><b>back to top</b></span></a></p>

<hr />


  </div>

  <div class="post-info">
    <!--
    <div class="post-date">
      Poster presentation date:  
      0314-12-31
      -->
      <!--
      
        ,
        updated at 
        0315-01-01
      
      .
      
    </div>
    -->
    <!--
    
    <div class="post-author">
      Author: Kitty K. Wong
    </div>
    
    -->
    <div class="post-categories">
      <span><b>Topic(s): </b></span>
      
      <a 
        href="kittywong/categories#Machine Learning - Domain adaptation"
        class="post-category">
        Machine Learning - Domain adaptation
      </a> |
      
      <a 
        href="kittywong/categories#Clinical applications - Cardiac"
        class="post-category">
        Clinical applications - Cardiac
      </a> |
      
      <a 
        href="kittywong/categories#Image Segmentation"
        class="post-category">
        Image Segmentation
      </a> |
      
      <a 
        href="kittywong/categories#Machine Learning - Interpretability / Explainability"
        class="post-category">
        Machine Learning - Interpretability / Explainability
      </a> |
      
      <a 
        href="kittywong/categories#Modalities - MRI"
        class="post-category">
        Modalities - MRI
      </a> |
      
      <a 
        href="kittywong/categories#Outcome/disease prediction"
        class="post-category">
        Outcome/disease prediction
      </a> |
      
    </div>
    <div class="post-tags">
      <!--<span>Author List</span>-->
      <span><b> Author(s): </b></span>
      
      <a href="kittywong/tags#Thermos, Spyridon"
        class="post-category">
        Thermos, Spyridon
      </a> |  
      
      <a href="kittywong/tags#Liu, Xiao"
        class="post-category">
        Liu, Xiao
      </a> |  
      
      <a href="kittywong/tags#O'Neil, Alison"
        class="post-category">
        O'Neil, Alison
      </a> |  
      
      <a href="kittywong/tags#Tsaftaris, Sotirios A."
        class="post-category">
        Tsaftaris, Sotirios A.
      </a> |  
      
    </div>
    <div class="post-other">
      
      <div>
        <span><b>
          Next paper: 
        </b>
        </span>
        <a href="/0315/12/31/Paper0537">
          CoTr: Efficiently Bridging CNN and Transformer for 3D Medical Image Segmentation
        </a>
      </div>
      
      
      <div>
        <span><b>
          Previous paper: 
        </b>
        </span>
        <a href="/0313/12/31/Paper0525">
          Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation
        </a>
      </div>
      
    </div>
    
  </div>
</article>

      </main>
      <footer class="container-footer">
        <div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. Kitty K. Wong, The MICCAI Society
  </span>
</div>
<!--
<div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. example.com.
  </span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>, themed by <a href="https://github.com/ghosind/Jekyll-Paper-Github">Jekyll-Paper-Github</a>.
  </span>
</div>
-->

      </footer>
    </div>
  </body>
</html>
