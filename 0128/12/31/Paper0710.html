<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Context-aware virtual adversarial training for anatomically-plausible segmenation | MICCAI 2021 - Accepted Papers and Reviews</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Context-aware virtual adversarial training for anatomically-plausible segmenation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Ping Wang, Jizong Peng, Marco Pedersoli, Yuanfeng Zhou, Caiming Zhang, Christian Desrosiers Abstract In this paper, we present a Context-aware Virtual Adversarial Training (CaVAT) method for producing anatomically plausible segmentation. The proposed method uses reinforcement learning to include any non-differentiable constraint in a semi-supervised setting. Specifically, we incorporate complex anatomical constraints into the VAT framework, boosting the network’s robustness to adversarial examples that maximize both prediction divergence and constraint violation. Experiments on a well-known cardiac segmentation dataset show the effectiveness of our method in terms of segmentation accuracy and improved constraint satisfaction. Link to paper https://doi.org/10.1007/978-3-030-87193-2_29 Link to the code repository N/A Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The paper describes a method to leverage on constraints for semi-supervised training of a deep net to segment images. The crux of the proposed method is an auxiliary loss function, which detects constraint violations in segmentations obtained for images perturbed using the adversarial approach. This loss is stochastic, with gradients computed using the Reinforce rule. the method is generic and could in theory be applied to any task with structured output and any constraint. In the paper, it is demonstrated to improve the performance of a deep net trained to segment cardiac images from the ACDC data set, when only 3-5% of the training labels are used, with the constraint that each class should form a single connected component. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. 1) the idea of using the reinforce rule to minimize the expected number of constraint violations is simple and generic, yet potentially very powerful. 2) the paper is very clear and well written Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. A) it is a pity that the method is only demonstrated with one constraint. B) … and on one data set. C) The paper does not discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. D) I miss a discussion of the limitations of this approach. E) Just for reference, a comparison to another method of semi-supervised segmentation would be nice. This is a minor weakness though, because the advantage of the proposed method is that it accommodates non-differentiable constraints. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The description of the method is clear enough for me to attempt to implement it. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html I develop here on some weaknesses listed in point 4. ad A) could you suggest other constraints/reward designs for which the method could be used? ad C) what would happen if you evaluated the l_cons loss for r_u=0 and without the VAT loss? Is the adversarial perturbation really necessary in your method? ad D) Are there constraint types for which the loss is ineffective? Additional question: Q1. one non-obvious weakness is that l_cons only reinforces samples (patches, in this case) that satisfy the constraints. What about penalizing samples that violate the constraints? Minor comments: i. the role of the subscript i in (7) is not clear until the next section. ii. there is an interrupted sentence in the beginning of 3.2 iii. I cannot find the number of samples used (m) in the paper Please state your overall opinion of the paper Probably accept (7) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? My recommendation is influenced by two main arguments: a simple, generic, well described idea, very compelling the method was only demonstrated to work with a single constraint type What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper This paper presents a semi-supervised learning method which incorporate segmentation constraints over virtual adversarial training to produce anatomically-plausible segmentation. The method is validated on the cardiac image segmentation task. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The idea to incorporate segmentation constraint to produce anatomically-plausible segmentation is reasonable. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The rationale of proposed method was not clearly elaborated. For example, why reinforcement learning is used in the method, what is the particular advantage. Novelty of proposed method is incremental over VAT. It seems this paper has not been well prepared. (1) No introduction for background in the abstract section. (2) Incomplete sentences/paragraphs in Section 3.2, which is in fact a crucial part in the method. Semi-supervised medical-image segmentation has been a popular topic with a number of methods being proposed recently also in MICCAI 2020. However, the authors didn’t compared with any of the recent SOTA methods. How can the authors demonstrate that there method can produce more anatomically-plausible segmentations? Is there any evidence showing the connections between non-connectivity and anatomically plausibility. The method is only validated on one dataset, which may lead to bias conclusions. Please rate the clarity and organization of this paper Poor Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The authors claim to release the code. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html In fact this paper is very related to semi-supervised learning, hence keyword “semi supervised” should be included in the title. A figure could be provided to give a clear illustration for the proposed method. Please state your overall opinion of the paper reject (3) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? My rating is mainly from two perspectives: Technical novelty of this paper is incremental and the use of reinforcement is has not been well motivated. Lack comparisons with SOTA and the evaluation is only conducted on one dataset. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 4 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper proposed a semi-supervised method with an additional non-differentiable constrain attached to the VAT framework, to enhance model robustness and accuracy. They have validated their performance on cardiac image segmentation. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. ++ The problem they tackled, i.e., how to exploit the shape priors (e.g., the anatomical constraints) in semi-supervised learning, is interesting. ++ A new usage of reinforcement learning, i.e., using reinforcement learning to solve the non-differentiable loss term. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. For methods, there are several ambiguous explanations, which make it hard to follow. – In the 2nd term in Eq.3, how the constrain violation term could lead to better anatomical shapes? – For someone who is not familiar with reinforcement learning, I do not quite understand why using reinforcement learning could solve the non-differential loss? Since you used reinforcement learning (RL), what do other commonly-used RL terms including environment and status, refer to in the context? – It would be greatly helpful if there is a brief figure to illustrate your framework and insights. – There may have a typo in Eq.4. It should be $x_{u}+r_{u}$, instead of $x+r_{u}$ ,right? For experiments, I noticed that the improvements over VAT are not significant, i.e., &lt;1% in Dice. Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Since several components are coarsely described with no code available, I am not positive about it. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html It would be great if the authors could elaborate more on several details in methods Regarding the 2nd term in Eq.3, (1) How the constrain violation term would help the network to learn more complex or better anatomical shapes? (2) Why using reinforcement learning could solve the non-differential loss? Regarding Eq. 6, how to sample the discrete segmentation mask? What exactly the constrain mean to direct the reward function to be 1 or 0? In the 3rd paragraph in Section 3.2, you mentioned you utilized a constrain to impose the segmentation regions to have a single connected component. I was wondering if it could generalize well to other applications. For cardiac segmentation on organ structures, it should be fine as the segmented regions like LV, Myo and RV, indeed should be one single piece. However, for some lesions, like the myocardial infarction regions, since they are naturally scattered, is the proposed constrain also appliable here? It would be greatly helpful if there is a brief figure to illustrate your framework and insights. In experiments, I am curious about the performance of VAT + shape constrain in [28]. Please state your overall opinion of the paper probably reject (4) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The explanations on the key component, i.e., the constrain violation, is ambiguous and hard to follow. The performance gains are less significant, i.e., &lt;1% in Dice. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 5 Reviewer confidence Somewhat confident Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. Strengths The idea of using reinforcement learning to include non-differentiable constraint to produce anatomically-plausible segmentation is highly compelling. The paper is very clear and well written. Weaknesses The method is only validated on one dataset. The authors did not compare with any of the recent SOTA methods. Novelty of proposed method is incremental over VAT, wrt to all metrics. Regarding the remark of Rev#2 « Novelty of proposed method is incremental over VAT. i.e., &lt;1% in Dice. »: I completely agree. Thus I advise the authors not to « boldify » the top 1 result, unless statistical significance has been demonstrated, cf for example 77.40 and 77.85 are likely to be statistically similar given the std deviation. However let me acknowledge that the increment in terms of Dice is not what the authors put forward in the text, as they mainly comment on the non-conn metric. That said, I believe even the experimentations with the VAT/Entropy min bring interesting insight as to how to adversarial examples to enforce constraint in segmentation. Despite some justified limits noted by the reviewers, I think the paper has some merits, from a methodological perspective, since proposing a framework that allow to incorporate non-differentiable constraints in segmentation network is a hot topic and of great importance. Also the paradigm of reinforcement learning has received scarce attention for image segmentation models. I believe the authors can bring clarifications to some key questions. The questions to address in the rebuttal are inspired by all reviewer’s concerns: 1) It would be good to highlight the benefits of using reinforcement learning in this context, for reader unfamiliar with this topic. In this regard, please also explicit « Why using reinforcement learning could solve the non-differential loss? »  A figure would be definitely helpful to help readers unfamiliar with RL. 2) Please explain why method can produce more anatomically-plausible segmentations 3) Please discuss the limitations of this approach. 4) Please discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. Other important points, as noted by Rev#2: This paper is related to semi-supervised learning, hence keyword “semi supervised” should be included in the title: the superiority of the method outside of a semi-supervised setting has not been shown, so Please remove the unfinished sentence of section 3.2 « In this paper, we consider a well-known and broadly » In addition of course, if space is left, the authors can also correct any misunderstanding and address additional points raised by the reviewers. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 8 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. This paper presents novel and powerful ideas to constrain image segmentation, as acknowledged by the reviewers. There were issues on the motivation, the impact and the limitations of the method. To my opinion, the authors have addresses these issues in their rebuttal, hence this paper deserves acceptance for its interest regarding methodology. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Accept What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 3 Meta-Review #2 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. I believe the paper is quite borderline, with an interesting RL based application to shape constraints for segmentation, but with substantial drawbacks: clarity of exposition, limitation in experiments (few baselines), limitations in quality of results, etc. It seems to me that the Primary MR values the RL application to anatomical constraints and would like to see the paper accepted. I mostly agree, and believe the rebuttal helps clarify some of the issues, including adding new results on a new dataset with new baselines. I am learning towards a conditional accept, given that the authors include everything they added to the rebuttal with a careful analysis, even in cases where their method does not improve statistically on VAT. The main reason for acceptance is the uniqueness of the method-task combination, which makes it worthwhile to discuss at MICCAI. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Accept What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 12 Meta-Review #3 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. The author added a context-aware virtual adversarial training module into the semi-supervised segmentation pipeline, aiming to preserve the anatomical structure better. The problem to tackle is interesting and well motivated. The experimental results is also promising. The AC agrees that the dice score should not be the only metric to focus on. However, there are several limitations of current versions: more explanation of RL is needed, the module is only tested on one dataset. A lot of edits are needed to address these concerns. Recommend to reject based on current version. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Reject What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 15 Author Feedback Novelty of our method (R2) As underlined by the Meta and R1, we propose a generic and efficient approach for adding any segmentation constraint on top of any segmentation network. For R2’s comment, we argue that our method is not an extension of VAT, but rather uses adversarial training to generate examples violating given constraints without having prior knowledge of these constraints. Our goal is not directly improving the segmentation Dice but instead reducing anatomically-impossible predictions by the network. Experiments show our method to yield a statistically greater constraint satisfaction (non-conn) than VAT and Entropy minimization. Benefits of RL (M,R2,R3) The link between RL and our method is two-fold. 1) As the policy network in RL, the segmentation network predicts label probabilities at pixels. However, the agent’s action in RL and segmentation labels in our work are discrete. 2) Like the reward function in RL, the segmentation constraints in our work can be added on a generic learning strategy, without requiring prior knowledge on that constraint or a differentiable loss function. We achieve these goals via the Reinforce algorithm that is commonly used in policy gradient RL methods. Anatomically-plausible segmentation of method (M,R2,R3) Previous work as [3] showed that a high Dice does not always imply a good segmentation perceived by clinicians. For instance, a segmented region with 90% Dice may still contain holes or disconnected regions that are anatomically impossible. Unlike approaches focusing solely on accuracy measures like Dice, our method also considers complex topological constraints like connectivity which cannot be easily modeled in a loss function. We use adversarial training to concentrate the learning on examples violating the constraints, so the network can learn to avoid making such incorrect predictions on new examples. We demonstrate our method on a hard-to-model constraint with a high applicability: connectivity. Results show our method to give less disconnected pixels compared to other tested approaches (paired t-test p &lt; 0.05). Need for adversarial perturbation (R1,R3) The constraint loss based on the Reinforce algorithm produces a non-zero gradient only if the constraint is violated. Since the constraint can be complex and is not known beforehand, there is no guarantee that it will be violated during training hence that the network will learn to avoid this violation. In our method, we use adversarial training to focus on examples with a non-zero gradient for the constraint loss, thus speeding-up the learning. Meanwhile, the standard VAT term increases the network’s robustness to noise. To answer R1’s question, we tested our method without adversarial training (i.e., r_u=0) and found it gave a similar Dice but a higher HD and constraint violation (non-conn). Limitations of our method (M,R1) Limitations include: 1) the Reinforce algorithm requires sampling several segmentations from the predicted probabilities otherwise the optimization may be unstable; 2) although our method allows adding any constraint, evaluating some constraints during training may be computationally expensive. Other datasets and SOTA (R1,R2) Our method can be added as a plug-in on top of any segmentation approach. We further demonstrate its advantage by adding it on two SOTA approaches, Co-training (Co-T) and Mean Teacher (MT), and testing it on the PROMISE12 dataset (5% labeled): | Dice | HD | Non-conn Ent. min | 50.21 (1.93) | 13.52 (3.95) | 30.33 (6.46) VAT | 50.96 (3.42) | 13.44 (3.57) | 31.96 (2.23) Co-T | 48.92 (2.74) | 9.72 (0.92) | 33.09 (4.06) MT | 67.97 (1.88) | 11.72 (0.76) | 11.33 (3.10) CaVAT | 57.45 (1.23) | 15.60 (2.25) | 21.53 (1.31) Co-T + CaVAT | 63.01 (1.62) | 4.21 (0.72) | 16.10 (3.49) MT + CaVAT | 70.87 (1.70) | 10.17 (0.60) | 9.67 (2.24) Paper title (R2) We will modify the title to include the term semi-supervised. back to top" />
<meta property="og:description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Ping Wang, Jizong Peng, Marco Pedersoli, Yuanfeng Zhou, Caiming Zhang, Christian Desrosiers Abstract In this paper, we present a Context-aware Virtual Adversarial Training (CaVAT) method for producing anatomically plausible segmentation. The proposed method uses reinforcement learning to include any non-differentiable constraint in a semi-supervised setting. Specifically, we incorporate complex anatomical constraints into the VAT framework, boosting the network’s robustness to adversarial examples that maximize both prediction divergence and constraint violation. Experiments on a well-known cardiac segmentation dataset show the effectiveness of our method in terms of segmentation accuracy and improved constraint satisfaction. Link to paper https://doi.org/10.1007/978-3-030-87193-2_29 Link to the code repository N/A Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The paper describes a method to leverage on constraints for semi-supervised training of a deep net to segment images. The crux of the proposed method is an auxiliary loss function, which detects constraint violations in segmentations obtained for images perturbed using the adversarial approach. This loss is stochastic, with gradients computed using the Reinforce rule. the method is generic and could in theory be applied to any task with structured output and any constraint. In the paper, it is demonstrated to improve the performance of a deep net trained to segment cardiac images from the ACDC data set, when only 3-5% of the training labels are used, with the constraint that each class should form a single connected component. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. 1) the idea of using the reinforce rule to minimize the expected number of constraint violations is simple and generic, yet potentially very powerful. 2) the paper is very clear and well written Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. A) it is a pity that the method is only demonstrated with one constraint. B) … and on one data set. C) The paper does not discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. D) I miss a discussion of the limitations of this approach. E) Just for reference, a comparison to another method of semi-supervised segmentation would be nice. This is a minor weakness though, because the advantage of the proposed method is that it accommodates non-differentiable constraints. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The description of the method is clear enough for me to attempt to implement it. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html I develop here on some weaknesses listed in point 4. ad A) could you suggest other constraints/reward designs for which the method could be used? ad C) what would happen if you evaluated the l_cons loss for r_u=0 and without the VAT loss? Is the adversarial perturbation really necessary in your method? ad D) Are there constraint types for which the loss is ineffective? Additional question: Q1. one non-obvious weakness is that l_cons only reinforces samples (patches, in this case) that satisfy the constraints. What about penalizing samples that violate the constraints? Minor comments: i. the role of the subscript i in (7) is not clear until the next section. ii. there is an interrupted sentence in the beginning of 3.2 iii. I cannot find the number of samples used (m) in the paper Please state your overall opinion of the paper Probably accept (7) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? My recommendation is influenced by two main arguments: a simple, generic, well described idea, very compelling the method was only demonstrated to work with a single constraint type What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper This paper presents a semi-supervised learning method which incorporate segmentation constraints over virtual adversarial training to produce anatomically-plausible segmentation. The method is validated on the cardiac image segmentation task. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The idea to incorporate segmentation constraint to produce anatomically-plausible segmentation is reasonable. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The rationale of proposed method was not clearly elaborated. For example, why reinforcement learning is used in the method, what is the particular advantage. Novelty of proposed method is incremental over VAT. It seems this paper has not been well prepared. (1) No introduction for background in the abstract section. (2) Incomplete sentences/paragraphs in Section 3.2, which is in fact a crucial part in the method. Semi-supervised medical-image segmentation has been a popular topic with a number of methods being proposed recently also in MICCAI 2020. However, the authors didn’t compared with any of the recent SOTA methods. How can the authors demonstrate that there method can produce more anatomically-plausible segmentations? Is there any evidence showing the connections between non-connectivity and anatomically plausibility. The method is only validated on one dataset, which may lead to bias conclusions. Please rate the clarity and organization of this paper Poor Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The authors claim to release the code. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html In fact this paper is very related to semi-supervised learning, hence keyword “semi supervised” should be included in the title. A figure could be provided to give a clear illustration for the proposed method. Please state your overall opinion of the paper reject (3) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? My rating is mainly from two perspectives: Technical novelty of this paper is incremental and the use of reinforcement is has not been well motivated. Lack comparisons with SOTA and the evaluation is only conducted on one dataset. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 4 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper proposed a semi-supervised method with an additional non-differentiable constrain attached to the VAT framework, to enhance model robustness and accuracy. They have validated their performance on cardiac image segmentation. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. ++ The problem they tackled, i.e., how to exploit the shape priors (e.g., the anatomical constraints) in semi-supervised learning, is interesting. ++ A new usage of reinforcement learning, i.e., using reinforcement learning to solve the non-differentiable loss term. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. For methods, there are several ambiguous explanations, which make it hard to follow. – In the 2nd term in Eq.3, how the constrain violation term could lead to better anatomical shapes? – For someone who is not familiar with reinforcement learning, I do not quite understand why using reinforcement learning could solve the non-differential loss? Since you used reinforcement learning (RL), what do other commonly-used RL terms including environment and status, refer to in the context? – It would be greatly helpful if there is a brief figure to illustrate your framework and insights. – There may have a typo in Eq.4. It should be $x_{u}+r_{u}$, instead of $x+r_{u}$ ,right? For experiments, I noticed that the improvements over VAT are not significant, i.e., &lt;1% in Dice. Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Since several components are coarsely described with no code available, I am not positive about it. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html It would be great if the authors could elaborate more on several details in methods Regarding the 2nd term in Eq.3, (1) How the constrain violation term would help the network to learn more complex or better anatomical shapes? (2) Why using reinforcement learning could solve the non-differential loss? Regarding Eq. 6, how to sample the discrete segmentation mask? What exactly the constrain mean to direct the reward function to be 1 or 0? In the 3rd paragraph in Section 3.2, you mentioned you utilized a constrain to impose the segmentation regions to have a single connected component. I was wondering if it could generalize well to other applications. For cardiac segmentation on organ structures, it should be fine as the segmented regions like LV, Myo and RV, indeed should be one single piece. However, for some lesions, like the myocardial infarction regions, since they are naturally scattered, is the proposed constrain also appliable here? It would be greatly helpful if there is a brief figure to illustrate your framework and insights. In experiments, I am curious about the performance of VAT + shape constrain in [28]. Please state your overall opinion of the paper probably reject (4) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The explanations on the key component, i.e., the constrain violation, is ambiguous and hard to follow. The performance gains are less significant, i.e., &lt;1% in Dice. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 5 Reviewer confidence Somewhat confident Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. Strengths The idea of using reinforcement learning to include non-differentiable constraint to produce anatomically-plausible segmentation is highly compelling. The paper is very clear and well written. Weaknesses The method is only validated on one dataset. The authors did not compare with any of the recent SOTA methods. Novelty of proposed method is incremental over VAT, wrt to all metrics. Regarding the remark of Rev#2 « Novelty of proposed method is incremental over VAT. i.e., &lt;1% in Dice. »: I completely agree. Thus I advise the authors not to « boldify » the top 1 result, unless statistical significance has been demonstrated, cf for example 77.40 and 77.85 are likely to be statistically similar given the std deviation. However let me acknowledge that the increment in terms of Dice is not what the authors put forward in the text, as they mainly comment on the non-conn metric. That said, I believe even the experimentations with the VAT/Entropy min bring interesting insight as to how to adversarial examples to enforce constraint in segmentation. Despite some justified limits noted by the reviewers, I think the paper has some merits, from a methodological perspective, since proposing a framework that allow to incorporate non-differentiable constraints in segmentation network is a hot topic and of great importance. Also the paradigm of reinforcement learning has received scarce attention for image segmentation models. I believe the authors can bring clarifications to some key questions. The questions to address in the rebuttal are inspired by all reviewer’s concerns: 1) It would be good to highlight the benefits of using reinforcement learning in this context, for reader unfamiliar with this topic. In this regard, please also explicit « Why using reinforcement learning could solve the non-differential loss? »  A figure would be definitely helpful to help readers unfamiliar with RL. 2) Please explain why method can produce more anatomically-plausible segmentations 3) Please discuss the limitations of this approach. 4) Please discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. Other important points, as noted by Rev#2: This paper is related to semi-supervised learning, hence keyword “semi supervised” should be included in the title: the superiority of the method outside of a semi-supervised setting has not been shown, so Please remove the unfinished sentence of section 3.2 « In this paper, we consider a well-known and broadly » In addition of course, if space is left, the authors can also correct any misunderstanding and address additional points raised by the reviewers. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 8 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. This paper presents novel and powerful ideas to constrain image segmentation, as acknowledged by the reviewers. There were issues on the motivation, the impact and the limitations of the method. To my opinion, the authors have addresses these issues in their rebuttal, hence this paper deserves acceptance for its interest regarding methodology. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Accept What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 3 Meta-Review #2 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. I believe the paper is quite borderline, with an interesting RL based application to shape constraints for segmentation, but with substantial drawbacks: clarity of exposition, limitation in experiments (few baselines), limitations in quality of results, etc. It seems to me that the Primary MR values the RL application to anatomical constraints and would like to see the paper accepted. I mostly agree, and believe the rebuttal helps clarify some of the issues, including adding new results on a new dataset with new baselines. I am learning towards a conditional accept, given that the authors include everything they added to the rebuttal with a careful analysis, even in cases where their method does not improve statistically on VAT. The main reason for acceptance is the uniqueness of the method-task combination, which makes it worthwhile to discuss at MICCAI. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Accept What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 12 Meta-Review #3 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. The author added a context-aware virtual adversarial training module into the semi-supervised segmentation pipeline, aiming to preserve the anatomical structure better. The problem to tackle is interesting and well motivated. The experimental results is also promising. The AC agrees that the dice score should not be the only metric to focus on. However, there are several limitations of current versions: more explanation of RL is needed, the module is only tested on one dataset. A lot of edits are needed to address these concerns. Recommend to reject based on current version. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Reject What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 15 Author Feedback Novelty of our method (R2) As underlined by the Meta and R1, we propose a generic and efficient approach for adding any segmentation constraint on top of any segmentation network. For R2’s comment, we argue that our method is not an extension of VAT, but rather uses adversarial training to generate examples violating given constraints without having prior knowledge of these constraints. Our goal is not directly improving the segmentation Dice but instead reducing anatomically-impossible predictions by the network. Experiments show our method to yield a statistically greater constraint satisfaction (non-conn) than VAT and Entropy minimization. Benefits of RL (M,R2,R3) The link between RL and our method is two-fold. 1) As the policy network in RL, the segmentation network predicts label probabilities at pixels. However, the agent’s action in RL and segmentation labels in our work are discrete. 2) Like the reward function in RL, the segmentation constraints in our work can be added on a generic learning strategy, without requiring prior knowledge on that constraint or a differentiable loss function. We achieve these goals via the Reinforce algorithm that is commonly used in policy gradient RL methods. Anatomically-plausible segmentation of method (M,R2,R3) Previous work as [3] showed that a high Dice does not always imply a good segmentation perceived by clinicians. For instance, a segmented region with 90% Dice may still contain holes or disconnected regions that are anatomically impossible. Unlike approaches focusing solely on accuracy measures like Dice, our method also considers complex topological constraints like connectivity which cannot be easily modeled in a loss function. We use adversarial training to concentrate the learning on examples violating the constraints, so the network can learn to avoid making such incorrect predictions on new examples. We demonstrate our method on a hard-to-model constraint with a high applicability: connectivity. Results show our method to give less disconnected pixels compared to other tested approaches (paired t-test p &lt; 0.05). Need for adversarial perturbation (R1,R3) The constraint loss based on the Reinforce algorithm produces a non-zero gradient only if the constraint is violated. Since the constraint can be complex and is not known beforehand, there is no guarantee that it will be violated during training hence that the network will learn to avoid this violation. In our method, we use adversarial training to focus on examples with a non-zero gradient for the constraint loss, thus speeding-up the learning. Meanwhile, the standard VAT term increases the network’s robustness to noise. To answer R1’s question, we tested our method without adversarial training (i.e., r_u=0) and found it gave a similar Dice but a higher HD and constraint violation (non-conn). Limitations of our method (M,R1) Limitations include: 1) the Reinforce algorithm requires sampling several segmentations from the predicted probabilities otherwise the optimization may be unstable; 2) although our method allows adding any constraint, evaluating some constraints during training may be computationally expensive. Other datasets and SOTA (R1,R2) Our method can be added as a plug-in on top of any segmentation approach. We further demonstrate its advantage by adding it on two SOTA approaches, Co-training (Co-T) and Mean Teacher (MT), and testing it on the PROMISE12 dataset (5% labeled): | Dice | HD | Non-conn Ent. min | 50.21 (1.93) | 13.52 (3.95) | 30.33 (6.46) VAT | 50.96 (3.42) | 13.44 (3.57) | 31.96 (2.23) Co-T | 48.92 (2.74) | 9.72 (0.92) | 33.09 (4.06) MT | 67.97 (1.88) | 11.72 (0.76) | 11.33 (3.10) CaVAT | 57.45 (1.23) | 15.60 (2.25) | 21.53 (1.31) Co-T + CaVAT | 63.01 (1.62) | 4.21 (0.72) | 16.10 (3.49) MT + CaVAT | 70.87 (1.70) | 10.17 (0.60) | 9.67 (2.24) Paper title (R2) We will modify the title to include the term semi-supervised. back to top" />
<link rel="canonical" href="https://kittywong.github.io/kittywong/0128/12/31/Paper0710" />
<meta property="og:url" content="https://kittywong.github.io/kittywong/0128/12/31/Paper0710" />
<meta property="og:site_name" content="MICCAI 2021 - Accepted Papers and Reviews" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0128-12-31T23:58:56-05:17" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Context-aware virtual adversarial training for anatomically-plausible segmenation" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://kittywong.github.io/kittywong/0128/12/31/Paper0710"},"@type":"BlogPosting","url":"https://kittywong.github.io/kittywong/0128/12/31/Paper0710","headline":"Context-aware virtual adversarial training for anatomically-plausible segmenation","dateModified":"0128-12-31T00:00:00-05:17","datePublished":"0128-12-31T23:58:56-05:17","description":"Paper Info Reviews Meta-review(s) Author Feedback Authors Ping Wang, Jizong Peng, Marco Pedersoli, Yuanfeng Zhou, Caiming Zhang, Christian Desrosiers Abstract In this paper, we present a Context-aware Virtual Adversarial Training (CaVAT) method for producing anatomically plausible segmentation. The proposed method uses reinforcement learning to include any non-differentiable constraint in a semi-supervised setting. Specifically, we incorporate complex anatomical constraints into the VAT framework, boosting the network’s robustness to adversarial examples that maximize both prediction divergence and constraint violation. Experiments on a well-known cardiac segmentation dataset show the effectiveness of our method in terms of segmentation accuracy and improved constraint satisfaction. Link to paper https://doi.org/10.1007/978-3-030-87193-2_29 Link to the code repository N/A Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The paper describes a method to leverage on constraints for semi-supervised training of a deep net to segment images. The crux of the proposed method is an auxiliary loss function, which detects constraint violations in segmentations obtained for images perturbed using the adversarial approach. This loss is stochastic, with gradients computed using the Reinforce rule. the method is generic and could in theory be applied to any task with structured output and any constraint. In the paper, it is demonstrated to improve the performance of a deep net trained to segment cardiac images from the ACDC data set, when only 3-5% of the training labels are used, with the constraint that each class should form a single connected component. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. 1) the idea of using the reinforce rule to minimize the expected number of constraint violations is simple and generic, yet potentially very powerful. 2) the paper is very clear and well written Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. A) it is a pity that the method is only demonstrated with one constraint. B) … and on one data set. C) The paper does not discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. D) I miss a discussion of the limitations of this approach. E) Just for reference, a comparison to another method of semi-supervised segmentation would be nice. This is a minor weakness though, because the advantage of the proposed method is that it accommodates non-differentiable constraints. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The description of the method is clear enough for me to attempt to implement it. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html I develop here on some weaknesses listed in point 4. ad A) could you suggest other constraints/reward designs for which the method could be used? ad C) what would happen if you evaluated the l_cons loss for r_u=0 and without the VAT loss? Is the adversarial perturbation really necessary in your method? ad D) Are there constraint types for which the loss is ineffective? Additional question: Q1. one non-obvious weakness is that l_cons only reinforces samples (patches, in this case) that satisfy the constraints. What about penalizing samples that violate the constraints? Minor comments: i. the role of the subscript i in (7) is not clear until the next section. ii. there is an interrupted sentence in the beginning of 3.2 iii. I cannot find the number of samples used (m) in the paper Please state your overall opinion of the paper Probably accept (7) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? My recommendation is influenced by two main arguments: a simple, generic, well described idea, very compelling the method was only demonstrated to work with a single constraint type What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper This paper presents a semi-supervised learning method which incorporate segmentation constraints over virtual adversarial training to produce anatomically-plausible segmentation. The method is validated on the cardiac image segmentation task. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The idea to incorporate segmentation constraint to produce anatomically-plausible segmentation is reasonable. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The rationale of proposed method was not clearly elaborated. For example, why reinforcement learning is used in the method, what is the particular advantage. Novelty of proposed method is incremental over VAT. It seems this paper has not been well prepared. (1) No introduction for background in the abstract section. (2) Incomplete sentences/paragraphs in Section 3.2, which is in fact a crucial part in the method. Semi-supervised medical-image segmentation has been a popular topic with a number of methods being proposed recently also in MICCAI 2020. However, the authors didn’t compared with any of the recent SOTA methods. How can the authors demonstrate that there method can produce more anatomically-plausible segmentations? Is there any evidence showing the connections between non-connectivity and anatomically plausibility. The method is only validated on one dataset, which may lead to bias conclusions. Please rate the clarity and organization of this paper Poor Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The authors claim to release the code. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html In fact this paper is very related to semi-supervised learning, hence keyword “semi supervised” should be included in the title. A figure could be provided to give a clear illustration for the proposed method. Please state your overall opinion of the paper reject (3) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? My rating is mainly from two perspectives: Technical novelty of this paper is incremental and the use of reinforcement is has not been well motivated. Lack comparisons with SOTA and the evaluation is only conducted on one dataset. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 4 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper proposed a semi-supervised method with an additional non-differentiable constrain attached to the VAT framework, to enhance model robustness and accuracy. They have validated their performance on cardiac image segmentation. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. ++ The problem they tackled, i.e., how to exploit the shape priors (e.g., the anatomical constraints) in semi-supervised learning, is interesting. ++ A new usage of reinforcement learning, i.e., using reinforcement learning to solve the non-differentiable loss term. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. For methods, there are several ambiguous explanations, which make it hard to follow. – In the 2nd term in Eq.3, how the constrain violation term could lead to better anatomical shapes? – For someone who is not familiar with reinforcement learning, I do not quite understand why using reinforcement learning could solve the non-differential loss? Since you used reinforcement learning (RL), what do other commonly-used RL terms including environment and status, refer to in the context? – It would be greatly helpful if there is a brief figure to illustrate your framework and insights. – There may have a typo in Eq.4. It should be $x_{u}+r_{u}$, instead of $x+r_{u}$ ,right? For experiments, I noticed that the improvements over VAT are not significant, i.e., &lt;1% in Dice. Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Since several components are coarsely described with no code available, I am not positive about it. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html It would be great if the authors could elaborate more on several details in methods Regarding the 2nd term in Eq.3, (1) How the constrain violation term would help the network to learn more complex or better anatomical shapes? (2) Why using reinforcement learning could solve the non-differential loss? Regarding Eq. 6, how to sample the discrete segmentation mask? What exactly the constrain mean to direct the reward function to be 1 or 0? In the 3rd paragraph in Section 3.2, you mentioned you utilized a constrain to impose the segmentation regions to have a single connected component. I was wondering if it could generalize well to other applications. For cardiac segmentation on organ structures, it should be fine as the segmented regions like LV, Myo and RV, indeed should be one single piece. However, for some lesions, like the myocardial infarction regions, since they are naturally scattered, is the proposed constrain also appliable here? It would be greatly helpful if there is a brief figure to illustrate your framework and insights. In experiments, I am curious about the performance of VAT + shape constrain in [28]. Please state your overall opinion of the paper probably reject (4) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The explanations on the key component, i.e., the constrain violation, is ambiguous and hard to follow. The performance gains are less significant, i.e., &lt;1% in Dice. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 5 Reviewer confidence Somewhat confident Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. Strengths The idea of using reinforcement learning to include non-differentiable constraint to produce anatomically-plausible segmentation is highly compelling. The paper is very clear and well written. Weaknesses The method is only validated on one dataset. The authors did not compare with any of the recent SOTA methods. Novelty of proposed method is incremental over VAT, wrt to all metrics. Regarding the remark of Rev#2 « Novelty of proposed method is incremental over VAT. i.e., &lt;1% in Dice. »: I completely agree. Thus I advise the authors not to « boldify » the top 1 result, unless statistical significance has been demonstrated, cf for example 77.40 and 77.85 are likely to be statistically similar given the std deviation. However let me acknowledge that the increment in terms of Dice is not what the authors put forward in the text, as they mainly comment on the non-conn metric. That said, I believe even the experimentations with the VAT/Entropy min bring interesting insight as to how to adversarial examples to enforce constraint in segmentation. Despite some justified limits noted by the reviewers, I think the paper has some merits, from a methodological perspective, since proposing a framework that allow to incorporate non-differentiable constraints in segmentation network is a hot topic and of great importance. Also the paradigm of reinforcement learning has received scarce attention for image segmentation models. I believe the authors can bring clarifications to some key questions. The questions to address in the rebuttal are inspired by all reviewer’s concerns: 1) It would be good to highlight the benefits of using reinforcement learning in this context, for reader unfamiliar with this topic. In this regard, please also explicit « Why using reinforcement learning could solve the non-differential loss? »  A figure would be definitely helpful to help readers unfamiliar with RL. 2) Please explain why method can produce more anatomically-plausible segmentations 3) Please discuss the limitations of this approach. 4) Please discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. Other important points, as noted by Rev#2: This paper is related to semi-supervised learning, hence keyword “semi supervised” should be included in the title: the superiority of the method outside of a semi-supervised setting has not been shown, so Please remove the unfinished sentence of section 3.2 « In this paper, we consider a well-known and broadly » In addition of course, if space is left, the authors can also correct any misunderstanding and address additional points raised by the reviewers. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 8 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. This paper presents novel and powerful ideas to constrain image segmentation, as acknowledged by the reviewers. There were issues on the motivation, the impact and the limitations of the method. To my opinion, the authors have addresses these issues in their rebuttal, hence this paper deserves acceptance for its interest regarding methodology. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Accept What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 3 Meta-Review #2 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. I believe the paper is quite borderline, with an interesting RL based application to shape constraints for segmentation, but with substantial drawbacks: clarity of exposition, limitation in experiments (few baselines), limitations in quality of results, etc. It seems to me that the Primary MR values the RL application to anatomical constraints and would like to see the paper accepted. I mostly agree, and believe the rebuttal helps clarify some of the issues, including adding new results on a new dataset with new baselines. I am learning towards a conditional accept, given that the authors include everything they added to the rebuttal with a careful analysis, even in cases where their method does not improve statistically on VAT. The main reason for acceptance is the uniqueness of the method-task combination, which makes it worthwhile to discuss at MICCAI. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Accept What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 12 Meta-Review #3 Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores, indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision. The author added a context-aware virtual adversarial training module into the semi-supervised segmentation pipeline, aiming to preserve the anatomical structure better. The problem to tackle is interesting and well motivated. The experimental results is also promising. The AC agrees that the dice score should not be the only metric to focus on. However, there are several limitations of current versions: more explanation of RL is needed, the module is only tested on one dataset. A lot of edits are needed to address these concerns. Recommend to reject based on current version. After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal. Reject What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 15 Author Feedback Novelty of our method (R2) As underlined by the Meta and R1, we propose a generic and efficient approach for adding any segmentation constraint on top of any segmentation network. For R2’s comment, we argue that our method is not an extension of VAT, but rather uses adversarial training to generate examples violating given constraints without having prior knowledge of these constraints. Our goal is not directly improving the segmentation Dice but instead reducing anatomically-impossible predictions by the network. Experiments show our method to yield a statistically greater constraint satisfaction (non-conn) than VAT and Entropy minimization. Benefits of RL (M,R2,R3) The link between RL and our method is two-fold. 1) As the policy network in RL, the segmentation network predicts label probabilities at pixels. However, the agent’s action in RL and segmentation labels in our work are discrete. 2) Like the reward function in RL, the segmentation constraints in our work can be added on a generic learning strategy, without requiring prior knowledge on that constraint or a differentiable loss function. We achieve these goals via the Reinforce algorithm that is commonly used in policy gradient RL methods. Anatomically-plausible segmentation of method (M,R2,R3) Previous work as [3] showed that a high Dice does not always imply a good segmentation perceived by clinicians. For instance, a segmented region with 90% Dice may still contain holes or disconnected regions that are anatomically impossible. Unlike approaches focusing solely on accuracy measures like Dice, our method also considers complex topological constraints like connectivity which cannot be easily modeled in a loss function. We use adversarial training to concentrate the learning on examples violating the constraints, so the network can learn to avoid making such incorrect predictions on new examples. We demonstrate our method on a hard-to-model constraint with a high applicability: connectivity. Results show our method to give less disconnected pixels compared to other tested approaches (paired t-test p &lt; 0.05). Need for adversarial perturbation (R1,R3) The constraint loss based on the Reinforce algorithm produces a non-zero gradient only if the constraint is violated. Since the constraint can be complex and is not known beforehand, there is no guarantee that it will be violated during training hence that the network will learn to avoid this violation. In our method, we use adversarial training to focus on examples with a non-zero gradient for the constraint loss, thus speeding-up the learning. Meanwhile, the standard VAT term increases the network’s robustness to noise. To answer R1’s question, we tested our method without adversarial training (i.e., r_u=0) and found it gave a similar Dice but a higher HD and constraint violation (non-conn). Limitations of our method (M,R1) Limitations include: 1) the Reinforce algorithm requires sampling several segmentations from the predicted probabilities otherwise the optimization may be unstable; 2) although our method allows adding any constraint, evaluating some constraints during training may be computationally expensive. Other datasets and SOTA (R1,R2) Our method can be added as a plug-in on top of any segmentation approach. We further demonstrate its advantage by adding it on two SOTA approaches, Co-training (Co-T) and Mean Teacher (MT), and testing it on the PROMISE12 dataset (5% labeled): | Dice | HD | Non-conn Ent. min | 50.21 (1.93) | 13.52 (3.95) | 30.33 (6.46) VAT | 50.96 (3.42) | 13.44 (3.57) | 31.96 (2.23) Co-T | 48.92 (2.74) | 9.72 (0.92) | 33.09 (4.06) MT | 67.97 (1.88) | 11.72 (0.76) | 11.33 (3.10) CaVAT | 57.45 (1.23) | 15.60 (2.25) | 21.53 (1.31) Co-T + CaVAT | 63.01 (1.62) | 4.21 (0.72) | 16.10 (3.49) MT + CaVAT | 70.87 (1.70) | 10.17 (0.60) | 9.67 (2.24) Paper title (R2) We will modify the title to include the term semi-supervised. back to top","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<meta
  name="keywords"
  content="Wang, Ping,Peng, Jizong,Pedersoli, Marco,Zhou, Yuanfeng,Zhang, Caiming,Desrosiers, Christian" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<link
  rel="alternate"
  type="application/rss+xml"
  title="MICCAI 2021 - Accepted Papers and Reviews - "
  href="kittywong/feed.xml" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/base.css" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/highlight.css" />

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async>
</script>


<script src="/assets/scripts/jekyllpaper.js" async></script>
<script
  src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"
  onload="javascript:loadMermaid();"
  async>
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
    //,
    //displayAlign: "left",
    //displayIndent: "2em"
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  </head>
  <body>
    <div class="container-wrapper">
      <header class="container-header">
        <div class="header-info">
  <!-- Added by Elvis Chen -->
  <img src="https://kittywong.github.io/assets/images/miccai2021header.jpg" alt="MICCAI banner">
  <!-- END Added by Elvis Chen -->
  <span class="header-info-name">MICCAI 2021 - Accepted Papers and Reviews</span>
  <span class="header-info-desc"></span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
    <h2>
    
    <li class="header-main-nav-item">
      <a href="kittywong/">
        
          <b>List of Papers</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/categories">
        
          <b>By topics</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/tags">
        
          <b>Author List</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/about">
        
          <b>About</b>
        
      </a>
    </li>
      
    </h2>
  </ul>
</nav>
      </header>
      <main class="container-main">
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<article class="container-post">
  <div class="post-title">
    <h1><span style="color:#1040a7"><b>Context-aware virtual adversarial training for anatomically-plausible segmenation</b></span></h1>
  </div>
  
  <div class="post-author print-post-author">
    <span>Kitty K. Wong</span>
  </div>
  <hr>
    
   
  <div class="post-content">
    <!--
    <div class="post-categories">
      <h2><span style="color:#1040a7">Paper Topic(s):</span></h2> 
      
      
      <a 
        href="kittywong/categories#Image Segmentation"
        class="post-category">
        Image Segmentation
      </a>
      
      <a 
        href="kittywong/categories#Clinical applications - Cardiac"
        class="post-category">
        Clinical applications - Cardiac
      </a>
      
      <a 
        href="kittywong/categories#Computer Aided Diagnosis"
        class="post-category">
        Computer Aided Diagnosis
      </a>
      
      <a 
        href="kittywong/categories#Machine Learning - Reinforcement learning"
        class="post-category">
        Machine Learning - Reinforcement learning
      </a>
      
      <a 
        href="kittywong/categories#Machine Learning - Semi-supervised learning"
        class="post-category">
        Machine Learning - Semi-supervised learning
      </a>
      
      <a 
        href="kittywong/categories#Modalities - CT"
        class="post-category">
        Modalities - CT
      </a>
      
      <a 
        href="kittywong/categories#Modalities - MRI"
        class="post-category">
        Modalities - MRI
      </a>
      
    
    </div>
    <div class="post-tags">
      
      <h2><span style="color:#1040a7">Author(s):</span></h2> 
      
      <a href="kittywong/tags#Wang, Ping"
        class="post-tags">
        Wang, Ping
      </a> |  
      
      <a href="kittywong/tags#Peng, Jizong"
        class="post-tags">
        Peng, Jizong
      </a> |  
      
      <a href="kittywong/tags#Pedersoli, Marco"
        class="post-tags">
        Pedersoli, Marco
      </a> |  
      
      <a href="kittywong/tags#Zhou, Yuanfeng"
        class="post-tags">
        Zhou, Yuanfeng
      </a> |  
      
      <a href="kittywong/tags#Zhang, Caiming"
        class="post-tags">
        Zhang, Caiming
      </a> |  
      
      <a href="kittywong/tags#Desrosiers, Christian"
        class="post-tags">
        Desrosiers, Christian
      </a> |  
      
    </div>
  -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

    .sidenav {
      width: 200px;
      position: fixed;
      z-index: 1;
      top: 150px;
      left: 50px;
      background: #eee;
      overflow-x: hidden;
      padding: 0px 0;
    }
  
    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 16px;
      color: #2196F3;
      color: #FF4500;
      display: block;
    }
  
    .sidenav a:hover {
      color: #064579;
    }
    </style>
  </head>

  <div class="sidenav">
    <a href="#author-id">Paper Info</a>
    <a href="#review-id">Reviews</a>
    <a href="#metareview-id">Meta-Review(s)</a>
    <a href="#authorFeedback-id">Author Feedback</a>
    <a href="">Back to top</a>
    <a href="https://kittywong.github.io">Back to List of papers</a>
  </div>

    <table>
  <tbody>
    <tr>
      <td><a href="#author-id"><span style="color:#ff9900"><b>Paper Info</b></span></a></td>
      <td><a href="#review-id"><span style="color:#ff9900"><b>Reviews</b></span></a></td>
      <td><a href="#metareview-id"><span style="color:#ff9900"><b>Meta-review(s)</b></span></a></td>
      <td><a href="#authorFeedback-id"><span style="color:#ff9900"><b>Author Feedback</b></span></a></td>
    </tr>
  </tbody>
</table>

<h1 id="author-id">Authors</h1>
<p>Ping Wang, Jizong Peng, Marco Pedersoli, Yuanfeng Zhou, Caiming Zhang, Christian Desrosiers
<br /><br /></p>

<h1 id="abstract-id">Abstract</h1>
<p>In this paper, we present a Context-aware Virtual Adversarial Training (CaVAT) method for producing anatomically plausible segmentation. The proposed method uses reinforcement learning to include any non-differentiable constraint in a semi-supervised setting. Specifically, we incorporate complex anatomical constraints into the VAT framework, boosting the network’s robustness to adversarial examples that maximize both prediction divergence and constraint violation. Experiments on a well-known cardiac segmentation dataset show the effectiveness of our method in terms of segmentation accuracy and improved constraint satisfaction.
<br /><br /></p>

<h1 id="link-id">Link to paper</h1>
<p><a href="https://doi.org/10.1007/978-3-030-87193-2_29">https://doi.org/10.1007/978-3-030-87193-2_29</a>
<br /><br /></p>

<h1 id="code-id">Link to the code repository</h1>
<p>N/A
<br /><br /></p>

<h1 id="dataset-id">Link to the dataset(s)</h1>
<p>N/A
<br /><br /></p>

<hr />
<h1 id="review-id">Reviews</h1>

<h3 id="review-1">Review #1</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The paper describes a method to leverage on constraints for semi-supervised training of a deep net to segment images.
The crux of the proposed method is an auxiliary loss function, which detects constraint violations in segmentations obtained for images perturbed using the adversarial approach.
This loss is stochastic, with gradients computed using the Reinforce rule.</p>

      <p>the method is generic and could in theory be applied to any task with structured output and any constraint. 
In the paper, it is demonstrated to improve the performance of a deep net trained to segment cardiac images from the ACDC data set, when only 3-5% of the training labels are used, with the constraint that each class should form a single connected component.</p>

    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>1) the idea of using the reinforce rule to minimize the expected number of constraint violations is simple and generic, yet potentially very powerful.
2) the paper is very clear and well written</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>A) it is a pity that the method is only demonstrated with one constraint.
B) … and on one data set.
C) The paper does not discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image. 
D) I miss a discussion of the limitations of this approach. 
E) Just for reference, a comparison to another method of semi-supervised segmentation would be nice. This is a minor weakness though, because the advantage of the proposed method is that it accommodates non-differentiable constraints.</p>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Excellent</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>The description of the method is clear enough for me to attempt to implement it.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>I develop here on some weaknesses listed in point 4.
ad A) could you suggest other constraints/reward designs for which the method could be used? 
ad C) what would happen if you evaluated the l_cons loss for r_u=0 and without the VAT loss? Is the adversarial perturbation really necessary in your method?
ad D) Are there constraint types for which the loss is ineffective?</p>

      <p>Additional question:
Q1. one non-obvious weakness is that l_cons only reinforces samples (patches, in this case) that satisfy the constraints. What about penalizing samples that violate the constraints?</p>

      <p>Minor comments:
i. the role of the subscript i in (7) is not clear until the next section.
ii. there is an interrupted sentence in the beginning of 3.2
iii. I cannot find the number of samples used (m) in the paper</p>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>Probably accept (7)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>My recommendation is influenced by two main arguments:</p>
      <ul>
        <li>a simple, generic, well described idea, very compelling</li>
        <li>the method was only demonstrated to work with a single constraint type</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>2</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-2">Review #2</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>This paper presents a semi-supervised learning method which incorporate segmentation constraints over virtual adversarial training to produce anatomically-plausible segmentation. The method is validated on the cardiac image segmentation task.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ol>
        <li>The idea to incorporate segmentation constraint to produce anatomically-plausible segmentation is reasonable.</li>
      </ol>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <ol>
        <li>
          <p>The rationale of proposed method was not clearly elaborated. For example, why reinforcement learning is used in the method, what is the particular advantage.</p>
        </li>
        <li>
          <p>Novelty of proposed method is incremental over VAT.</p>
        </li>
        <li>
          <p>It seems this paper has not been well prepared. (1) No introduction for background in the abstract section. (2) Incomplete sentences/paragraphs in Section 3.2, which is in fact a crucial part in the method.</p>
        </li>
        <li>
          <p>Semi-supervised medical-image segmentation has been a popular topic with a number of methods being proposed recently also in MICCAI 2020. However, the authors didn’t compared with any of the recent SOTA methods.</p>
        </li>
        <li>
          <p>How can the authors demonstrate that there method can produce more anatomically-plausible segmentations? Is there any evidence showing the connections between non-connectivity and anatomically plausibility.</p>
        </li>
        <li>
          <p>The method is only validated on one dataset, which may lead to bias conclusions.</p>
        </li>
      </ol>

    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Poor</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>The authors claim to release the code.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <ol>
        <li>
          <p>In fact this paper is very related to semi-supervised learning, hence keyword “semi supervised” should be included in the title.</p>
        </li>
        <li>
          <p>A figure could be provided to give a clear illustration for the proposed method.</p>
        </li>
      </ol>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>reject (3)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>My rating is mainly from two perspectives:</p>
      <ol>
        <li>Technical novelty of this paper is incremental and the use of reinforcement is has not been well motivated.</li>
        <li>Lack comparisons with SOTA and the evaluation is only conducted on one dataset.</li>
      </ol>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Very confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-3">Review #3</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>This paper proposed a semi-supervised method with an additional non-differentiable constrain attached to the VAT framework, to enhance model robustness and accuracy. They have validated their performance on cardiac image segmentation.</p>

    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>++ The problem they tackled, i.e., how to exploit the shape priors (e.g., the anatomical constraints) in semi-supervised learning, is interesting.</p>

      <p>++ A new usage of reinforcement learning, i.e., using reinforcement learning to solve the non-differentiable loss term.</p>

    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>For methods, there are several ambiguous explanations, which make it hard to follow. 
– In the 2nd term in Eq.3, how the constrain violation term could lead to better anatomical shapes?
– For someone who is not familiar with reinforcement learning, I do not quite understand why using reinforcement learning could solve the non-differential loss?
Since you used reinforcement learning (RL), what do other commonly-used RL terms including environment and status, refer to in the context?
– It would be greatly helpful if there is a brief figure to illustrate your framework and insights.
– There may have a typo in Eq.4. It should be $x_{u}+r_{u}$, instead of $x+r_{u}$ ,right?</p>

      <p>For experiments, I noticed that the improvements over VAT are not significant, i.e., &lt;1% in Dice.</p>

    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Satisfactory</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>Since several components are coarsely described with no code available, I am not positive about it.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>It would be great if the authors could elaborate more on several details in methods</p>
      <ol>
        <li>
          <p>Regarding the 2nd term in Eq.3,
(1) How the constrain violation term would help the network to learn more complex or better anatomical shapes?
(2) Why using reinforcement learning could solve the non-differential loss?</p>
        </li>
        <li>
          <p>Regarding Eq. 6, how to sample the discrete segmentation mask? What exactly the constrain mean to direct the reward function to be 1 or 0?</p>
        </li>
        <li>
          <p>In the 3rd paragraph in Section 3.2, you mentioned you utilized a constrain to impose the segmentation regions to have a single connected component. I was wondering if it could generalize well to other applications. For cardiac segmentation on organ structures, it should be fine as the segmented regions like LV, Myo and RV, indeed should be one single piece. However, for some lesions, like the myocardial infarction regions, since they are naturally scattered, is the proposed constrain also appliable here?</p>
        </li>
        <li>
          <p>It would be greatly helpful if there is a brief figure to illustrate your framework and insights.</p>
        </li>
        <li>
          <p>In experiments, I am curious about the performance of VAT + shape constrain in [28].</p>
        </li>
      </ol>

    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>probably reject (4)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <ol>
        <li>The explanations on the key component, i.e., the constrain violation, is ambiguous and hard to follow.</li>
        <li>The performance gains are less significant, i.e., &lt;1% in Dice.</li>
      </ol>

    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Somewhat confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="metareview-id">Meta-Review(s)</h1>

<h2 id="primary-meta-review">Primary Meta-Review</h2>
<ul>
  <li><strong>Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal.</strong>
    <blockquote>
      <p>Strengths</p>
      <ul>
        <li>The idea of using reinforcement learning to include non-differentiable constraint to produce anatomically-plausible segmentation is highly compelling.</li>
        <li>The paper is very clear and well written.</li>
      </ul>

      <p>Weaknesses</p>
      <ul>
        <li>The method is only validated on one dataset.</li>
        <li>The authors did not compare with any of the recent SOTA methods.</li>
        <li>Novelty of proposed method is incremental over VAT, wrt to all metrics.</li>
      </ul>

      <p>Regarding the remark of Rev#2 « Novelty of proposed method is incremental over VAT.  i.e., &lt;1% in Dice. »: I completely agree. Thus I advise the authors not to « boldify » the top 1 result, unless statistical significance has been demonstrated, cf for example 77.40 and 77.85 are likely to be statistically similar given the std deviation. However let me acknowledge that the increment in terms of Dice is not what the authors put forward in the text, as they mainly comment on the non-conn metric.
That said, I believe even the experimentations with the VAT/Entropy min bring interesting insight as to how to adversarial examples to enforce constraint in segmentation.</p>

      <p>Despite some justified limits noted by the reviewers, I think the paper has some merits, from a methodological perspective, since proposing a framework that allow to incorporate non-differentiable constraints in segmentation network is a hot topic and of great importance. Also the paradigm of reinforcement learning has received scarce attention for image segmentation models. I believe the authors can bring clarifications to some key questions.</p>

      <p>The questions to address in the rebuttal are inspired by all reviewer’s concerns:
1) It would be good to highlight the benefits of using reinforcement learning in this context, for reader unfamiliar with this topic. In this regard, please also explicit « Why using reinforcement learning could solve the non-differential loss? »
 A figure would be definitely helpful to help readers unfamiliar with RL.
2) Please explain why method can produce more anatomically-plausible segmentations
3) Please discuss the limitations of this approach.
4) Please discuss why the image needs to be perturbed in an adversarial way to run the loss l_cons. It is also not shown experimentally what happens when l_cons is used on the original image.</p>

      <p>Other important points, as noted by Rev#2:</p>
      <ul>
        <li>This paper is related to semi-supervised learning, hence keyword “semi supervised” should be included in the title: the superiority of the method outside of a semi-supervised setting has not been shown, so</li>
        <li>Please remove the unfinished sentence of section 3.2 « In this paper, we consider a well-known and broadly »</li>
      </ul>

      <p>In addition of course, if space is left, the authors can also correct any misunderstanding and address additional points raised by the reviewers.</p>

    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>8</p>
    </blockquote>
  </li>
  <li><strong>Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores,  indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision.</strong>
    <blockquote>
      <p>This paper presents novel and powerful ideas to constrain image segmentation, as acknowledged by the reviewers.
There were issues on the motivation, the impact and the limitations of the method.
To my opinion, the authors have addresses these issues in their rebuttal,  hence this paper deserves acceptance for its interest regarding methodology.</p>

    </blockquote>
  </li>
  <li><strong>After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal.</strong>
    <blockquote>
      <p>Accept</p>
    </blockquote>
  </li>
  <li><strong>What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>3</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h2 id="meta-review-2">Meta-Review #2</h2>
<ul>
  <li><strong>Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores,  indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision.</strong>
    <blockquote>
      <p>I believe the paper is quite borderline, with an interesting RL based application to shape constraints for segmentation, but with substantial drawbacks: clarity of exposition, limitation in experiments (few baselines), limitations in quality of results, etc.</p>

      <p>It seems to me that the Primary MR values the RL application to anatomical constraints and would like to see the paper accepted. I mostly agree, and believe the rebuttal helps clarify some of the issues, including adding new results on a new dataset with new baselines.</p>

      <p>I am learning towards a conditional accept, given that the authors include everything they added to the rebuttal with a careful analysis, even in cases where their method does not improve statistically on VAT. The main reason for acceptance is the uniqueness of the method-task combination, which makes it worthwhile to discuss at MICCAI.</p>
    </blockquote>
  </li>
  <li><strong>After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal.</strong>
    <blockquote>
      <p>Accept</p>
    </blockquote>
  </li>
  <li><strong>What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>12</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>
<h2 id="meta-review-3">Meta-Review #3</h2>
<ul>
  <li><strong>Please provide your assessment of the paper taking all information into account, including rebuttal. Highlight the key strengths and weaknesses of the paper, clarify how you reconciled contrasting review comments and scores,  indicate if concerns were successfully addressed in the rebuttal, and provide a clear justification of your decision. If you disagree with some of the (meta)reviewer statements, you can indicate so in your meta-review. Please make sure that the authors, program chairs, and the public can understand the reason for your decision.</strong>
    <blockquote>
      <p>The author added a context-aware virtual adversarial training module into the semi-supervised segmentation pipeline, aiming to preserve the anatomical structure better. The problem to tackle is interesting and well motivated. The experimental results is also promising. The AC agrees that the dice score should not be the only metric to focus on. However, there are several limitations of current versions: more explanation of RL is needed, the module is only tested on one dataset. A lot of edits are needed to address these concerns. Recommend to reject based on current version.</p>
    </blockquote>
  </li>
  <li><strong>After you have reviewed the rebuttal, please provide your final rating based on all reviews and the authors’ rebuttal.</strong>
    <blockquote>
      <p>Reject</p>
    </blockquote>
  </li>
  <li><strong>What is the rank of this paper among all your rebuttal papers? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>15</p>
    </blockquote>
  </li>
</ul>

<h2><br /><br /></h2>
<h1 id="authorFeedback-id">Author Feedback</h1>
<blockquote>
  <ul>
    <li>Novelty of our method (R2)</li>
  </ul>

  <p>As underlined by the Meta and R1, we propose a generic and efficient approach for adding any segmentation constraint on top of any segmentation network. For R2’s comment, we argue that our method is not an extension of VAT, but rather <em>uses</em> adversarial training to generate examples violating given constraints without having prior knowledge of these constraints. Our goal is not directly improving the segmentation Dice but instead reducing anatomically-impossible predictions by the network. Experiments show our method to yield a statistically greater constraint satisfaction (non-conn) than VAT and Entropy minimization.</p>

  <ul>
    <li>Benefits of RL (M,R2,R3)</li>
  </ul>

  <p>The link between RL and our method is two-fold. 1) As the policy network in RL, the segmentation network predicts label probabilities at pixels. However, the agent’s action in RL and segmentation labels in our work are <em>discrete</em>. 2) Like the reward function in RL, the segmentation constraints in our work can be added on a generic learning strategy, without requiring prior knowledge on that constraint or a differentiable loss function. We achieve these goals via the Reinforce algorithm that is commonly used in policy gradient RL methods.</p>

  <ul>
    <li>Anatomically-plausible segmentation of method (M,R2,R3)</li>
  </ul>

  <p>Previous work as [3] showed that a high Dice does not always imply a good segmentation perceived by clinicians. For instance, a segmented region with 90% Dice may still contain holes or disconnected regions that are anatomically impossible. Unlike approaches focusing solely on accuracy measures like Dice, our method also considers complex topological constraints like connectivity which cannot be easily modeled in a loss function. We use adversarial training to concentrate the learning on examples violating the constraints, so the network can learn to avoid making such incorrect predictions on new examples. We demonstrate our method on a hard-to-model constraint with a high applicability: connectivity. Results show our method to give less disconnected pixels compared to other tested approaches (paired t-test p &lt; 0.05).</p>

  <ul>
    <li>Need for adversarial perturbation (R1,R3)</li>
  </ul>

  <p>The constraint loss based on the Reinforce algorithm produces a non-zero gradient <em>only</em> if the constraint is violated. Since the constraint can be complex and is not known beforehand, there is no guarantee that it will be violated during training hence that the network will learn to avoid this violation. In our method, we use adversarial training to focus on examples with a non-zero gradient for the constraint loss, thus speeding-up the learning. Meanwhile, the standard VAT term increases the network’s robustness to noise. To answer R1’s question, we tested our method without adversarial training (i.e., r_u=0) and found it gave a similar Dice but a higher HD and constraint violation (non-conn).</p>

  <ul>
    <li>Limitations of our method (M,R1)</li>
  </ul>

  <p>Limitations include: 1) the Reinforce algorithm requires sampling several segmentations from the predicted probabilities otherwise the optimization may be unstable; 2) although our method allows adding any constraint, evaluating some constraints during training may be computationally expensive.</p>

  <ul>
    <li>Other datasets and SOTA (R1,R2)</li>
  </ul>

  <p>Our method can be added as a plug-in on top of any segmentation approach. We further demonstrate its advantage by adding it on two SOTA approaches, Co-training (Co-T) and Mean Teacher (MT), and testing it on the PROMISE12 dataset (5% labeled):</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   | Dice | HD | Non-conn Ent. min | 50.21 (1.93) | 13.52 (3.95) | 30.33 (6.46) VAT | 50.96 (3.42) | 13.44 (3.57) | 31.96 (2.23) Co-T | 48.92 (2.74) | 9.72 (0.92) | 33.09 (4.06) MT | 67.97 (1.88) | 11.72 (0.76) | 11.33 (3.10) CaVAT | 57.45 (1.23) | 15.60 (2.25) | 21.53 (1.31) Co-T + CaVAT | 63.01 (1.62) | 4.21 (0.72) | 16.10 (3.49) MT + CaVAT | 70.87 (1.70) | 10.17 (0.60) | 9.67 (2.24)
</code></pre></div>  </div>

  <ul>
    <li>Paper title (R2)</li>
  </ul>

  <p>We will modify the title to include the term semi-supervised.</p>

</blockquote>

<p><br /><br />
<a href=""><span style="color:#ff9900"><b>back to top</b></span></a></p>

<hr />


  </div>

  <div class="post-info">
    <!--
    <div class="post-date">
      Poster presentation date:  
      0128-12-31
      -->
      <!--
      
        ,
        updated at 
        0129-01-01
      
      .
      
    </div>
    -->
    <!--
    
    <div class="post-author">
      Author: Kitty K. Wong
    </div>
    
    -->
    <div class="post-categories">
      <span><b>Topic(s): </b></span>
      
      <a 
        href="kittywong/categories#Image Segmentation"
        class="post-category">
        Image Segmentation
      </a> |
      
      <a 
        href="kittywong/categories#Clinical applications - Cardiac"
        class="post-category">
        Clinical applications - Cardiac
      </a> |
      
      <a 
        href="kittywong/categories#Computer Aided Diagnosis"
        class="post-category">
        Computer Aided Diagnosis
      </a> |
      
      <a 
        href="kittywong/categories#Machine Learning - Reinforcement learning"
        class="post-category">
        Machine Learning - Reinforcement learning
      </a> |
      
      <a 
        href="kittywong/categories#Machine Learning - Semi-supervised learning"
        class="post-category">
        Machine Learning - Semi-supervised learning
      </a> |
      
      <a 
        href="kittywong/categories#Modalities - CT"
        class="post-category">
        Modalities - CT
      </a> |
      
      <a 
        href="kittywong/categories#Modalities - MRI"
        class="post-category">
        Modalities - MRI
      </a> |
      
    </div>
    <div class="post-tags">
      <!--<span>Author List</span>-->
      <span><b> Author(s): </b></span>
      
      <a href="kittywong/tags#Wang, Ping"
        class="post-category">
        Wang, Ping
      </a> |  
      
      <a href="kittywong/tags#Peng, Jizong"
        class="post-category">
        Peng, Jizong
      </a> |  
      
      <a href="kittywong/tags#Pedersoli, Marco"
        class="post-category">
        Pedersoli, Marco
      </a> |  
      
      <a href="kittywong/tags#Zhou, Yuanfeng"
        class="post-category">
        Zhou, Yuanfeng
      </a> |  
      
      <a href="kittywong/tags#Zhang, Caiming"
        class="post-category">
        Zhang, Caiming
      </a> |  
      
      <a href="kittywong/tags#Desrosiers, Christian"
        class="post-category">
        Desrosiers, Christian
      </a> |  
      
    </div>
    <div class="post-other">
      
      <div>
        <span><b>
          Next paper: 
        </b>
        </span>
        <a href="/0129/12/31/Paper0739">
          Interactive segmentation via deep learning and B-spline explicit active surfaces
        </a>
      </div>
      
      
      <div>
        <span><b>
          Previous paper: 
        </b>
        </span>
        <a href="/0127/12/31/Paper0678">
          MT-UDA: Towards Unsupervised Cross-Modality Medical Image Segmentation with Limited Source Labels
        </a>
      </div>
      
    </div>
    
  </div>
</article>

      </main>
      <footer class="container-footer">
        <div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. Kitty K. Wong, The MICCAI Society
  </span>
</div>
<!--
<div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. example.com.
  </span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>, themed by <a href="https://github.com/ghosind/Jekyll-Paper-Github">Jekyll-Paper-Github</a>.
  </span>
</div>
-->

      </footer>
    </div>
  </body>
</html>
