<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>High-particle simulation of Monte-Carlo dose distribution with 3D ConvLSTMs | MICCAI 2021 - Accepted Papers and Reviews</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="High-particle simulation of Monte-Carlo dose distribution with 3D ConvLSTMs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Sonia Martinot, Norbert Bus, Maria Vakalopoulou, Charlotte Robert, Eric Deutsch, Nikos Paragios Abstract Monte-Carlo simulation of radiotherapy dose remains an extremely time-consuming task, despite being still the most precise tool for radiation transport calculation. To circumvent this issue, deep learning offers promising avenues. In this paper, we extend ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture. Our model’s purpose is to infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. We benchmark our framework against other learning methods commonly used for denoising and other medical tasks. Our model outperforms the other methods with regards to several evaluation metrics used to assess the clinical viability of the predictions. Link to paper https://doi.org/10.1007/978-3-030-87202-1_48 Link to the code repository https://git.io/JcbxD Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper Paper extends ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture, and infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Work used MC simulation can asset to reach accurate and fast computation of dose. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Work is experimental and decent in its goal. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Very hard to duplicate. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html 1) Motivation of the network topology needs explanation. 2) sensitivity analysis of noise effect. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Work is well-presented and results are convincing. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 1 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper The authors describe experiments using long short-term memory (LSTM) for Monte Carlo dose denoising. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The authors motivate the problem, concisely describe their methods and results, and provide good summary of recent literature. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The use of the LTSM formulation does not seem a good match for the problem domain. Monte Carlo calculations are independent samples without a temporal relationship. Please rate the clarity and organization of this paper Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The authors supply access to data and code, which is a positive point Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html This paper attempts to persuade the reader that a LSTM network is a good idea for MC denoising. It is well understood that denoising helps accelerate MC calculations. It is less clear that DL methods are competitive with classical methods, but they might be competitive and are worthy of study. It is even less clear that the LSTM network is a good idea. In section 3.1, it is argued that MC calculations form a sequential process. But in truth, the calculations are independent and adding them in a sequential fashion is rather artificial. One gets the same result if one changes the order they are added or adds them simultaneously. Thus, LSTM seems a poor fit for this application. The experimentation is well executed and well presented. However, there are many reasons that experimental results can be better for one network over another that have nothing to do with architecture. Given that LSTM seems not well matched to the application, the bar is raised a little higher. Please state your overall opinion of the paper borderline accept (6) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Although I do not agree with the authors choice of architecture, which is presented as the main contribution, I also do not reject it out of hand. The authors do a decent job presenting their case, and the paper is well written. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 1 Reviewer confidence Confident but not absolutely certain Review #3 Please describe the contribution of the paper While Monte Carlo simulation remain the gold standard approach to simulate dose maps for treatment planning in photon radiotherapy, the computation time are still really important (even when GPU accelerated). This paper presents a neural network-based method for denoising coarse dose maps computed through MC simulations. Such an approach relies on convolutional LSTM extended to 3 dimensions. Quantitative evaluations show that the proposed approach (coarse noisy MC simulation followed by a denoising step) yields excellent results (when compared to a complete MC simulation) while achieving an important gain in terms of computation time. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The paper is well-structured, clear and easy to read. The evaluation protocols are sound and well justified, and the evaluation results are well discussed and provide interesting insights. The methodology is justified and the intuition behind the chosen ConvLSTM architecture is well explained. In other papers, it feels as if choosing a deep learning-based approach was the “default” choice. However, there is a need to exploit both spatial and temporal information of the given sequence before inferring the highly sampled dose in this application, hence the choice of ConvLSTM is well justified. Also, the intuition behind the chosen hybrid loss function is well explained and clear. An extension of ConvLSTM to 3D is proposed and this allows the network to process medical volumetric sequential data. Each voxel future state can then be predicted from contextual information brough by temporal and spatial features from its own and its neighbors. Extensive evaluations on a dataset from different patients and anatomies are presented, and the proposed approach is compared to other learning based denoising methods. Results show an increase in performance while having less trainable parameters. All implementation details and parameters are disclosed. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. How is the number of particles from the noisy MC simulation chosen? This was not commented in the paper and seems to be an important aspect of the method. In the evaluation, the input noisy maps are computed from 5x10^8 particles, which I believe takes a large amount of time to compute. Can this number be reduced and how does this affect the performance of the denoising? While it is mentioned in the introduction, the gain in terms of computation time was not actually evaluated in the paper. I would recommend adding results about the gain in simulation time by using a denoising approach with respect to a complete MC simulation (and including the time it takes to train the deep learning model). In Figure 2, it seems that there is an error: “right to left” is mentioned in the text description but then the figure from top left is described. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Good. Details about implementation, hyperparameters, split and even data are provided. Number of channels and dimensions of each block are disclosed. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html It is important to comment on the required simulation time for the input noisy dose map. Can you reduce the number of particles simulated without affecting the quality of the final denoised map? Figure 1 is hard to understand since it presents 3 separate methods. I would recommend to separate the figure in 3 different ones or at least present the proposed approach in a separated figure. In section 4, the paper mentions that a complete simulation would take “16k hours”, but this seems to be a lot of time. Is this a typo or perhaps you forgot to mention that it is the time it would take without parallelization? I would recommend also on adding a comment on how your approach would be integrated in clinical practice. What kind of training data would be required (patient specific, simulated…) and how it would be obtained? What would be the required Training time? Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The proposed 3D Conv LSTM as a MC denoiser is an interesting and novel approach for reducing the computation time in procedure planning in radiotherapy. The paper is well written, the method is well explained and the implementation details are also presented. The evaluation is almost complete (just lacking evaluation simulation time) and the approach is compared to a benchmark of deep learning based denoiser. Overall, this paper is really good and I recommend to accept it. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 4 Reviewer confidence Very confident Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. Overall, this is a generally well received paper, highlighting the clarity and strong presentation of the paper. Reviewers also find the choice of the methodology using ConvLSTM to be well justified by the authors, showcasing convincing results with thorough experimentations. Reviewers also appreciate the details on implementation, hyperparameters and data splits. However, R#2 mentions the choice of LTSM formulation does not seem to be a good match for the problem domain, as Monte Carlo calculations are independent samples without a temporal relationship. Authors should discuss this point, and address several of the improvements mentioned by R#3 in the revised paper. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback We thank the reviewers and meta-reviewer for the constructive comments and the appreciation of our method. Reviewer 1&amp;2 argued that LSTMs are not best fitted for this problem because MC calculations are independent. It is true that MC simulations are independent at simulation time. In our paper, we do create a sequence of decreasingly noisy simulations for the model’s input. Assuming that the noisiest simulation in an input sequence requires to simulate 5e8 particles, we create the 5e9 particles simulation by adding 9 other 5e8 particles simulations to the sequence noisy 5e8 particles simulation. Therefore, in an input sequence, the simulations are not independent but rather build on top of each other. Furthermore, the noise in the input sequence exhibits a temporal behavior, as it converges towards 0 as the number of simulated particles increases and that this process depends on the location in the simulation. We believed that ConvLSTMs would be able to learn this dependency, as artificial as it may be. Moreover, for each VMAT plan during training, we were able to create several distinct noisy sequences thanks to the 1000 sub-simulations with 1e8 particles we had to generate to get the ground-truth dose. We argue that this helped the model to better learn the denoising task and generalize. We to investigate other architectures that would be best fitted to the problem and allow to use even noisier simulations as inputs. Reviewer 3 asked multiple questions and precisions regarding computational time requirements. We did use parallelization to compute the dose maps and the time mentioned in the article refers to the accumulated computation time. To get the ground-truth simulation with 1e11 simulated particles we computed 1000 sub-simulations with 1e8 particles using parallelization. Calculating a single 1e8 particles simulation took 3 to 4 hours depending on the considered patient’s anatomy. The number of particles selected for the noisiest input simulation corresponded to over 20% uncertainty in the PTV. Training a deep learning model required about 5 days on one GPU RTX 2080 Ti. Overall, generating the input simulations and training the model constituted a 90.5% gain of computational time over the MC calculations of ground-truth dose maps. However, the time bottleneck indeed remains in the MC calculations of the noisy simulations. Thus, we intend to assess to what extent the level of noise in the input simulations impacts the model’s performance. To integrate this method in clinical practice, the required training data would be the patient’s CT and corresponding noisy simulations. The latter noisy MC simulations would be computed using a standard MC engine. The end goal is therefore to reduce the computational load required to compute the noisy simulations as much as possible while generating Monte-Carlo-like simulation at the level of clinical use. This step undoubtedly necessitates to reduce the number of simulated particles for the model’s input. back to top" />
<meta property="og:description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Sonia Martinot, Norbert Bus, Maria Vakalopoulou, Charlotte Robert, Eric Deutsch, Nikos Paragios Abstract Monte-Carlo simulation of radiotherapy dose remains an extremely time-consuming task, despite being still the most precise tool for radiation transport calculation. To circumvent this issue, deep learning offers promising avenues. In this paper, we extend ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture. Our model’s purpose is to infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. We benchmark our framework against other learning methods commonly used for denoising and other medical tasks. Our model outperforms the other methods with regards to several evaluation metrics used to assess the clinical viability of the predictions. Link to paper https://doi.org/10.1007/978-3-030-87202-1_48 Link to the code repository https://git.io/JcbxD Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper Paper extends ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture, and infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Work used MC simulation can asset to reach accurate and fast computation of dose. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Work is experimental and decent in its goal. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Very hard to duplicate. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html 1) Motivation of the network topology needs explanation. 2) sensitivity analysis of noise effect. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Work is well-presented and results are convincing. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 1 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper The authors describe experiments using long short-term memory (LSTM) for Monte Carlo dose denoising. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The authors motivate the problem, concisely describe their methods and results, and provide good summary of recent literature. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The use of the LTSM formulation does not seem a good match for the problem domain. Monte Carlo calculations are independent samples without a temporal relationship. Please rate the clarity and organization of this paper Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The authors supply access to data and code, which is a positive point Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html This paper attempts to persuade the reader that a LSTM network is a good idea for MC denoising. It is well understood that denoising helps accelerate MC calculations. It is less clear that DL methods are competitive with classical methods, but they might be competitive and are worthy of study. It is even less clear that the LSTM network is a good idea. In section 3.1, it is argued that MC calculations form a sequential process. But in truth, the calculations are independent and adding them in a sequential fashion is rather artificial. One gets the same result if one changes the order they are added or adds them simultaneously. Thus, LSTM seems a poor fit for this application. The experimentation is well executed and well presented. However, there are many reasons that experimental results can be better for one network over another that have nothing to do with architecture. Given that LSTM seems not well matched to the application, the bar is raised a little higher. Please state your overall opinion of the paper borderline accept (6) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Although I do not agree with the authors choice of architecture, which is presented as the main contribution, I also do not reject it out of hand. The authors do a decent job presenting their case, and the paper is well written. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 1 Reviewer confidence Confident but not absolutely certain Review #3 Please describe the contribution of the paper While Monte Carlo simulation remain the gold standard approach to simulate dose maps for treatment planning in photon radiotherapy, the computation time are still really important (even when GPU accelerated). This paper presents a neural network-based method for denoising coarse dose maps computed through MC simulations. Such an approach relies on convolutional LSTM extended to 3 dimensions. Quantitative evaluations show that the proposed approach (coarse noisy MC simulation followed by a denoising step) yields excellent results (when compared to a complete MC simulation) while achieving an important gain in terms of computation time. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The paper is well-structured, clear and easy to read. The evaluation protocols are sound and well justified, and the evaluation results are well discussed and provide interesting insights. The methodology is justified and the intuition behind the chosen ConvLSTM architecture is well explained. In other papers, it feels as if choosing a deep learning-based approach was the “default” choice. However, there is a need to exploit both spatial and temporal information of the given sequence before inferring the highly sampled dose in this application, hence the choice of ConvLSTM is well justified. Also, the intuition behind the chosen hybrid loss function is well explained and clear. An extension of ConvLSTM to 3D is proposed and this allows the network to process medical volumetric sequential data. Each voxel future state can then be predicted from contextual information brough by temporal and spatial features from its own and its neighbors. Extensive evaluations on a dataset from different patients and anatomies are presented, and the proposed approach is compared to other learning based denoising methods. Results show an increase in performance while having less trainable parameters. All implementation details and parameters are disclosed. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. How is the number of particles from the noisy MC simulation chosen? This was not commented in the paper and seems to be an important aspect of the method. In the evaluation, the input noisy maps are computed from 5x10^8 particles, which I believe takes a large amount of time to compute. Can this number be reduced and how does this affect the performance of the denoising? While it is mentioned in the introduction, the gain in terms of computation time was not actually evaluated in the paper. I would recommend adding results about the gain in simulation time by using a denoising approach with respect to a complete MC simulation (and including the time it takes to train the deep learning model). In Figure 2, it seems that there is an error: “right to left” is mentioned in the text description but then the figure from top left is described. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Good. Details about implementation, hyperparameters, split and even data are provided. Number of channels and dimensions of each block are disclosed. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html It is important to comment on the required simulation time for the input noisy dose map. Can you reduce the number of particles simulated without affecting the quality of the final denoised map? Figure 1 is hard to understand since it presents 3 separate methods. I would recommend to separate the figure in 3 different ones or at least present the proposed approach in a separated figure. In section 4, the paper mentions that a complete simulation would take “16k hours”, but this seems to be a lot of time. Is this a typo or perhaps you forgot to mention that it is the time it would take without parallelization? I would recommend also on adding a comment on how your approach would be integrated in clinical practice. What kind of training data would be required (patient specific, simulated…) and how it would be obtained? What would be the required Training time? Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The proposed 3D Conv LSTM as a MC denoiser is an interesting and novel approach for reducing the computation time in procedure planning in radiotherapy. The paper is well written, the method is well explained and the implementation details are also presented. The evaluation is almost complete (just lacking evaluation simulation time) and the approach is compared to a benchmark of deep learning based denoiser. Overall, this paper is really good and I recommend to accept it. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 4 Reviewer confidence Very confident Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. Overall, this is a generally well received paper, highlighting the clarity and strong presentation of the paper. Reviewers also find the choice of the methodology using ConvLSTM to be well justified by the authors, showcasing convincing results with thorough experimentations. Reviewers also appreciate the details on implementation, hyperparameters and data splits. However, R#2 mentions the choice of LTSM formulation does not seem to be a good match for the problem domain, as Monte Carlo calculations are independent samples without a temporal relationship. Authors should discuss this point, and address several of the improvements mentioned by R#3 in the revised paper. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback We thank the reviewers and meta-reviewer for the constructive comments and the appreciation of our method. Reviewer 1&amp;2 argued that LSTMs are not best fitted for this problem because MC calculations are independent. It is true that MC simulations are independent at simulation time. In our paper, we do create a sequence of decreasingly noisy simulations for the model’s input. Assuming that the noisiest simulation in an input sequence requires to simulate 5e8 particles, we create the 5e9 particles simulation by adding 9 other 5e8 particles simulations to the sequence noisy 5e8 particles simulation. Therefore, in an input sequence, the simulations are not independent but rather build on top of each other. Furthermore, the noise in the input sequence exhibits a temporal behavior, as it converges towards 0 as the number of simulated particles increases and that this process depends on the location in the simulation. We believed that ConvLSTMs would be able to learn this dependency, as artificial as it may be. Moreover, for each VMAT plan during training, we were able to create several distinct noisy sequences thanks to the 1000 sub-simulations with 1e8 particles we had to generate to get the ground-truth dose. We argue that this helped the model to better learn the denoising task and generalize. We to investigate other architectures that would be best fitted to the problem and allow to use even noisier simulations as inputs. Reviewer 3 asked multiple questions and precisions regarding computational time requirements. We did use parallelization to compute the dose maps and the time mentioned in the article refers to the accumulated computation time. To get the ground-truth simulation with 1e11 simulated particles we computed 1000 sub-simulations with 1e8 particles using parallelization. Calculating a single 1e8 particles simulation took 3 to 4 hours depending on the considered patient’s anatomy. The number of particles selected for the noisiest input simulation corresponded to over 20% uncertainty in the PTV. Training a deep learning model required about 5 days on one GPU RTX 2080 Ti. Overall, generating the input simulations and training the model constituted a 90.5% gain of computational time over the MC calculations of ground-truth dose maps. However, the time bottleneck indeed remains in the MC calculations of the noisy simulations. Thus, we intend to assess to what extent the level of noise in the input simulations impacts the model’s performance. To integrate this method in clinical practice, the required training data would be the patient’s CT and corresponding noisy simulations. The latter noisy MC simulations would be computed using a standard MC engine. The end goal is therefore to reduce the computational load required to compute the noisy simulations as much as possible while generating Monte-Carlo-like simulation at the level of clinical use. This step undoubtedly necessitates to reduce the number of simulated particles for the model’s input. back to top" />
<link rel="canonical" href="https://kittywong.github.io/kittywong/0447/12/31/Paper1512" />
<meta property="og:url" content="https://kittywong.github.io/kittywong/0447/12/31/Paper1512" />
<meta property="og:site_name" content="MICCAI 2021 - Accepted Papers and Reviews" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0447-12-31T23:58:56-05:17" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="High-particle simulation of Monte-Carlo dose distribution with 3D ConvLSTMs" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://kittywong.github.io/kittywong/0447/12/31/Paper1512"},"@type":"BlogPosting","url":"https://kittywong.github.io/kittywong/0447/12/31/Paper1512","headline":"High-particle simulation of Monte-Carlo dose distribution with 3D ConvLSTMs","dateModified":"0448-01-02T00:00:00-05:17","datePublished":"0447-12-31T23:58:56-05:17","description":"Paper Info Reviews Meta-review(s) Author Feedback Authors Sonia Martinot, Norbert Bus, Maria Vakalopoulou, Charlotte Robert, Eric Deutsch, Nikos Paragios Abstract Monte-Carlo simulation of radiotherapy dose remains an extremely time-consuming task, despite being still the most precise tool for radiation transport calculation. To circumvent this issue, deep learning offers promising avenues. In this paper, we extend ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture. Our model’s purpose is to infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. We benchmark our framework against other learning methods commonly used for denoising and other medical tasks. Our model outperforms the other methods with regards to several evaluation metrics used to assess the clinical viability of the predictions. Link to paper https://doi.org/10.1007/978-3-030-87202-1_48 Link to the code repository https://git.io/JcbxD Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper Paper extends ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture, and infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Work used MC simulation can asset to reach accurate and fast computation of dose. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Work is experimental and decent in its goal. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Very hard to duplicate. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html 1) Motivation of the network topology needs explanation. 2) sensitivity analysis of noise effect. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Work is well-presented and results are convincing. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 1 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper The authors describe experiments using long short-term memory (LSTM) for Monte Carlo dose denoising. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The authors motivate the problem, concisely describe their methods and results, and provide good summary of recent literature. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The use of the LTSM formulation does not seem a good match for the problem domain. Monte Carlo calculations are independent samples without a temporal relationship. Please rate the clarity and organization of this paper Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The authors supply access to data and code, which is a positive point Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html This paper attempts to persuade the reader that a LSTM network is a good idea for MC denoising. It is well understood that denoising helps accelerate MC calculations. It is less clear that DL methods are competitive with classical methods, but they might be competitive and are worthy of study. It is even less clear that the LSTM network is a good idea. In section 3.1, it is argued that MC calculations form a sequential process. But in truth, the calculations are independent and adding them in a sequential fashion is rather artificial. One gets the same result if one changes the order they are added or adds them simultaneously. Thus, LSTM seems a poor fit for this application. The experimentation is well executed and well presented. However, there are many reasons that experimental results can be better for one network over another that have nothing to do with architecture. Given that LSTM seems not well matched to the application, the bar is raised a little higher. Please state your overall opinion of the paper borderline accept (6) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Although I do not agree with the authors choice of architecture, which is presented as the main contribution, I also do not reject it out of hand. The authors do a decent job presenting their case, and the paper is well written. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 1 Reviewer confidence Confident but not absolutely certain Review #3 Please describe the contribution of the paper While Monte Carlo simulation remain the gold standard approach to simulate dose maps for treatment planning in photon radiotherapy, the computation time are still really important (even when GPU accelerated). This paper presents a neural network-based method for denoising coarse dose maps computed through MC simulations. Such an approach relies on convolutional LSTM extended to 3 dimensions. Quantitative evaluations show that the proposed approach (coarse noisy MC simulation followed by a denoising step) yields excellent results (when compared to a complete MC simulation) while achieving an important gain in terms of computation time. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The paper is well-structured, clear and easy to read. The evaluation protocols are sound and well justified, and the evaluation results are well discussed and provide interesting insights. The methodology is justified and the intuition behind the chosen ConvLSTM architecture is well explained. In other papers, it feels as if choosing a deep learning-based approach was the “default” choice. However, there is a need to exploit both spatial and temporal information of the given sequence before inferring the highly sampled dose in this application, hence the choice of ConvLSTM is well justified. Also, the intuition behind the chosen hybrid loss function is well explained and clear. An extension of ConvLSTM to 3D is proposed and this allows the network to process medical volumetric sequential data. Each voxel future state can then be predicted from contextual information brough by temporal and spatial features from its own and its neighbors. Extensive evaluations on a dataset from different patients and anatomies are presented, and the proposed approach is compared to other learning based denoising methods. Results show an increase in performance while having less trainable parameters. All implementation details and parameters are disclosed. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. How is the number of particles from the noisy MC simulation chosen? This was not commented in the paper and seems to be an important aspect of the method. In the evaluation, the input noisy maps are computed from 5x10^8 particles, which I believe takes a large amount of time to compute. Can this number be reduced and how does this affect the performance of the denoising? While it is mentioned in the introduction, the gain in terms of computation time was not actually evaluated in the paper. I would recommend adding results about the gain in simulation time by using a denoising approach with respect to a complete MC simulation (and including the time it takes to train the deep learning model). In Figure 2, it seems that there is an error: “right to left” is mentioned in the text description but then the figure from top left is described. Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Good. Details about implementation, hyperparameters, split and even data are provided. Number of channels and dimensions of each block are disclosed. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html It is important to comment on the required simulation time for the input noisy dose map. Can you reduce the number of particles simulated without affecting the quality of the final denoised map? Figure 1 is hard to understand since it presents 3 separate methods. I would recommend to separate the figure in 3 different ones or at least present the proposed approach in a separated figure. In section 4, the paper mentions that a complete simulation would take “16k hours”, but this seems to be a lot of time. Is this a typo or perhaps you forgot to mention that it is the time it would take without parallelization? I would recommend also on adding a comment on how your approach would be integrated in clinical practice. What kind of training data would be required (patient specific, simulated…) and how it would be obtained? What would be the required Training time? Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The proposed 3D Conv LSTM as a MC denoiser is an interesting and novel approach for reducing the computation time in procedure planning in radiotherapy. The paper is well written, the method is well explained and the implementation details are also presented. The evaluation is almost complete (just lacking evaluation simulation time) and the approach is compared to a benchmark of deep learning based denoiser. Overall, this paper is really good and I recommend to accept it. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 4 Reviewer confidence Very confident Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. Overall, this is a generally well received paper, highlighting the clarity and strong presentation of the paper. Reviewers also find the choice of the methodology using ConvLSTM to be well justified by the authors, showcasing convincing results with thorough experimentations. Reviewers also appreciate the details on implementation, hyperparameters and data splits. However, R#2 mentions the choice of LTSM formulation does not seem to be a good match for the problem domain, as Monte Carlo calculations are independent samples without a temporal relationship. Authors should discuss this point, and address several of the improvements mentioned by R#3 in the revised paper. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback We thank the reviewers and meta-reviewer for the constructive comments and the appreciation of our method. Reviewer 1&amp;2 argued that LSTMs are not best fitted for this problem because MC calculations are independent. It is true that MC simulations are independent at simulation time. In our paper, we do create a sequence of decreasingly noisy simulations for the model’s input. Assuming that the noisiest simulation in an input sequence requires to simulate 5e8 particles, we create the 5e9 particles simulation by adding 9 other 5e8 particles simulations to the sequence noisy 5e8 particles simulation. Therefore, in an input sequence, the simulations are not independent but rather build on top of each other. Furthermore, the noise in the input sequence exhibits a temporal behavior, as it converges towards 0 as the number of simulated particles increases and that this process depends on the location in the simulation. We believed that ConvLSTMs would be able to learn this dependency, as artificial as it may be. Moreover, for each VMAT plan during training, we were able to create several distinct noisy sequences thanks to the 1000 sub-simulations with 1e8 particles we had to generate to get the ground-truth dose. We argue that this helped the model to better learn the denoising task and generalize. We to investigate other architectures that would be best fitted to the problem and allow to use even noisier simulations as inputs. Reviewer 3 asked multiple questions and precisions regarding computational time requirements. We did use parallelization to compute the dose maps and the time mentioned in the article refers to the accumulated computation time. To get the ground-truth simulation with 1e11 simulated particles we computed 1000 sub-simulations with 1e8 particles using parallelization. Calculating a single 1e8 particles simulation took 3 to 4 hours depending on the considered patient’s anatomy. The number of particles selected for the noisiest input simulation corresponded to over 20% uncertainty in the PTV. Training a deep learning model required about 5 days on one GPU RTX 2080 Ti. Overall, generating the input simulations and training the model constituted a 90.5% gain of computational time over the MC calculations of ground-truth dose maps. However, the time bottleneck indeed remains in the MC calculations of the noisy simulations. Thus, we intend to assess to what extent the level of noise in the input simulations impacts the model’s performance. To integrate this method in clinical practice, the required training data would be the patient’s CT and corresponding noisy simulations. The latter noisy MC simulations would be computed using a standard MC engine. The end goal is therefore to reduce the computational load required to compute the noisy simulations as much as possible while generating Monte-Carlo-like simulation at the level of clinical use. This step undoubtedly necessitates to reduce the number of simulated particles for the model’s input. back to top","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<meta
  name="keywords"
  content="Martinot, Sonia,Bus, Norbert,Vakalopoulou, Maria,Robert, Charlotte,Deutsch, Eric,Paragios, Nikos" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<link
  rel="alternate"
  type="application/rss+xml"
  title="MICCAI 2021 - Accepted Papers and Reviews - "
  href="kittywong/feed.xml" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/base.css" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/highlight.css" />

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async>
</script>


<script src="/assets/scripts/jekyllpaper.js" async></script>
<script
  src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"
  onload="javascript:loadMermaid();"
  async>
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
    //,
    //displayAlign: "left",
    //displayIndent: "2em"
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  </head>
  <body>
    <div class="container-wrapper">
      <header class="container-header">
        <div class="header-info">
  <!-- Added by Elvis Chen -->
  <img src="https://kittywong.github.io/assets/images/miccai2021header.jpg" alt="MICCAI banner">
  <!-- END Added by Elvis Chen -->
  <span class="header-info-name">MICCAI 2021 - Accepted Papers and Reviews</span>
  <span class="header-info-desc"></span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
    <h2>
    
    <li class="header-main-nav-item">
      <a href="kittywong/">
        
          <b>List of Papers</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/categories">
        
          <b>By topics</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/tags">
        
          <b>Author List</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/about">
        
          <b>About</b>
        
      </a>
    </li>
      
    </h2>
  </ul>
</nav>
      </header>
      <main class="container-main">
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<article class="container-post">
  <div class="post-title">
    <h1><span style="color:#1040a7"><b>High-particle simulation of Monte-Carlo dose distribution with 3D ConvLSTMs</b></span></h1>
  </div>
  
  <div class="post-author print-post-author">
    <span>Kitty K. Wong</span>
  </div>
  <hr>
    
   
  <div class="post-content">
    <!--
    <div class="post-categories">
      <h2><span style="color:#1040a7">Paper Topic(s):</span></h2> 
      
      
      <a 
        href="kittywong/categories#Visualisation in Biomedical Imaging"
        class="post-category">
        Visualisation in Biomedical Imaging
      </a>
      
      <a 
        href="kittywong/categories#Clinical applications - Oncology"
        class="post-category">
        Clinical applications - Oncology
      </a>
      
      <a 
        href="kittywong/categories#Modalities - other"
        class="post-category">
        Modalities - other
      </a>
      
    
    </div>
    <div class="post-tags">
      
      <h2><span style="color:#1040a7">Author(s):</span></h2> 
      
      <a href="kittywong/tags#Martinot, Sonia"
        class="post-tags">
        Martinot, Sonia
      </a> |  
      
      <a href="kittywong/tags#Bus, Norbert"
        class="post-tags">
        Bus, Norbert
      </a> |  
      
      <a href="kittywong/tags#Vakalopoulou, Maria"
        class="post-tags">
        Vakalopoulou, Maria
      </a> |  
      
      <a href="kittywong/tags#Robert, Charlotte"
        class="post-tags">
        Robert, Charlotte
      </a> |  
      
      <a href="kittywong/tags#Deutsch, Eric"
        class="post-tags">
        Deutsch, Eric
      </a> |  
      
      <a href="kittywong/tags#Paragios, Nikos"
        class="post-tags">
        Paragios, Nikos
      </a> |  
      
    </div>
  -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

    .sidenav {
      width: 200px;
      position: fixed;
      z-index: 1;
      top: 150px;
      left: 50px;
      background: #eee;
      overflow-x: hidden;
      padding: 0px 0;
    }
  
    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 16px;
      color: #2196F3;
      color: #FF4500;
      display: block;
    }
  
    .sidenav a:hover {
      color: #064579;
    }
    </style>
  </head>

  <div class="sidenav">
    <a href="#author-id">Paper Info</a>
    <a href="#review-id">Reviews</a>
    <a href="#metareview-id">Meta-Review(s)</a>
    <a href="#authorFeedback-id">Author Feedback</a>
    <a href="">Back to top</a>
    <a href="https://kittywong.github.io">Back to List of papers</a>
  </div>

    <table>
  <tbody>
    <tr>
      <td><a href="#author-id"><span style="color:#ff9900"><b>Paper Info</b></span></a></td>
      <td><a href="#review-id"><span style="color:#ff9900"><b>Reviews</b></span></a></td>
      <td><a href="#metareview-id"><span style="color:#ff9900"><b>Meta-review(s)</b></span></a></td>
      <td><a href="#authorFeedback-id"><span style="color:#ff9900"><b>Author Feedback</b></span></a></td>
    </tr>
  </tbody>
</table>

<h1 id="author-id">Authors</h1>
<p>Sonia Martinot, Norbert Bus, Maria Vakalopoulou, Charlotte Robert, Eric Deutsch, Nikos Paragios
<br /><br /></p>

<h1 id="abstract-id">Abstract</h1>
<p>Monte-Carlo simulation of radiotherapy dose remains an extremely time-consuming task, despite being still the most precise tool for radiation transport calculation. To circumvent this issue, deep learning offers promising avenues.
In this paper, we extend ConvLSTM to handle 3D data and introduce a 3D recurrent and fully convolutional neural network architecture. Our model’s purpose is to infer a computationally expensive Monte Carlo dose calculation result for VMAT plans with a high number of particles from a sequence of simulations with a low number of particles. We benchmark our framework against other learning methods commonly used for denoising and other medical tasks. Our model outperforms the other methods with regards to several evaluation metrics used to assess the clinical viability of the predictions.
<br /><br /></p>

<h1 id="link-id">Link to paper</h1>
<p><a href="https://doi.org/10.1007/978-3-030-87202-1_48">https://doi.org/10.1007/978-3-030-87202-1_48</a>
<br /><br /></p>

<h1 id="code-id">Link to the code repository</h1>
<p>https://git.io/JcbxD
<br /><br /></p>

<h1 id="dataset-id">Link to the dataset(s)</h1>
<p>N/A
<br /><br /></p>

<hr />
<h1 id="review-id">Reviews</h1>

<h3 id="review-1">Review #1</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>Paper extends ConvLSTM to handle
3D data and introduce a 3D recurrent and fully convolutional neural
network architecture, and infer a computationally
expensive Monte Carlo dose calculation result for VMAT plans with
a high number of particles from a sequence of simulations with a low
number of particles.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>Work used  MC simulation can asset to reach accurate and fast computation of dose.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>Work is experimental and decent in its goal.</p>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Very Good</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>Very hard to duplicate.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>1) Motivation of the network topology needs explanation.</p>

      <p>2) sensitivity analysis of noise effect.</p>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>accept (8)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>Work is well-presented and results are convincing.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-2">Review #2</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The authors describe experiments using long short-term memory (LSTM) for Monte Carlo dose denoising.</p>

    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>The authors motivate the problem, concisely describe their methods and results, and provide good summary of recent literature.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>The use of the LTSM formulation does not seem a good match for the problem domain.  Monte Carlo calculations are independent samples without a temporal relationship.</p>

    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Good</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>The authors supply access to data and code, which is a positive point</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>This paper attempts to persuade the reader that a LSTM network is a good idea for MC denoising.  It is well understood that denoising helps accelerate MC calculations.  It is less clear that DL methods are competitive with classical methods, but they might be competitive and are worthy of study.  It is even less clear that the LSTM network is a good idea.  In section 3.1, it is argued that MC calculations form a sequential process.  But in truth, the calculations are independent and adding them in a sequential fashion is rather artificial.  One gets the same result if one changes the order they are added or adds them simultaneously.  Thus, LSTM seems a poor fit for this application.</p>

      <p>The experimentation is well executed and well presented.  However, there are many reasons that experimental results can be better for one network over another that have nothing to do with architecture.  Given that LSTM seems not well matched to the application, the bar is raised a little higher.</p>

    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>borderline accept (6)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>Although I do not agree with the authors choice of architecture, which is presented as the main contribution, I also do not reject it out of hand.  The authors do a decent job presenting their case, and the paper is well written.</p>

    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-3">Review #3</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>While Monte Carlo simulation remain the gold standard approach to simulate dose maps for treatment planning in photon radiotherapy, the computation time are still really important (even when GPU accelerated). This paper presents a neural network-based method for denoising coarse dose maps computed through MC simulations. Such an approach relies on convolutional LSTM extended to 3 dimensions. Quantitative evaluations show that the proposed approach (coarse noisy MC simulation followed by a denoising step) yields excellent results (when compared to a complete MC simulation) while achieving an important gain in terms of computation time.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ul>
        <li>
          <p>The paper is well-structured, clear and easy to read. The evaluation protocols are sound and well justified, and the evaluation results are well discussed and provide interesting insights.</p>
        </li>
        <li>
          <p>The methodology is justified and the intuition behind the chosen ConvLSTM architecture is well explained. In other papers, it feels as if choosing a deep learning-based approach was the “default” choice. However, there is a need to exploit both spatial and temporal information of the given sequence before inferring the highly sampled dose in this application, hence the choice of ConvLSTM is well justified. Also, the intuition behind the chosen hybrid loss function is well explained and clear.</p>
        </li>
        <li>
          <p>An extension of ConvLSTM to 3D is proposed and this allows the network to process medical volumetric sequential data. Each voxel future state can then be predicted from contextual information brough by temporal and spatial features from its own and its neighbors.</p>
        </li>
        <li>
          <p>Extensive evaluations on a dataset from different patients and anatomies are presented, and the proposed approach is compared to other learning based denoising methods. Results show an increase in performance while having less trainable parameters.</p>
        </li>
        <li>
          <p>All implementation details and parameters are disclosed.</p>
        </li>
      </ul>

    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <ul>
        <li>
          <p>How is the number of particles from the noisy MC simulation chosen? This was not commented in the paper and seems to be an important aspect of the method. In the evaluation, the input noisy maps are computed from 5x10^8 particles, which I believe takes a large amount of time to compute. Can this number be reduced and how does this affect the performance of the denoising?</p>
        </li>
        <li>
          <p>While it is mentioned in the introduction, the gain in terms of computation time was not actually evaluated in the paper. I would recommend adding results about the gain in simulation time by using a denoising approach with respect to a complete MC simulation (and including the time it takes to train the deep learning model).</p>
        </li>
        <li>
          <p>In Figure 2, it seems that there is an error: “right to left” is mentioned in the text description but then the figure from top left is described.</p>
        </li>
      </ul>

    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Excellent</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>Good.
Details about implementation, hyperparameters, split and even data are provided. Number of channels and dimensions of each block are disclosed.</p>

    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <ul>
        <li>
          <p>It is important to comment on the required simulation time for the input noisy dose map. Can you reduce the number of particles simulated without affecting the quality of the final denoised map?</p>
        </li>
        <li>
          <p>Figure 1 is hard to understand since it presents 3 separate methods. I would recommend to separate the figure in 3 different ones or at least present the proposed approach in a separated figure.</p>
        </li>
        <li>
          <p>In section 4, the paper mentions that a complete simulation would take “16k hours”, but this seems to be a lot of time. Is this a typo or perhaps you forgot to mention that it is the time it would take without parallelization?</p>
        </li>
        <li>
          <p>I would recommend also on adding a comment on how your approach would be integrated in clinical practice. What kind of training data would be required (patient specific, simulated…) and how it would be obtained? What would be the required Training time?</p>
        </li>
      </ul>

    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>strong accept (9)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>The proposed 3D Conv LSTM as a MC denoiser is an interesting and novel approach for reducing the computation time in procedure planning in radiotherapy. The paper is well written, the method is well explained and the implementation details are also presented. The evaluation is almost complete (just lacking evaluation simulation time) and the approach is compared to a benchmark of deep learning based denoiser. Overall, this paper is really good and I recommend to accept it.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Very confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="metareview-id">Meta-Review(s)</h1>

<h2 id="primary-meta-review">Primary Meta-Review</h2>
<ul>
  <li><strong>Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal.</strong>
    <blockquote>
      <p>Overall, this is a generally well received paper, highlighting the clarity and strong presentation of the paper. Reviewers also find the choice of the methodology using ConvLSTM to be well justified by the authors, showcasing convincing results with thorough experimentations. Reviewers also appreciate the details on implementation, hyperparameters and data splits.</p>

      <p>However, R#2 mentions the choice of LTSM formulation does not seem to be a good match for the problem domain, as Monte Carlo calculations are independent samples without a temporal relationship. Authors should discuss this point, and address several of the improvements mentioned by R#3 in the revised paper.</p>

    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>2</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="authorFeedback-id">Author Feedback</h1>
<blockquote>
  <p>We thank the reviewers and meta-reviewer for the constructive comments and the appreciation of our method.</p>

  <p>Reviewer 1&amp;2 argued that LSTMs are not best fitted for this problem because MC calculations are independent. 
It is true that MC simulations are independent at simulation time. In our paper, we do create a sequence of decreasingly noisy simulations for the model’s input. Assuming that the noisiest simulation in an input sequence requires to simulate 5e8 particles, we create the 5e9 particles simulation by adding 9 other 5e8 particles simulations to the sequence noisy 5e8 particles simulation. Therefore, in an input sequence, the simulations are not independent but rather build on top of each other. Furthermore, the noise in the input sequence exhibits a temporal behavior, as it converges towards 0 as the number of simulated particles increases and that this process depends on the location in the simulation. We believed that ConvLSTMs would be able to learn this dependency, as artificial as it may be. Moreover, for each VMAT plan during training, we were able to create several distinct noisy sequences thanks to the 1000 sub-simulations with 1e8 particles we had to generate to get the ground-truth dose. We argue that this helped the model to better learn the denoising task and generalize. We to investigate other architectures that would be best fitted to the problem and allow to use even noisier simulations as inputs.</p>

  <p>Reviewer 3 asked multiple questions and precisions regarding computational time requirements. 
We did use parallelization to compute the dose maps and the time mentioned in the article refers to the accumulated computation time. To get the ground-truth simulation with 1e11 simulated particles we computed 1000 sub-simulations with 1e8 particles using parallelization. Calculating a single 1e8 particles simulation took 3 to 4 hours depending on the considered patient’s anatomy. The number of particles selected for the noisiest input simulation corresponded to over 20% uncertainty in the PTV. Training a deep learning model required about 5 days on one GPU RTX 2080 Ti. Overall, generating the input simulations and training the model constituted a 90.5% gain of computational time over the MC calculations of ground-truth dose maps. However, the time bottleneck indeed remains in the MC calculations of the noisy simulations. Thus, we intend to assess to what extent the level of noise in the input simulations impacts the model’s performance.</p>

  <p>To integrate this method in clinical practice, the required training data would be the patient’s CT and corresponding noisy simulations. The latter noisy MC simulations would be computed using a standard MC engine. The end goal is therefore to reduce the computational load required to compute the noisy simulations as much as possible while generating Monte-Carlo-like simulation at the level of clinical use. This step undoubtedly necessitates to reduce the number of simulated particles for the model’s input.</p>

</blockquote>

<p><br /><br />
<a href=""><span style="color:#ff9900"><b>back to top</b></span></a></p>

<hr />


  </div>

  <div class="post-info">
    <!--
    <div class="post-date">
      Poster presentation date:  
      0447-12-31
      -->
      <!--
      
        ,
        updated at 
        0448-01-01
      
      .
      
    </div>
    -->
    <!--
    
    <div class="post-author">
      Author: Kitty K. Wong
    </div>
    
    -->
    <div class="post-categories">
      <span><b>Topic(s): </b></span>
      
      <a 
        href="kittywong/categories#Visualisation in Biomedical Imaging"
        class="post-category">
        Visualisation in Biomedical Imaging
      </a> |
      
      <a 
        href="kittywong/categories#Clinical applications - Oncology"
        class="post-category">
        Clinical applications - Oncology
      </a> |
      
      <a 
        href="kittywong/categories#Modalities - other"
        class="post-category">
        Modalities - other
      </a> |
      
    </div>
    <div class="post-tags">
      <!--<span>Author List</span>-->
      <span><b> Author(s): </b></span>
      
      <a href="kittywong/tags#Martinot, Sonia"
        class="post-category">
        Martinot, Sonia
      </a> |  
      
      <a href="kittywong/tags#Bus, Norbert"
        class="post-category">
        Bus, Norbert
      </a> |  
      
      <a href="kittywong/tags#Vakalopoulou, Maria"
        class="post-category">
        Vakalopoulou, Maria
      </a> |  
      
      <a href="kittywong/tags#Robert, Charlotte"
        class="post-category">
        Robert, Charlotte
      </a> |  
      
      <a href="kittywong/tags#Deutsch, Eric"
        class="post-category">
        Deutsch, Eric
      </a> |  
      
      <a href="kittywong/tags#Paragios, Nikos"
        class="post-category">
        Paragios, Nikos
      </a> |  
      
    </div>
    <div class="post-other">
      
      <div>
        <span><b>
          Next paper: 
        </b>
        </span>
        <a href="/0448/12/31/Paper1513">
          Effective semantic segmentation in Cataract surgery: What matters most?
        </a>
      </div>
      
      
      <div>
        <span><b>
          Previous paper: 
        </b>
        </span>
        <a href="/0446/12/31/Paper1001">
          Personalized CT Organ Dose Estimation from Scout Images
        </a>
      </div>
      
    </div>
    
  </div>
</article>

      </main>
      <footer class="container-footer">
        <div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. Kitty K. Wong, The MICCAI Society
  </span>
</div>
<!--
<div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. example.com.
  </span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>, themed by <a href="https://github.com/ghosind/Jekyll-Paper-Github">Jekyll-Paper-Github</a>.
  </span>
</div>
-->

      </footer>
    </div>
  </body>
</html>
