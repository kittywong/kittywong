<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Deep Open Snake Tracker for Vessel Tracing | MICCAI 2021 - Accepted Papers and Reviews</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Deep Open Snake Tracker for Vessel Tracing" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Li Chen, Wenjin Liu, Niranjan Balu, Mahmud Mossa-Basha, Thomas S. Hatsukami, Jenq-Neng Hwang, Chun Yuan Abstract Vessel tracing by modeling vascular structures in 3D medical images with centerlines and radii can provide useful information for vascular health. Ex-isting algorithms have been developed but there are certain persistent prob-lems such as incomplete or inaccurate vessel tracing, especially in complicat-ed vascular beds like the intracranial arteries. We propose here a deep learn-ing based open curve active contour model (DOST) to trace vessels in 3D images. Initial curves were proposed from a centerline segmentation neural network. Then data-driven machine knowledge was used to predict the stretching direction and vessel radius of the initial curve, while the active contour model (as human knowledge) maintained smoothness and intensity fitness of curves. Finally, considering the non-loop topology of most vascu-latures, individually traced vessels were connected into a tree topology by applying a minimum spanning tree algorithm on a global connection graph. We evaluated DOST on a Time-of-Flight (TOF) MRA intracranial artery da-taset and demonstrated its superior performance over existing segmentation-based and tracking-based vessel tracing methods. In addition, DOST showed strong adaptability on different imaging modalities (CTA, MR T1 SPACE) and vascular beds (coronary arteries). Link to paper https://doi.org/10.1007/978-3-030-87231-1_56 Link to the code repository N/A Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The present paper describes a novel method for vessel tracing in 3D medical images. The method, denominated DOST, begins by applying a neural network to identify vessel curves used as initialization for an active contour model. The stretching direction of the active contour model and the radius of the vessel being traced are predicted by using a deep neural network. Additionally, the vessel curves are connected by creating a vascular tree, which is refined according to predefined criteria. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. In general, the paper is well written, and it presents innovative solutions to problems found in vessel tracing, such as the initialization of the active contour with curves instead of seeds; the evolution of the contour according to parameters predicted by neural networks; and the connection of individual results using a tree, refined according to some predefined criteria. The literature review is extensive and clearly identifies the main problems associated to vessel tracing. The main steps of the method are described in detail, and it is compared to other state-of-the-art methods for vessel tracing using datasets from different imaging modalities, reaching promising results. Finally, an ablation study is also included, to evaluate the contributions of each individual component of the proposed method. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. One suggestion for improvement would be to discuss some of the limitations of the proposed method. For example, how much data is required to train the neural networks it requires and how easy is it to obtain that data. It would also be great if the authors could explain how they estimated the loss threshold of 0.05 and minimum distance of 10mm used to remove edges in the vascular tree, which are mentioned on the last paragraph of page 5. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The method is described in detail in the paper, even when no code is provided. The formulas used for the loss functions and evolution of the active contour are provided together with the formulas of the metrics used to evaluate the method. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Comments were already provided on section 4. Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The paper is well organized and the method is clearly described. The contributions are novel and the method was evaluated in detail with comparison to other state-of-the-art methods and an ablation study. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 3 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper This paper describes a method to extract vessels from 3D medical images, while taking topological and geometric properties of the vessel trees into account. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. This method guarantees the topological properties of the vessel trees, i.e. vessels are continuous lines without gaps, and the vessel trees do not contain loops. Also, a geometric property of vessels (smoothness of the vessels) is taken into account. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Description of parameter sensitivity: How are the parameters alpha and beta for the open snake selected? Are they fixed for all images in the experiment, or do they need to be adjusted depending on the image? Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Datasets are clearly described. One important step is not described in necessary detail. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html In Sec. 2.3: The stretching directions are determined using a deep neural work. But how is this network trained? How does the training data look like, i.e. were manually annotated D+1-dimensional (D=500) vectors used? This is a very significant step, but not mentioned in either “Methods” nor “Experimental settings and results”. In Sec. 2.3: The curves are stretched in a (D+1)-dimensional space, with spatial dimension D=500, and an additional dimension for radius. Is there any intuition about the 500 dimensions of the spatial stretching? In Table 1: The method “OCS” achieves the best values for three metrics, while the proposed method achieves the best values only for two metrics. What is then the advantage of the proposed method compared to “OCS”? In Table 2: Why does the results for OV and AI decrease after adding the global tree constraint? Examples should be provided to show this. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The main steps are illustrated well. Results are convincing (except the comparison with OCS). Ablation study clearly shows the effects of each components of the method. What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper The authors propose a method to segment vasculature in 3D images and to obtain the complete topology of the centerline vasculature tree. The first step is a regular encoder-decoder network to segment the vasculature followed by thresholding and skeletonization in order to obtain initial curves. The second step is the innovative part where the curve is fit and stretch using the deep open snake tracing (DOST: stretching direction is trained by a neural network). Then the final step links all the curves using minimum spanning tree. The methods is evaluated against state-ot-the-art methods on the MRA BRAVE dataset. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The main strength is to propose a pipeline combining robustness of nnet segmentation and smoothness/continuity of snake curve. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The method is not fully clear especially the deep learning part during the snake tracking (what is exactly trained there (direction, stretching magnitude) and how the ground truth is computed). This is the innovative part so it should be more detailed. Also, I don’t fully understand the training masked by the non-zero regions with the segmentation network (see detail in constructive comments). Same for the new evaluation metrics, more details should be brought (figure, more rigorous formulation) because now it is difficult to understand exactly what is computed (see detail in constructive comments). Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Source code is made available and dataset can be asked on reasonable request For the experiments reproducibility is hampered by missing parameters and optimizers used (by reading only the paper): What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)? Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Page 1 Abstract “TOF MRA intracranial artery” -&gt; please explain the acronym Page 3 Figure 2: I don’t understand the example with artificial vessels. Why after the Deep snake tracing, there is so long green parts, as it is outside the vasculature part (blue)? Figure 2: On the TOF MRA image, after minimum spanning tree, there are less snake curve than after Deep snake tracing. Why it is the case? Is there a mechanism to remove some curve too far from the ‘main’ graph? Page 4 “2 blocks in encoder/decoder, each with 2 3D convolutional layers+RELU followed by 3D max pooling/up sampling layers” -&gt; I find it too vague. Why do you mean by 2 blocks? 2 downsampling/upsampling layers? Is there any sigmoid at the end? The output is the distance transform map, right? “The L2 loss for training the segmentation network is masked by the non-zero regions” -&gt; So all the regions where there is no vasculature, do not influence the training? How is it possible that during inference, the network manages to put zero everywhere in those regions if no loss function trained it to do so? Is this because you use pre-trained network? If it is the case, it could be nice to mention it to clarify. Equation 4: Do you want to minimize this function? Equation 6: I is only the image intensity? of the raw image? or the distance transform map? So you want here to maximize bright intensity? Does it work as well for CT scan? “E_{str} is the energy for stretching directions at both ends of the snake” -&gt; Why do you need stretching after the vasculature segmentation+skeletonization? To fill potential gap (false negative segmentation) between curves? Page 5 “6 blocks followed by a convolution layer with D + 1 dimensions (D = 500)” -&gt; Do you mean “fully connected layer” instead of “convolution layer”? “for prediction of the 1-dimensional radius r(P(c(s)))” -&gt; So the radius is computed only at the end of the snake? How do you compute the remaining radius along the curve? “and D-dimensional stretching direction” -&gt; How the direction are encoded in the network? Why 500? How is made the stretching magnitudes ground truth for the training? “Background intensities for the snake pair were sampled from points at twice the radius” -&gt; Why twice the radius? why not one or closer like 1.1? Page 6 Datasets: Training between each dataset are independent? Also, snake energy E_{DOST} ( in particular I(x(s),y(s),z(s)) ) is unchanged between MR and CT dataset? (as the vessel intensity is different bright vs black) Equation 10, 11, 12: It could be nice to have a figure to explain the metrics as it is difficult to grasp the idea. What do you mean by {t_j}, should it be T? the set of all snake curve? But after the minimum spanning tree, the snake curve does not mean anything anymore? I don’t understand what count and match ( min_ij( pt norm &lt; r^ij) ?) mean w.r.t to curves. Evaluation on BRAVE: What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)? “For segmentation-based approaches, Frangi vesselness filter, U-Net and Deep Distance Transform (DDT) were selected” -&gt; How was done the skeletonization and the creation of the tree topology after the segmentation? Page 7 “DOST showed higher performance than most methods.” -&gt; When I look at Table 1, it is not clear what DOST brings compare to OCS. Figure 3: DOST snake curve are based on a segmentation method similar to U-net. So, why there is no noisy outliers as well on DOST? Do you filter the snake curve at some point in your method? Page 8 “Tracing results are shown in Fig. 4” -&gt; Is there any manual part here to select the right artery? Same question for figure 5. “In addition, DOST, as an adaptive hybrid (segmentation and tracking-based) tracing method, is able to identify complete vascular trees from multiple vascular beds and modalities.” -&gt; Would it work as well with the other methods? “DOST is not purely post processing/smoothing on CNN based tracking results. The snake constraint was applied during the trace stretching and the tracing was initiated from segmentation-based curve proposal instead of seed points.” -&gt; This paragraph is not really clear to me. What do you want to discuss/emphasize here? Please state your overall opinion of the paper borderline reject (5) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The method is not clear/detailed enough The implementation of the experiments are not detailed enough (see reproducibility) What is the ranking of this paper in your review stack? 5 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. This paper presents a new method for vessel tracking in 3D image volumes. The method uses deep learning to initialize the active contour model and predict the vessel radii. R1 comments that it is an innovative solution to vessel tracing and suggests mentioning the method’s weaknesses. R2 finds that the results are convincing and has some questions regarding parameter sensitivity and network training. R3 has some concerns about the paper’s clarity on the method and its implementation. After reading the comments raised by the reviewers, my recommendation is given in Q3. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback R1.1limitations The requirement for labeled traces is a limitation. We used 117 training cases from BRAVE. However, we have also shown DOST works with 5/6 cases in CAT08/Harborview data. R1.2parameter for tree constraint 0.05 for loss threshold and 10mm for minimum distance were empirically chosen. Lower threshold and higher distance cause more false/noise connections, while the opposite leads to broken connections/miss tracings on real arteries. R2.1alpha beta The alpha, beta control the membrane and thin-plate terms in snake. Larger beta/alpha makes snake more stiff and harder to adjust to sharp direction changes. They are fixed. R2.2How the stretching network trained? R3.1 deep learning during the tracking is unclear. We followed the training in CNN tracker/ref13 for a fair comparison. The network takes a 3D patch and predicts 1 of the 500 directions (one-hot) for stretching and 1 magnitude for radius. Semi-automated traces (ref23) were used to identify the most matching direction for each patch. 500 was validated and chosen in ref13. Same training set as the segmentation. R2.3/R3.17OCS has better results? As it was stated following table1, ground truth was generated by manually correcting traces from OCS, which inevitably causes smaller mean distance (AI) to OCS. OCS also has the problem of missing many real arteries although arteries are usually consistent (lower ID switch). R2.4OV/AI decrease after tree constraint. After tree constraint, some broken gaps were connected. Some connected arteries might not be traced by the ground truth or they are noise branches, decreasing the overlap OV. R3.2mask in the segmentation? There are two outputs for the segmentation network: distance map (continuous variable) and probability map (artery voxels are 1). The loss was the L2 loss calculated only in the predicted mask region. R3.3More details for evaluation metrics Due to the many contents and page limit, we cannot describe them in more figures or formulas. However, more intuitive descriptions were added. T, same as {t_i}, meaning the set of all snakes. Even after minimum spanning tree, the data structure remains T (only difference: snakes are stretched further). Points (as the unit) on each snake were matched/compared with points on the ground truth for evaluation. R3.4experiments parameter Both networks used Adam optimizer with learning rate of 0.001. R3.5Fig2 We did not draw weak artery signals in green parts. Updated. R3.6mechanism to remove traces? Why no noisy outliers? There is a mechanism to remove outlier traces from graph by 〖Loss〗_con and distance. R3.7segmentation structure 2 down/upsampling layers in each block. Output: distance and probability map trained together. No pretrain. R3.8snake loss function to minimize this function R3.9image intensity in snake energy ”I” is the distance map. No matter which modality, “I” is always bright for arteries. R3.10 Why stretching needed? Segmentation+skeletonization is not robust. Curve proposals are partial broken, which are fixed in the deep snake framework. R3.11”fully connected layer” instead of “convolution layer”? This is a fully convolutional network so that it can be used for images with arbitrary size. R3.12Radius Radius was estimated iteratively at each stretching points. R3.13Background signal Signal was extracted at twice (not 1.1) the radius to avoid the transition region from foreground. R3.14skeletonization All methods used the same skeletonization Ref19. R3.15any manual part in fig4/5 to select the right artery? Yes, we followed the same selection criteria in the challenge from the given landmarks. Arteries were manually selected in fig5 so that they can be evaluated. For intracranial artery, selection was automated with largest connected components in the graph. R3.16confusion in discussion to emphasize the difference of DOST with tracking based methods after smoothing. back to top" />
<meta property="og:description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Li Chen, Wenjin Liu, Niranjan Balu, Mahmud Mossa-Basha, Thomas S. Hatsukami, Jenq-Neng Hwang, Chun Yuan Abstract Vessel tracing by modeling vascular structures in 3D medical images with centerlines and radii can provide useful information for vascular health. Ex-isting algorithms have been developed but there are certain persistent prob-lems such as incomplete or inaccurate vessel tracing, especially in complicat-ed vascular beds like the intracranial arteries. We propose here a deep learn-ing based open curve active contour model (DOST) to trace vessels in 3D images. Initial curves were proposed from a centerline segmentation neural network. Then data-driven machine knowledge was used to predict the stretching direction and vessel radius of the initial curve, while the active contour model (as human knowledge) maintained smoothness and intensity fitness of curves. Finally, considering the non-loop topology of most vascu-latures, individually traced vessels were connected into a tree topology by applying a minimum spanning tree algorithm on a global connection graph. We evaluated DOST on a Time-of-Flight (TOF) MRA intracranial artery da-taset and demonstrated its superior performance over existing segmentation-based and tracking-based vessel tracing methods. In addition, DOST showed strong adaptability on different imaging modalities (CTA, MR T1 SPACE) and vascular beds (coronary arteries). Link to paper https://doi.org/10.1007/978-3-030-87231-1_56 Link to the code repository N/A Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The present paper describes a novel method for vessel tracing in 3D medical images. The method, denominated DOST, begins by applying a neural network to identify vessel curves used as initialization for an active contour model. The stretching direction of the active contour model and the radius of the vessel being traced are predicted by using a deep neural network. Additionally, the vessel curves are connected by creating a vascular tree, which is refined according to predefined criteria. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. In general, the paper is well written, and it presents innovative solutions to problems found in vessel tracing, such as the initialization of the active contour with curves instead of seeds; the evolution of the contour according to parameters predicted by neural networks; and the connection of individual results using a tree, refined according to some predefined criteria. The literature review is extensive and clearly identifies the main problems associated to vessel tracing. The main steps of the method are described in detail, and it is compared to other state-of-the-art methods for vessel tracing using datasets from different imaging modalities, reaching promising results. Finally, an ablation study is also included, to evaluate the contributions of each individual component of the proposed method. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. One suggestion for improvement would be to discuss some of the limitations of the proposed method. For example, how much data is required to train the neural networks it requires and how easy is it to obtain that data. It would also be great if the authors could explain how they estimated the loss threshold of 0.05 and minimum distance of 10mm used to remove edges in the vascular tree, which are mentioned on the last paragraph of page 5. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The method is described in detail in the paper, even when no code is provided. The formulas used for the loss functions and evolution of the active contour are provided together with the formulas of the metrics used to evaluate the method. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Comments were already provided on section 4. Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The paper is well organized and the method is clearly described. The contributions are novel and the method was evaluated in detail with comparison to other state-of-the-art methods and an ablation study. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 3 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper This paper describes a method to extract vessels from 3D medical images, while taking topological and geometric properties of the vessel trees into account. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. This method guarantees the topological properties of the vessel trees, i.e. vessels are continuous lines without gaps, and the vessel trees do not contain loops. Also, a geometric property of vessels (smoothness of the vessels) is taken into account. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Description of parameter sensitivity: How are the parameters alpha and beta for the open snake selected? Are they fixed for all images in the experiment, or do they need to be adjusted depending on the image? Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Datasets are clearly described. One important step is not described in necessary detail. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html In Sec. 2.3: The stretching directions are determined using a deep neural work. But how is this network trained? How does the training data look like, i.e. were manually annotated D+1-dimensional (D=500) vectors used? This is a very significant step, but not mentioned in either “Methods” nor “Experimental settings and results”. In Sec. 2.3: The curves are stretched in a (D+1)-dimensional space, with spatial dimension D=500, and an additional dimension for radius. Is there any intuition about the 500 dimensions of the spatial stretching? In Table 1: The method “OCS” achieves the best values for three metrics, while the proposed method achieves the best values only for two metrics. What is then the advantage of the proposed method compared to “OCS”? In Table 2: Why does the results for OV and AI decrease after adding the global tree constraint? Examples should be provided to show this. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The main steps are illustrated well. Results are convincing (except the comparison with OCS). Ablation study clearly shows the effects of each components of the method. What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper The authors propose a method to segment vasculature in 3D images and to obtain the complete topology of the centerline vasculature tree. The first step is a regular encoder-decoder network to segment the vasculature followed by thresholding and skeletonization in order to obtain initial curves. The second step is the innovative part where the curve is fit and stretch using the deep open snake tracing (DOST: stretching direction is trained by a neural network). Then the final step links all the curves using minimum spanning tree. The methods is evaluated against state-ot-the-art methods on the MRA BRAVE dataset. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The main strength is to propose a pipeline combining robustness of nnet segmentation and smoothness/continuity of snake curve. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The method is not fully clear especially the deep learning part during the snake tracking (what is exactly trained there (direction, stretching magnitude) and how the ground truth is computed). This is the innovative part so it should be more detailed. Also, I don’t fully understand the training masked by the non-zero regions with the segmentation network (see detail in constructive comments). Same for the new evaluation metrics, more details should be brought (figure, more rigorous formulation) because now it is difficult to understand exactly what is computed (see detail in constructive comments). Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Source code is made available and dataset can be asked on reasonable request For the experiments reproducibility is hampered by missing parameters and optimizers used (by reading only the paper): What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)? Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Page 1 Abstract “TOF MRA intracranial artery” -&gt; please explain the acronym Page 3 Figure 2: I don’t understand the example with artificial vessels. Why after the Deep snake tracing, there is so long green parts, as it is outside the vasculature part (blue)? Figure 2: On the TOF MRA image, after minimum spanning tree, there are less snake curve than after Deep snake tracing. Why it is the case? Is there a mechanism to remove some curve too far from the ‘main’ graph? Page 4 “2 blocks in encoder/decoder, each with 2 3D convolutional layers+RELU followed by 3D max pooling/up sampling layers” -&gt; I find it too vague. Why do you mean by 2 blocks? 2 downsampling/upsampling layers? Is there any sigmoid at the end? The output is the distance transform map, right? “The L2 loss for training the segmentation network is masked by the non-zero regions” -&gt; So all the regions where there is no vasculature, do not influence the training? How is it possible that during inference, the network manages to put zero everywhere in those regions if no loss function trained it to do so? Is this because you use pre-trained network? If it is the case, it could be nice to mention it to clarify. Equation 4: Do you want to minimize this function? Equation 6: I is only the image intensity? of the raw image? or the distance transform map? So you want here to maximize bright intensity? Does it work as well for CT scan? “E_{str} is the energy for stretching directions at both ends of the snake” -&gt; Why do you need stretching after the vasculature segmentation+skeletonization? To fill potential gap (false negative segmentation) between curves? Page 5 “6 blocks followed by a convolution layer with D + 1 dimensions (D = 500)” -&gt; Do you mean “fully connected layer” instead of “convolution layer”? “for prediction of the 1-dimensional radius r(P(c(s)))” -&gt; So the radius is computed only at the end of the snake? How do you compute the remaining radius along the curve? “and D-dimensional stretching direction” -&gt; How the direction are encoded in the network? Why 500? How is made the stretching magnitudes ground truth for the training? “Background intensities for the snake pair were sampled from points at twice the radius” -&gt; Why twice the radius? why not one or closer like 1.1? Page 6 Datasets: Training between each dataset are independent? Also, snake energy E_{DOST} ( in particular I(x(s),y(s),z(s)) ) is unchanged between MR and CT dataset? (as the vessel intensity is different bright vs black) Equation 10, 11, 12: It could be nice to have a figure to explain the metrics as it is difficult to grasp the idea. What do you mean by {t_j}, should it be T? the set of all snake curve? But after the minimum spanning tree, the snake curve does not mean anything anymore? I don’t understand what count and match ( min_ij( pt norm &lt; r^ij) ?) mean w.r.t to curves. Evaluation on BRAVE: What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)? “For segmentation-based approaches, Frangi vesselness filter, U-Net and Deep Distance Transform (DDT) were selected” -&gt; How was done the skeletonization and the creation of the tree topology after the segmentation? Page 7 “DOST showed higher performance than most methods.” -&gt; When I look at Table 1, it is not clear what DOST brings compare to OCS. Figure 3: DOST snake curve are based on a segmentation method similar to U-net. So, why there is no noisy outliers as well on DOST? Do you filter the snake curve at some point in your method? Page 8 “Tracing results are shown in Fig. 4” -&gt; Is there any manual part here to select the right artery? Same question for figure 5. “In addition, DOST, as an adaptive hybrid (segmentation and tracking-based) tracing method, is able to identify complete vascular trees from multiple vascular beds and modalities.” -&gt; Would it work as well with the other methods? “DOST is not purely post processing/smoothing on CNN based tracking results. The snake constraint was applied during the trace stretching and the tracing was initiated from segmentation-based curve proposal instead of seed points.” -&gt; This paragraph is not really clear to me. What do you want to discuss/emphasize here? Please state your overall opinion of the paper borderline reject (5) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The method is not clear/detailed enough The implementation of the experiments are not detailed enough (see reproducibility) What is the ranking of this paper in your review stack? 5 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. This paper presents a new method for vessel tracking in 3D image volumes. The method uses deep learning to initialize the active contour model and predict the vessel radii. R1 comments that it is an innovative solution to vessel tracing and suggests mentioning the method’s weaknesses. R2 finds that the results are convincing and has some questions regarding parameter sensitivity and network training. R3 has some concerns about the paper’s clarity on the method and its implementation. After reading the comments raised by the reviewers, my recommendation is given in Q3. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback R1.1limitations The requirement for labeled traces is a limitation. We used 117 training cases from BRAVE. However, we have also shown DOST works with 5/6 cases in CAT08/Harborview data. R1.2parameter for tree constraint 0.05 for loss threshold and 10mm for minimum distance were empirically chosen. Lower threshold and higher distance cause more false/noise connections, while the opposite leads to broken connections/miss tracings on real arteries. R2.1alpha beta The alpha, beta control the membrane and thin-plate terms in snake. Larger beta/alpha makes snake more stiff and harder to adjust to sharp direction changes. They are fixed. R2.2How the stretching network trained? R3.1 deep learning during the tracking is unclear. We followed the training in CNN tracker/ref13 for a fair comparison. The network takes a 3D patch and predicts 1 of the 500 directions (one-hot) for stretching and 1 magnitude for radius. Semi-automated traces (ref23) were used to identify the most matching direction for each patch. 500 was validated and chosen in ref13. Same training set as the segmentation. R2.3/R3.17OCS has better results? As it was stated following table1, ground truth was generated by manually correcting traces from OCS, which inevitably causes smaller mean distance (AI) to OCS. OCS also has the problem of missing many real arteries although arteries are usually consistent (lower ID switch). R2.4OV/AI decrease after tree constraint. After tree constraint, some broken gaps were connected. Some connected arteries might not be traced by the ground truth or they are noise branches, decreasing the overlap OV. R3.2mask in the segmentation? There are two outputs for the segmentation network: distance map (continuous variable) and probability map (artery voxels are 1). The loss was the L2 loss calculated only in the predicted mask region. R3.3More details for evaluation metrics Due to the many contents and page limit, we cannot describe them in more figures or formulas. However, more intuitive descriptions were added. T, same as {t_i}, meaning the set of all snakes. Even after minimum spanning tree, the data structure remains T (only difference: snakes are stretched further). Points (as the unit) on each snake were matched/compared with points on the ground truth for evaluation. R3.4experiments parameter Both networks used Adam optimizer with learning rate of 0.001. R3.5Fig2 We did not draw weak artery signals in green parts. Updated. R3.6mechanism to remove traces? Why no noisy outliers? There is a mechanism to remove outlier traces from graph by 〖Loss〗_con and distance. R3.7segmentation structure 2 down/upsampling layers in each block. Output: distance and probability map trained together. No pretrain. R3.8snake loss function to minimize this function R3.9image intensity in snake energy ”I” is the distance map. No matter which modality, “I” is always bright for arteries. R3.10 Why stretching needed? Segmentation+skeletonization is not robust. Curve proposals are partial broken, which are fixed in the deep snake framework. R3.11”fully connected layer” instead of “convolution layer”? This is a fully convolutional network so that it can be used for images with arbitrary size. R3.12Radius Radius was estimated iteratively at each stretching points. R3.13Background signal Signal was extracted at twice (not 1.1) the radius to avoid the transition region from foreground. R3.14skeletonization All methods used the same skeletonization Ref19. R3.15any manual part in fig4/5 to select the right artery? Yes, we followed the same selection criteria in the challenge from the given landmarks. Arteries were manually selected in fig5 so that they can be evaluated. For intracranial artery, selection was automated with largest connected components in the graph. R3.16confusion in discussion to emphasize the difference of DOST with tracking based methods after smoothing. back to top" />
<link rel="canonical" href="https://kittywong.github.io/kittywong/0655/12/31/Paper0101" />
<meta property="og:url" content="https://kittywong.github.io/kittywong/0655/12/31/Paper0101" />
<meta property="og:site_name" content="MICCAI 2021 - Accepted Papers and Reviews" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0655-12-31T23:58:56-05:17" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Deep Open Snake Tracker for Vessel Tracing" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://kittywong.github.io/kittywong/0655/12/31/Paper0101"},"@type":"BlogPosting","url":"https://kittywong.github.io/kittywong/0655/12/31/Paper0101","headline":"Deep Open Snake Tracker for Vessel Tracing","dateModified":"0656-01-04T00:00:00-05:17","datePublished":"0655-12-31T23:58:56-05:17","description":"Paper Info Reviews Meta-review(s) Author Feedback Authors Li Chen, Wenjin Liu, Niranjan Balu, Mahmud Mossa-Basha, Thomas S. Hatsukami, Jenq-Neng Hwang, Chun Yuan Abstract Vessel tracing by modeling vascular structures in 3D medical images with centerlines and radii can provide useful information for vascular health. Ex-isting algorithms have been developed but there are certain persistent prob-lems such as incomplete or inaccurate vessel tracing, especially in complicat-ed vascular beds like the intracranial arteries. We propose here a deep learn-ing based open curve active contour model (DOST) to trace vessels in 3D images. Initial curves were proposed from a centerline segmentation neural network. Then data-driven machine knowledge was used to predict the stretching direction and vessel radius of the initial curve, while the active contour model (as human knowledge) maintained smoothness and intensity fitness of curves. Finally, considering the non-loop topology of most vascu-latures, individually traced vessels were connected into a tree topology by applying a minimum spanning tree algorithm on a global connection graph. We evaluated DOST on a Time-of-Flight (TOF) MRA intracranial artery da-taset and demonstrated its superior performance over existing segmentation-based and tracking-based vessel tracing methods. In addition, DOST showed strong adaptability on different imaging modalities (CTA, MR T1 SPACE) and vascular beds (coronary arteries). Link to paper https://doi.org/10.1007/978-3-030-87231-1_56 Link to the code repository N/A Link to the dataset(s) N/A Reviews Review #1 Please describe the contribution of the paper The present paper describes a novel method for vessel tracing in 3D medical images. The method, denominated DOST, begins by applying a neural network to identify vessel curves used as initialization for an active contour model. The stretching direction of the active contour model and the radius of the vessel being traced are predicted by using a deep neural network. Additionally, the vessel curves are connected by creating a vascular tree, which is refined according to predefined criteria. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. In general, the paper is well written, and it presents innovative solutions to problems found in vessel tracing, such as the initialization of the active contour with curves instead of seeds; the evolution of the contour according to parameters predicted by neural networks; and the connection of individual results using a tree, refined according to some predefined criteria. The literature review is extensive and clearly identifies the main problems associated to vessel tracing. The main steps of the method are described in detail, and it is compared to other state-of-the-art methods for vessel tracing using datasets from different imaging modalities, reaching promising results. Finally, an ablation study is also included, to evaluate the contributions of each individual component of the proposed method. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. One suggestion for improvement would be to discuss some of the limitations of the proposed method. For example, how much data is required to train the neural networks it requires and how easy is it to obtain that data. It would also be great if the authors could explain how they estimated the loss threshold of 0.05 and minimum distance of 10mm used to remove edges in the vascular tree, which are mentioned on the last paragraph of page 5. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The method is described in detail in the paper, even when no code is provided. The formulas used for the loss functions and evolution of the active contour are provided together with the formulas of the metrics used to evaluate the method. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Comments were already provided on section 4. Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The paper is well organized and the method is clearly described. The contributions are novel and the method was evaluated in detail with comparison to other state-of-the-art methods and an ablation study. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 3 Reviewer confidence Confident but not absolutely certain Review #2 Please describe the contribution of the paper This paper describes a method to extract vessels from 3D medical images, while taking topological and geometric properties of the vessel trees into account. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. This method guarantees the topological properties of the vessel trees, i.e. vessels are continuous lines without gaps, and the vessel trees do not contain loops. Also, a geometric property of vessels (smoothness of the vessels) is taken into account. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Description of parameter sensitivity: How are the parameters alpha and beta for the open snake selected? Are they fixed for all images in the experiment, or do they need to be adjusted depending on the image? Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Datasets are clearly described. One important step is not described in necessary detail. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html In Sec. 2.3: The stretching directions are determined using a deep neural work. But how is this network trained? How does the training data look like, i.e. were manually annotated D+1-dimensional (D=500) vectors used? This is a very significant step, but not mentioned in either “Methods” nor “Experimental settings and results”. In Sec. 2.3: The curves are stretched in a (D+1)-dimensional space, with spatial dimension D=500, and an additional dimension for radius. Is there any intuition about the 500 dimensions of the spatial stretching? In Table 1: The method “OCS” achieves the best values for three metrics, while the proposed method achieves the best values only for two metrics. What is then the advantage of the proposed method compared to “OCS”? In Table 2: Why does the results for OV and AI decrease after adding the global tree constraint? Examples should be provided to show this. Please state your overall opinion of the paper accept (8) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The main steps are illustrated well. Results are convincing (except the comparison with OCS). Ablation study clearly shows the effects of each components of the method. What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper The authors propose a method to segment vasculature in 3D images and to obtain the complete topology of the centerline vasculature tree. The first step is a regular encoder-decoder network to segment the vasculature followed by thresholding and skeletonization in order to obtain initial curves. The second step is the innovative part where the curve is fit and stretch using the deep open snake tracing (DOST: stretching direction is trained by a neural network). Then the final step links all the curves using minimum spanning tree. The methods is evaluated against state-ot-the-art methods on the MRA BRAVE dataset. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The main strength is to propose a pipeline combining robustness of nnet segmentation and smoothness/continuity of snake curve. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The method is not fully clear especially the deep learning part during the snake tracking (what is exactly trained there (direction, stretching magnitude) and how the ground truth is computed). This is the innovative part so it should be more detailed. Also, I don’t fully understand the training masked by the non-zero regions with the segmentation network (see detail in constructive comments). Same for the new evaluation metrics, more details should be brought (figure, more rigorous formulation) because now it is difficult to understand exactly what is computed (see detail in constructive comments). Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Source code is made available and dataset can be asked on reasonable request For the experiments reproducibility is hampered by missing parameters and optimizers used (by reading only the paper): What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)? Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Page 1 Abstract “TOF MRA intracranial artery” -&gt; please explain the acronym Page 3 Figure 2: I don’t understand the example with artificial vessels. Why after the Deep snake tracing, there is so long green parts, as it is outside the vasculature part (blue)? Figure 2: On the TOF MRA image, after minimum spanning tree, there are less snake curve than after Deep snake tracing. Why it is the case? Is there a mechanism to remove some curve too far from the ‘main’ graph? Page 4 “2 blocks in encoder/decoder, each with 2 3D convolutional layers+RELU followed by 3D max pooling/up sampling layers” -&gt; I find it too vague. Why do you mean by 2 blocks? 2 downsampling/upsampling layers? Is there any sigmoid at the end? The output is the distance transform map, right? “The L2 loss for training the segmentation network is masked by the non-zero regions” -&gt; So all the regions where there is no vasculature, do not influence the training? How is it possible that during inference, the network manages to put zero everywhere in those regions if no loss function trained it to do so? Is this because you use pre-trained network? If it is the case, it could be nice to mention it to clarify. Equation 4: Do you want to minimize this function? Equation 6: I is only the image intensity? of the raw image? or the distance transform map? So you want here to maximize bright intensity? Does it work as well for CT scan? “E_{str} is the energy for stretching directions at both ends of the snake” -&gt; Why do you need stretching after the vasculature segmentation+skeletonization? To fill potential gap (false negative segmentation) between curves? Page 5 “6 blocks followed by a convolution layer with D + 1 dimensions (D = 500)” -&gt; Do you mean “fully connected layer” instead of “convolution layer”? “for prediction of the 1-dimensional radius r(P(c(s)))” -&gt; So the radius is computed only at the end of the snake? How do you compute the remaining radius along the curve? “and D-dimensional stretching direction” -&gt; How the direction are encoded in the network? Why 500? How is made the stretching magnitudes ground truth for the training? “Background intensities for the snake pair were sampled from points at twice the radius” -&gt; Why twice the radius? why not one or closer like 1.1? Page 6 Datasets: Training between each dataset are independent? Also, snake energy E_{DOST} ( in particular I(x(s),y(s),z(s)) ) is unchanged between MR and CT dataset? (as the vessel intensity is different bright vs black) Equation 10, 11, 12: It could be nice to have a figure to explain the metrics as it is difficult to grasp the idea. What do you mean by {t_j}, should it be T? the set of all snake curve? But after the minimum spanning tree, the snake curve does not mean anything anymore? I don’t understand what count and match ( min_ij( pt norm &lt; r^ij) ?) mean w.r.t to curves. Evaluation on BRAVE: What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)? “For segmentation-based approaches, Frangi vesselness filter, U-Net and Deep Distance Transform (DDT) were selected” -&gt; How was done the skeletonization and the creation of the tree topology after the segmentation? Page 7 “DOST showed higher performance than most methods.” -&gt; When I look at Table 1, it is not clear what DOST brings compare to OCS. Figure 3: DOST snake curve are based on a segmentation method similar to U-net. So, why there is no noisy outliers as well on DOST? Do you filter the snake curve at some point in your method? Page 8 “Tracing results are shown in Fig. 4” -&gt; Is there any manual part here to select the right artery? Same question for figure 5. “In addition, DOST, as an adaptive hybrid (segmentation and tracking-based) tracing method, is able to identify complete vascular trees from multiple vascular beds and modalities.” -&gt; Would it work as well with the other methods? “DOST is not purely post processing/smoothing on CNN based tracking results. The snake constraint was applied during the trace stretching and the tracing was initiated from segmentation-based curve proposal instead of seed points.” -&gt; This paragraph is not really clear to me. What do you want to discuss/emphasize here? Please state your overall opinion of the paper borderline reject (5) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The method is not clear/detailed enough The implementation of the experiments are not detailed enough (see reproducibility) What is the ranking of this paper in your review stack? 5 Number of papers in your stack 5 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. This paper presents a new method for vessel tracking in 3D image volumes. The method uses deep learning to initialize the active contour model and predict the vessel radii. R1 comments that it is an innovative solution to vessel tracing and suggests mentioning the method’s weaknesses. R2 finds that the results are convincing and has some questions regarding parameter sensitivity and network training. R3 has some concerns about the paper’s clarity on the method and its implementation. After reading the comments raised by the reviewers, my recommendation is given in Q3. What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback R1.1limitations The requirement for labeled traces is a limitation. We used 117 training cases from BRAVE. However, we have also shown DOST works with 5/6 cases in CAT08/Harborview data. R1.2parameter for tree constraint 0.05 for loss threshold and 10mm for minimum distance were empirically chosen. Lower threshold and higher distance cause more false/noise connections, while the opposite leads to broken connections/miss tracings on real arteries. R2.1alpha beta The alpha, beta control the membrane and thin-plate terms in snake. Larger beta/alpha makes snake more stiff and harder to adjust to sharp direction changes. They are fixed. R2.2How the stretching network trained? R3.1 deep learning during the tracking is unclear. We followed the training in CNN tracker/ref13 for a fair comparison. The network takes a 3D patch and predicts 1 of the 500 directions (one-hot) for stretching and 1 magnitude for radius. Semi-automated traces (ref23) were used to identify the most matching direction for each patch. 500 was validated and chosen in ref13. Same training set as the segmentation. R2.3/R3.17OCS has better results? As it was stated following table1, ground truth was generated by manually correcting traces from OCS, which inevitably causes smaller mean distance (AI) to OCS. OCS also has the problem of missing many real arteries although arteries are usually consistent (lower ID switch). R2.4OV/AI decrease after tree constraint. After tree constraint, some broken gaps were connected. Some connected arteries might not be traced by the ground truth or they are noise branches, decreasing the overlap OV. R3.2mask in the segmentation? There are two outputs for the segmentation network: distance map (continuous variable) and probability map (artery voxels are 1). The loss was the L2 loss calculated only in the predicted mask region. R3.3More details for evaluation metrics Due to the many contents and page limit, we cannot describe them in more figures or formulas. However, more intuitive descriptions were added. T, same as {t_i}, meaning the set of all snakes. Even after minimum spanning tree, the data structure remains T (only difference: snakes are stretched further). Points (as the unit) on each snake were matched/compared with points on the ground truth for evaluation. R3.4experiments parameter Both networks used Adam optimizer with learning rate of 0.001. R3.5Fig2 We did not draw weak artery signals in green parts. Updated. R3.6mechanism to remove traces? Why no noisy outliers? There is a mechanism to remove outlier traces from graph by 〖Loss〗_con and distance. R3.7segmentation structure 2 down/upsampling layers in each block. Output: distance and probability map trained together. No pretrain. R3.8snake loss function to minimize this function R3.9image intensity in snake energy ”I” is the distance map. No matter which modality, “I” is always bright for arteries. R3.10 Why stretching needed? Segmentation+skeletonization is not robust. Curve proposals are partial broken, which are fixed in the deep snake framework. R3.11”fully connected layer” instead of “convolution layer”? This is a fully convolutional network so that it can be used for images with arbitrary size. R3.12Radius Radius was estimated iteratively at each stretching points. R3.13Background signal Signal was extracted at twice (not 1.1) the radius to avoid the transition region from foreground. R3.14skeletonization All methods used the same skeletonization Ref19. R3.15any manual part in fig4/5 to select the right artery? Yes, we followed the same selection criteria in the challenge from the given landmarks. Arteries were manually selected in fig5 so that they can be evaluated. For intracranial artery, selection was automated with largest connected components in the graph. R3.16confusion in discussion to emphasize the difference of DOST with tracking based methods after smoothing. back to top","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<meta
  name="keywords"
  content="Chen, Li,Liu, Wenjin,Balu, Niranjan,Mossa-Basha, Mahmud,Hatsukami, Thomas S.,Hwang, Jenq-Neng,Yuan, Chun" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<link
  rel="alternate"
  type="application/rss+xml"
  title="MICCAI 2021 - Accepted Papers and Reviews - "
  href="kittywong/feed.xml" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/base.css" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/highlight.css" />

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async>
</script>


<script src="/assets/scripts/jekyllpaper.js" async></script>
<script
  src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"
  onload="javascript:loadMermaid();"
  async>
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
    //,
    //displayAlign: "left",
    //displayIndent: "2em"
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  </head>
  <body>
    <div class="container-wrapper">
      <header class="container-header">
        <div class="header-info">
  <!-- Added by Elvis Chen -->
  <img src="https://kittywong.github.io/assets/images/miccai2021header.jpg" alt="MICCAI banner">
  <!-- END Added by Elvis Chen -->
  <span class="header-info-name">MICCAI 2021 - Accepted Papers and Reviews</span>
  <span class="header-info-desc"></span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
    <h2>
    
    <li class="header-main-nav-item">
      <a href="kittywong/">
        
          <b>List of Papers</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/categories">
        
          <b>By topics</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/tags">
        
          <b>Author List</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/about">
        
          <b>About</b>
        
      </a>
    </li>
      
    </h2>
  </ul>
</nav>
      </header>
      <main class="container-main">
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<article class="container-post">
  <div class="post-title">
    <h1><span style="color:#1040a7"><b>Deep Open Snake Tracker for Vessel Tracing </b></span></h1>
  </div>
  
  <div class="post-author print-post-author">
    <span>Kitty K. Wong</span>
  </div>
  <hr>
    
   
  <div class="post-content">
    <!--
    <div class="post-categories">
      <h2><span style="color:#1040a7">Paper Topic(s):</span></h2> 
      
      
      <a 
        href="kittywong/categories#Clinical applications - Vascular"
        class="post-category">
        Clinical applications - Vascular
      </a>
      
      <a 
        href="kittywong/categories#Computational Anatomy and Physiology"
        class="post-category">
        Computational Anatomy and Physiology
      </a>
      
      <a 
        href="kittywong/categories#Image Segmentation"
        class="post-category">
        Image Segmentation
      </a>
      
      <a 
        href="kittywong/categories#Modalities - CT"
        class="post-category">
        Modalities - CT
      </a>
      
      <a 
        href="kittywong/categories#Modalities - MRI"
        class="post-category">
        Modalities - MRI
      </a>
      
    
    </div>
    <div class="post-tags">
      
      <h2><span style="color:#1040a7">Author(s):</span></h2> 
      
      <a href="kittywong/tags#Chen, Li"
        class="post-tags">
        Chen, Li
      </a> |  
      
      <a href="kittywong/tags#Liu, Wenjin"
        class="post-tags">
        Liu, Wenjin
      </a> |  
      
      <a href="kittywong/tags#Balu, Niranjan"
        class="post-tags">
        Balu, Niranjan
      </a> |  
      
      <a href="kittywong/tags#Mossa-Basha, Mahmud"
        class="post-tags">
        Mossa-Basha, Mahmud
      </a> |  
      
      <a href="kittywong/tags#Hatsukami, Thomas S."
        class="post-tags">
        Hatsukami, Thomas S.
      </a> |  
      
      <a href="kittywong/tags#Hwang, Jenq-Neng"
        class="post-tags">
        Hwang, Jenq-Neng
      </a> |  
      
      <a href="kittywong/tags#Yuan, Chun"
        class="post-tags">
        Yuan, Chun
      </a> |  
      
    </div>
  -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

    .sidenav {
      width: 200px;
      position: fixed;
      z-index: 1;
      top: 150px;
      left: 50px;
      background: #eee;
      overflow-x: hidden;
      padding: 0px 0;
    }
  
    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 16px;
      color: #2196F3;
      color: #FF4500;
      display: block;
    }
  
    .sidenav a:hover {
      color: #064579;
    }
    </style>
  </head>

  <div class="sidenav">
    <a href="#author-id">Paper Info</a>
    <a href="#review-id">Reviews</a>
    <a href="#metareview-id">Meta-Review(s)</a>
    <a href="#authorFeedback-id">Author Feedback</a>
    <a href="">Back to top</a>
    <a href="https://kittywong.github.io">Back to List of papers</a>
  </div>

    <table>
  <tbody>
    <tr>
      <td><a href="#author-id"><span style="color:#ff9900"><b>Paper Info</b></span></a></td>
      <td><a href="#review-id"><span style="color:#ff9900"><b>Reviews</b></span></a></td>
      <td><a href="#metareview-id"><span style="color:#ff9900"><b>Meta-review(s)</b></span></a></td>
      <td><a href="#authorFeedback-id"><span style="color:#ff9900"><b>Author Feedback</b></span></a></td>
    </tr>
  </tbody>
</table>

<h1 id="author-id">Authors</h1>
<p>Li Chen, Wenjin Liu, Niranjan Balu, Mahmud Mossa-Basha, Thomas S. Hatsukami, Jenq-Neng Hwang, Chun Yuan
<br /><br /></p>

<h1 id="abstract-id">Abstract</h1>
<p>Vessel tracing by modeling vascular structures in 3D medical images with centerlines and radii can provide useful information for vascular health. Ex-isting algorithms have been developed but there are certain persistent prob-lems such as incomplete or inaccurate vessel tracing, especially in complicat-ed vascular beds like the intracranial arteries. We propose here a deep learn-ing based open curve active contour model (DOST) to trace vessels in 3D images. Initial curves were proposed from a centerline segmentation neural network. Then data-driven machine knowledge was used to predict the stretching direction and vessel radius of the initial curve, while the active contour model (as human knowledge) maintained smoothness and intensity fitness of curves. Finally, considering the non-loop topology of most vascu-latures, individually traced vessels were connected into a tree topology by applying a minimum spanning tree algorithm on a global connection graph. We evaluated DOST on a Time-of-Flight (TOF) MRA intracranial artery da-taset and demonstrated its superior performance over existing segmentation-based and tracking-based vessel tracing methods. In addition, DOST showed strong adaptability on different imaging modalities (CTA, MR T1 SPACE) and vascular beds (coronary arteries). 
<br /><br /></p>

<h1 id="link-id">Link to paper</h1>
<p><a href="https://doi.org/10.1007/978-3-030-87231-1_56">https://doi.org/10.1007/978-3-030-87231-1_56</a>
<br /><br /></p>

<h1 id="code-id">Link to the code repository</h1>
<p>N/A
<br /><br /></p>

<h1 id="dataset-id">Link to the dataset(s)</h1>
<p>N/A
<br /><br /></p>

<hr />
<h1 id="review-id">Reviews</h1>

<h3 id="review-1">Review #1</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The present paper describes a novel method for vessel tracing in 3D medical images. The method, denominated DOST, begins by applying a neural network to identify vessel curves used as initialization for an active contour model. The stretching direction of the active contour model and the radius of the vessel being traced are predicted by using a deep neural network. Additionally, the vessel curves are connected by creating a vascular tree, which is refined according to predefined criteria.</p>

    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>In general, the paper is well written, and it presents innovative solutions to problems found in vessel tracing, such as the initialization of the active contour with curves instead of seeds; the evolution of the contour according to parameters predicted by neural networks; and the connection of individual results using a tree, refined according to some predefined criteria. The literature review is extensive and clearly identifies the main problems associated to vessel tracing. The main steps of the method are described in detail, and it is compared to other state-of-the-art methods for vessel tracing using datasets from different imaging modalities, reaching promising results. Finally, an ablation study is also included, to evaluate the contributions of each individual component of the proposed method.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>One suggestion for improvement would be to discuss some of the limitations of the proposed method. For example, how much data is required to train the neural networks it requires and how easy is it to obtain that data. 
It would also be great if the authors could explain how they estimated the loss threshold of 0.05 and minimum distance of 10mm used to remove edges in the vascular tree, which are mentioned on the last paragraph of page 5.</p>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Very Good</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>The method is described in detail in the paper, even when no code is provided.  The formulas used for the loss functions and evolution of the active contour are provided together with the formulas of the metrics used to evaluate the method.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>Comments were already provided on section 4.</p>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>strong accept (9)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>The paper is well organized and the method is clearly described. The contributions are novel and the method was evaluated in detail with comparison to other state-of-the-art methods and an ablation study.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>3</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-2">Review #2</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>This paper describes a method to extract vessels from 3D medical images, while taking topological and geometric properties of the vessel trees into account.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>This method guarantees the topological properties of the vessel trees, i.e. vessels are continuous lines without gaps, and the vessel trees do not contain loops. Also, a geometric property of vessels (smoothness of the vessels) is taken into account.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>Description of parameter sensitivity: How are the parameters alpha and beta for the open snake selected? Are they fixed for all images in the experiment, or do they need to be adjusted depending on the image?</p>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Very Good</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>Datasets are clearly described. One important step is not described in necessary detail.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <ul>
        <li>
          <p>In Sec. 2.3: The stretching directions are determined using a deep neural work. But how is this network trained? How does the training data look like, i.e. were manually annotated D+1-dimensional (D=500) vectors used? This is a very significant step, but not mentioned in either “Methods” nor “Experimental settings and results”.</p>
        </li>
        <li>
          <p>In Sec. 2.3: The curves are stretched in a (D+1)-dimensional space, with spatial dimension D=500, and an additional dimension for radius. Is there any intuition about the 500 dimensions of the spatial stretching?</p>
        </li>
        <li>
          <p>In Table 1: The method “OCS” achieves the best values for three metrics, while the proposed method achieves the best values only for two metrics. What is then the advantage of the proposed method compared to “OCS”?</p>
        </li>
        <li>
          <p>In Table 2: Why does the results for OV and AI decrease after adding the global tree constraint? Examples should be provided to show this.</p>
        </li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>accept (8)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>The main steps are illustrated well. Results are convincing (except the comparison with OCS). Ablation study clearly shows the effects of each components of the method.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>2</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Very confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-3">Review #3</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The authors propose a method to segment vasculature in 3D images and to obtain the complete topology of the centerline vasculature tree. The first step is a regular encoder-decoder network to segment the vasculature followed by thresholding and skeletonization in order to obtain initial curves. The second step is the innovative part where the curve is fit and stretch using the deep open snake tracing (DOST: stretching direction is trained by a neural network). Then the final step links all the curves using minimum spanning tree. The methods is evaluated against state-ot-the-art methods on the MRA BRAVE dataset.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ul>
        <li>The main strength is to propose a pipeline combining robustness of nnet segmentation and smoothness/continuity of snake curve.</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <ul>
        <li>The method is not fully clear especially the deep learning part during the snake tracking (what is exactly trained there (direction, stretching magnitude) and how the ground truth is computed). This is the innovative part so it should be more detailed. Also, I don’t fully understand the training masked by the non-zero regions with the segmentation network (see detail in constructive comments).</li>
        <li>Same for the new evaluation metrics, more details should be brought (figure, more rigorous formulation) because now it is difficult to understand exactly what is computed (see detail in constructive comments).</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Satisfactory</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <ul>
        <li>Source code is made available and dataset can be asked on reasonable request</li>
        <li>For the experiments reproducibility is hampered by missing parameters and optimizers used (by reading only the paper): What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)?</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>Page 1
	Abstract</p>
      <ul>
        <li>“TOF MRA intracranial artery”	-&gt; please explain the acronym</li>
      </ul>

      <p>Page 3</p>
      <ul>
        <li>Figure 2: I don’t understand the example with artificial vessels. Why after the Deep snake tracing, there is so long green parts, as it is outside the vasculature part (blue)?</li>
        <li>Figure 2: On the TOF MRA image, after minimum spanning tree, there are less snake curve than after Deep snake tracing. Why it is the case? Is there a mechanism to remove some curve too far from the ‘main’ graph?</li>
      </ul>

      <p>Page 4</p>
      <ul>
        <li>“2 blocks in encoder/decoder, each with 2 3D convolutional layers+RELU followed by 3D max pooling/up sampling layers” -&gt; I find it too vague. Why do you mean by 2 blocks? 2 downsampling/upsampling layers? Is there any sigmoid at the end? The output is the distance transform map, right?</li>
        <li>“The L2 loss for training the segmentation network is masked by the non-zero regions” -&gt; So all the regions where there is no vasculature, do not influence the training? How is it possible that during inference, the network manages to put zero everywhere in those regions if no loss function trained it to do so? Is this because you use pre-trained network? If it is the case, it could be nice to mention it to clarify.</li>
        <li>Equation 4: Do you want to minimize this function?</li>
        <li>Equation 6: I is only the image intensity? of the raw image? or the distance transform map? So you want here to maximize bright intensity? Does it work as well for CT scan?</li>
        <li>“E_{str} is the energy for stretching directions at both ends of the snake” -&gt; Why do you need stretching after the vasculature segmentation+skeletonization? To fill potential gap (false negative segmentation) between curves?</li>
      </ul>

      <p>Page 5</p>
      <ul>
        <li>“6 blocks followed by a convolution layer with D + 1 dimensions (D = 500)” -&gt; Do you mean “fully connected layer” instead of “convolution layer”?</li>
        <li>“for prediction of the 1-dimensional radius r(P(c(s)))” -&gt; So the radius is computed only at the end of the snake? How do you compute the remaining radius along the curve?</li>
        <li>“and D-dimensional stretching direction” -&gt; How the direction are encoded in the network? Why 500? How is made the stretching magnitudes ground truth for the training?</li>
        <li>“Background intensities for the snake pair were sampled from points at twice the radius” -&gt; Why twice the radius? why not one or closer like 1.1?</li>
      </ul>

      <p>Page 6</p>
      <ul>
        <li>Datasets: Training between each dataset are independent? Also, snake energy E_{DOST} ( in particular I(x(s),y(s),z(s)) ) is unchanged between MR and CT dataset? (as the vessel intensity is different bright vs black)</li>
        <li>Equation 10, 11, 12: It could be nice to have a figure to explain the metrics as it is difficult to grasp the idea. What do you mean by {t_j}, should it be T? the set of all snake curve? But after the minimum spanning tree, the snake curve does not mean anything anymore? I don’t understand what count and match ( min_ij( pt norm &lt; r^ij) ?) mean w.r.t to curves.</li>
        <li>Evaluation on BRAVE: What are the parameters/optimizers used for the DOST minimization? What are the parameters/optimizers used for the two neural networks: image segmentation and stretching magnitude computation. How the latter neural network is trained (data selection, ground truth)?</li>
        <li>“For segmentation-based approaches, Frangi vesselness filter, U-Net and Deep Distance Transform (DDT) were selected” -&gt; How was done the skeletonization and the creation of the tree topology after the segmentation?</li>
      </ul>

      <p>Page 7</p>
      <ul>
        <li>“DOST showed higher performance than most methods.” -&gt; When I look at Table 1, it is not clear what DOST brings compare to OCS.</li>
        <li>Figure 3: DOST snake curve are based on a segmentation method similar to U-net. So, why there is no noisy outliers as well on DOST? Do you filter the snake curve at some point in your method?</li>
      </ul>

      <p>Page 8</p>
      <ul>
        <li>“Tracing results are shown in Fig. 4” -&gt; Is there any manual part here to select the right artery? Same question for figure 5.</li>
        <li>“In addition, DOST, as an adaptive hybrid (segmentation and tracking-based) tracing method, is able to identify complete vascular trees from multiple vascular beds and modalities.” -&gt; Would it work as well with the other methods?</li>
        <li>“DOST is not purely post processing/smoothing on CNN based tracking results. The snake constraint was applied during the trace stretching and the tracing was initiated from segmentation-based curve proposal instead of seed points.” -&gt; This paragraph is not really clear to me. What do you want to discuss/emphasize here?</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>borderline reject (5)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <ul>
        <li>The method is not clear/detailed enough</li>
        <li>The implementation of the experiments are not detailed enough (see reproducibility)</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="metareview-id">Meta-Review(s)</h1>

<h2 id="primary-meta-review">Primary Meta-Review</h2>
<ul>
  <li><strong>Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal.</strong>
    <blockquote>
      <p>This paper presents a new method for vessel tracking in 3D image volumes. The method uses deep learning to initialize the active contour model and predict the vessel radii. R1 comments that it is an innovative solution to vessel tracing and suggests mentioning the method’s weaknesses. R2 finds that the results are convincing and has some questions regarding parameter sensitivity and network training. R3 has some concerns about the paper’s clarity on the method and its implementation. After reading the comments raised by the reviewers, my recommendation is given in Q3.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>2</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="authorFeedback-id">Author Feedback</h1>
<blockquote>
  <p>R1.1limitations</p>

  <ul>
    <li>
      <p>The requirement for labeled traces is a limitation. We used 117 training cases from BRAVE. However, we have also shown DOST works with 5/6 cases in CAT08/Harborview data.
R1.2parameter for tree constraint</p>
    </li>
    <li>
      <p>0.05 for loss threshold and 10mm for minimum distance were empirically chosen. Lower threshold and higher distance cause more false/noise connections, while the opposite leads to broken connections/miss tracings on real arteries. 
R2.1alpha beta</p>
    </li>
    <li>
      <p>The alpha, beta control the membrane and thin-plate terms in snake. Larger beta/alpha makes snake more stiff and harder to adjust to sharp direction changes. They are fixed. 
R2.2How the stretching network trained? R3.1 deep learning during the tracking is unclear.</p>
    </li>
    <li>
      <p>We followed the training in CNN tracker/ref13 for a fair comparison. The network takes a 3D patch and predicts 1 of the 500 directions (one-hot) for stretching and 1 magnitude for radius. Semi-automated traces (ref23) were used to identify the most matching direction for each patch. 500 was validated and chosen in ref13. Same training set as the segmentation. 
R2.3/R3.17OCS has better results?</p>
    </li>
    <li>
      <p>As it was stated following table1, ground truth was generated by manually correcting traces from OCS, which inevitably causes smaller mean distance (AI) to OCS. OCS also has the problem of missing many real arteries although arteries are usually consistent (lower ID switch). 
R2.4OV/AI decrease after tree constraint.</p>
    </li>
    <li>
      <p>After tree constraint, some broken gaps were connected. Some connected arteries might not be traced by the ground truth or they are noise branches, decreasing the overlap OV. 
R3.2mask in the segmentation?</p>
    </li>
    <li>
      <p>There are two outputs for the segmentation network: distance map (continuous variable) and probability map (artery voxels are 1). The loss was the L2 loss calculated only in the predicted mask region. 
R3.3More details for evaluation metrics</p>
    </li>
    <li>
      <p>Due to the many contents and page limit, we cannot describe them in more figures or formulas. However, more intuitive descriptions were added. 
T, same as {t_i}, meaning the set of all snakes. Even after minimum spanning tree, the data structure remains T (only difference: snakes are stretched further). Points (as the unit) on each snake were matched/compared with points on the ground truth for evaluation. 
R3.4experiments parameter</p>
    </li>
    <li>
      <p>Both networks used Adam optimizer with learning rate of 0.001.
R3.5Fig2</p>
    </li>
    <li>
      <p>We did not draw weak artery signals in green parts. Updated. 
R3.6mechanism to remove traces? Why no noisy outliers?
There is a mechanism to remove outlier traces from graph by  〖Loss〗_con and distance.<br />
R3.7segmentation structure</p>
    </li>
    <li>
      <p>2 down/upsampling layers in each block. Output: distance and probability map trained together. No pretrain. 
R3.8snake loss function</p>
    </li>
    <li>
      <p>to minimize this function 
R3.9image intensity in snake energy</p>
    </li>
    <li>
      <p>”I” is the distance map. No matter which modality, “I” is always bright for arteries.
R3.10 Why stretching needed?</p>
    </li>
    <li>
      <p>Segmentation+skeletonization is not robust. Curve proposals are partial broken, which are fixed in the deep snake framework. 
R3.11”fully connected layer” instead of “convolution layer”?</p>
    </li>
    <li>
      <p>This is a fully convolutional network so that it can be used for images with arbitrary size. 
R3.12Radius 
Radius was estimated iteratively at each stretching points.
R3.13Background signal</p>
    </li>
    <li>
      <p>Signal was extracted at twice (not 1.1) the radius to avoid the transition region from foreground.
R3.14skeletonization</p>
    </li>
    <li>
      <p>All methods used the same skeletonization Ref19. 
R3.15any manual part in fig4/5 to select the right artery?</p>
    </li>
    <li>
      <p>Yes, we followed the same selection criteria in the challenge from the given landmarks. Arteries were manually selected in fig5 so that they can be evaluated. For intracranial artery, selection was automated with largest connected components in the graph. 
R3.16confusion in discussion</p>
    </li>
    <li>
      <p>to emphasize the difference of DOST with tracking based methods after smoothing.</p>
    </li>
  </ul>

</blockquote>

<p><br /><br />
<a href=""><span style="color:#ff9900"><b>back to top</b></span></a></p>

<hr />


  </div>

  <div class="post-info">
    <!--
    <div class="post-date">
      Poster presentation date:  
      0655-12-31
      -->
      <!--
      
        ,
        updated at 
        0656-01-01
      
      .
      
    </div>
    -->
    <!--
    
    <div class="post-author">
      Author: Kitty K. Wong
    </div>
    
    -->
    <div class="post-categories">
      <span><b>Topic(s): </b></span>
      
      <a 
        href="kittywong/categories#Clinical applications - Vascular"
        class="post-category">
        Clinical applications - Vascular
      </a> |
      
      <a 
        href="kittywong/categories#Computational Anatomy and Physiology"
        class="post-category">
        Computational Anatomy and Physiology
      </a> |
      
      <a 
        href="kittywong/categories#Image Segmentation"
        class="post-category">
        Image Segmentation
      </a> |
      
      <a 
        href="kittywong/categories#Modalities - CT"
        class="post-category">
        Modalities - CT
      </a> |
      
      <a 
        href="kittywong/categories#Modalities - MRI"
        class="post-category">
        Modalities - MRI
      </a> |
      
    </div>
    <div class="post-tags">
      <!--<span>Author List</span>-->
      <span><b> Author(s): </b></span>
      
      <a href="kittywong/tags#Chen, Li"
        class="post-category">
        Chen, Li
      </a> |  
      
      <a href="kittywong/tags#Liu, Wenjin"
        class="post-category">
        Liu, Wenjin
      </a> |  
      
      <a href="kittywong/tags#Balu, Niranjan"
        class="post-category">
        Balu, Niranjan
      </a> |  
      
      <a href="kittywong/tags#Mossa-Basha, Mahmud"
        class="post-category">
        Mossa-Basha, Mahmud
      </a> |  
      
      <a href="kittywong/tags#Hatsukami, Thomas S."
        class="post-category">
        Hatsukami, Thomas S.
      </a> |  
      
      <a href="kittywong/tags#Hwang, Jenq-Neng"
        class="post-category">
        Hwang, Jenq-Neng
      </a> |  
      
      <a href="kittywong/tags#Yuan, Chun"
        class="post-category">
        Yuan, Chun
      </a> |  
      
    </div>
    <div class="post-other">
      
      <div>
        <span><b>
          Next paper: 
        </b>
        </span>
        <a href="/0656/12/31/Paper1048">
          MASC-Units: Training Oriented Filters for Segmenting Curvilinear Structures
        </a>
      </div>
      
      
      <div>
        <span><b>
          Previous paper: 
        </b>
        </span>
        <a href="/0654/12/31/Paper2411">
          TVnet: Automated Time-Resolved Tracking of the Tricuspid Valve Plane in MRI Long-Axis Cine Images with a Dual-Stage Deep Learning Pipeline
        </a>
      </div>
      
    </div>
    
  </div>
</article>

      </main>
      <footer class="container-footer">
        <div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. Kitty K. Wong, The MICCAI Society
  </span>
</div>
<!--
<div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. example.com.
  </span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>, themed by <a href="https://github.com/ghosind/Jekyll-Paper-Github">Jekyll-Paper-Github</a>.
  </span>
</div>
-->

      </footer>
    </div>
  </body>
</html>
