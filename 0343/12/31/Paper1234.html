<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Fighting Class Imbalance with Contrastive Learning | MICCAI 2021 - Accepted Papers and Reviews</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Fighting Class Imbalance with Contrastive Learning" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Yassine Marrakchi, Osama Makansi, Thomas Brox Abstract Medical image datasets are hard to collect, expensive to label, and often highly imbalanced. The last issue is underestimated, as typical average metrics hardly reveal that the often very important minority classes have a very low accuracy. In this paper, we address this problem by a feature embedding that balances the classes using contrastive learning as an alternative to the common cross-entropy loss. The approach is largely orthogonal to existing sampling methods and can be easily combined with those. We show on the challenging ISIC2018 and APTOS2019 datasets that the approach improves especially the accuracy of minority classes without negatively affecting the majority ones. Link to paper https://doi.org/10.1007/978-3-030-87199-4_44 Link to the code repository https://github.com/YMarrakchi/CICL Link to the dataset(s) https://www.kaggle.com/c/aptos2019-blindness-detection/data https://isic-challenge-data.s3.amazonaws.com/2018/ISIC2018_Task3_Training_Input.zip Reviews Review #1 Please describe the contribution of the paper The authors address the problem of imbalanced distribution of classes in medical datasets. They propose a framework based on contrastive learning to better arrange the feature space for minority and majority classes. The feature space is explicitly separated into different clusters by minimizing the distance between samples from the same class and maximizing the distance between samples from different classes. The proposed method was evaluated on the ISIC2018 lesion diagnosis dataset which contains 7 predefined categories and on the APTOS2019 diabetic retinopathy dataset which contains 5 classes. A comparison with different model-based approaches used for addressing the imbalanced classes was also performed. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The paper is well written and well organized. The implementation details are well described. The validation protocol is appropriate and a quantitative evaluation was performed on two different datasets for different applications; skin lesion classification and diabetic retinopathy grading. The results were well discussed. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Relevant details are missing in the description of the methodology. How the positive samples and the negative ones are generated in each batch? For the oversampling strategy, how the original dataset is extended from minority classes to get an artificially balanced dataset? Diabetic Retinopathy has been widely researched and there are many more DR-related dataset (FGADR,Messidor, EyePacs…) that could have been used to evaluate the ability of the proposed architecture to generalize on other datasets. The improvement of the F-score evaluation on the minority classes of diabetic retinopathy is missing. Overall, the improvement of the accuracy with respect to the baseline and the previous methods is not significant. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The implementation details are included in the paper. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html The comparison with the baseline should include a quantitative evaluation of the accuracy on the minority classes in the two datasets. The authors should justify why the resampling harms the performance as shown in table 2. The authors claim that the performance of the proposed method is much better than the cross-entropy baseline across all classes but it is not clear from Figure 3. Please state your overall opinion of the paper borderline accept (6) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The contribution is not original and the results are not convincing. What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Very confident Review #2 Please describe the contribution of the paper Address the imbalanced datasets by using novel contrastive learning framework to better arrange feature space while accounting for majority/minority classes. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Excellent introduction clearly setting up problem, need, and solution Great overview of previous work to provide context. Intuitive approach, well-explained difference between contrastive and cross-entropy loss training Reasonable experimental design with different permutations and comparative strategies Results show clear advantages conferred via CL training in different settings and different classes Intuitive results from ablation study Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Fig 2 could be a little more intuitive in illustrating the flow No statistical testing reported Improvements over comparative strategies appear minor Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Data and code will be made available. Detailed design and settings No statistical analysis Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Are there significant differences in performance in Table 2 and 3? Please fix Table 2 to be consistent with decimals/scientific notation Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Well written, comprehensive experiments to validate approach. While resulting improvements are marginal, core idea is of interest and addressing a key problem. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 4 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper studies the problem of image classification under class imbalances, in particular in the setting of dermatology, and proposes a method based on a representation learning with contrastive learning followed by a standard classifier. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The problem addressed in this manuscript is timely and important The presented solution is intuitive, building on extensions of other literature Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The paper strongly argues that learning under class imbalances has not been greatly studied. While I agree that more work is needed (and this manuscript contributes to that), there’s extensive work that the authors would like to refer to. Besides the works the authors mention, there exist a another approach to learning in these settings, basically by minimizing a loss that is not sensitive to the class imbalance (such as the AUC). See e.g. Zhao, Peilin, et al. “Online AUC maximization.” (2011): 233., and Wang, Guanjin, Kok Wai Wong, and Jie Lu. “AUC-based extreme learning machines for supervised and semi-supervised imbalanced classification.” IEEE Transactions on Systems, Man, and Cybernetics: Systems (2020). Parts of the manuscript are unclear. For example, the text around Eq. (1) that explains their approach is confusing. E.g. “z_i is the normalized feature vector of an image x_i, c_i is the positive set for sample i and corresponds to all samples in the batch with the same class label as i’. I’m confused as to the meaning of “sample i”: is it the image x_i? is it a batch of examples? The numerical results are somewhat unclear: While the proposed method seems to provide benefits in one of the studied datasets, in the other their method does not improve on methods which do not explicitly try to compensate for class imbalance. More importantly, the authors argue that their method provides greater advantage for the minority class, in Figure 3. However, this does not appear to be the case: the largest improvements are obtained for some of the majority classes; and in fact for the most extreme minority case, the method deteriorates w.r.t. to the baseline which does not compensate for class imbalance, which is very strange. Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Based on my comments regarding the lack of clarity on the presentation of their method, I believe that the potential for reproducibility is only mild, so implementation details (in terms of hyperparameters and training details) are provided. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html I think the work in [21, in authors’ references] is the conceptually the closest to this work. Is there a reason the authors chose not to compare with them? The difference in general trends among the two datasets is somewhat surprising. Can the authors provide more details about the level of imbalance in one and other case? The authors comment that “Besides the common average accuracy metric which is not sensitive to data imbalance…”. This comment is probably inaccurate, as accuracy is precisely very sensitive to class imbalance (consider e.g. the case where a minority, negative, class is simply 1% of the sample, and a constant classifier that predicts always the majority, positive, class). The authors talk about “disentanglement” in the learned representations. The authors might want to rephrase this, as disentanglement is typically used to refer to representations where input features are coded by almost independent components in feature space, and not just a class separation. See e.g. Tran, Luan, Xi Yin, and Xiaoming Liu. “Disentangled representation learning gan for pose-invariant face recognition.” Proceedings of the IEEE conference on computer vision and pattern recognition. 2017. Please state your overall opinion of the paper probably reject (4) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The novelty of the approach is somewhat limited, and the experimental comparison is unclear, as are some parts of the methodology. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 4 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. This paper tackles the issue of class imbalance for medical image classificaiton using contrastive learning. The paper seems well written for the most part. However, there are a few clarifications that need to addressed in the final manuscript regarding: including relevant references as suggested by the reviewers discussion on trends observed in results clarification about figures requested by reviewers other writing clarifications requested by reviewers What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback We will revise the text to avoid the sources of confusion spotted by some reviewers, extend the related work section to refer to previous works mentioned by reviewer 3, and will discuss the points that were highlighted by the reviewers and that we addressed in the detailed response below. We must see how we balance these extensions with the other content because of the rather tight page limit. The method is not new: The supervised contrastive loss itself is not new, but its value for classification under data imbalance has not been studied before and our paper focuses specifically on this aspect. Moreover, data imbalance is often ignored in medical imaging, and we highlight its relevance and strategies to fight it. The reviewer is right in the sense that we do not present a new fundamental method, but the paper contributes scientific insights on class imbalance and how to best work with it. We will include the relevant references suggested by reviewer 3. Methodology: How are positives and negatives defined? How does oversampling work? Both questions are addressed in Section 3. We will reformulate the definition of positives and negatives and will fix the typo mentioned by reviewer 3. Given a sample image, all other images of the same class in the same batch build the set of positives while all images in the batch that belong to a different class form the set of negatives. Oversampling creates copies from samples of the underrepresented classes, so that the classes are balanced. Why do we not consider another diabetic retinopathy related dataset? Since we are mainly interested in validating the concept, we chose to evaluate on two datasets belonging to different domains. In this way, we guarantee that the reported benefit is due to the method and not to a domain-specific cue. Studying the generalization across datasets from the same domain remains an interesting aspect for further investigation. Since we will provide the code, the approach can be run on other datasets, also non-public ones. Sensitivity of accuracy metric to class imbalance We agree that the formulation of the statement can be confusing and will reformulate it. We meant exactly the same as the reviewer gives as example. There are different improvements on the two datasets in comparison with DANIL, OHEM, MTL and CANet. We point out that all those methods start from a backbone pretrained on ImageNet. Therefore, their performance depends on how well ImageNet fits to the target domain. All those methods fail to even outperform the baseline on ISIC18, while they give a significant improvement on APTOS19. Our method does not have this dependency on a matching pretraining dataset. It rather learns domain specific features from scratch and performs on par or better than those methods. Why does resampling harm the performance in Table 2? We think the drop in performance on APTOS19 is mainly due to the small size of the dataset. Thus, making copies from the very few samples results in overfitting to those. Why is there a decrease in performance for the class of lowest frequency? Our method does not give any guarantee of improvement for all the classes. Given that the 4 least frequent classes have roughly the same number of samples, we get the expected behavior for 3 of them. For all 5 non-major classes that get improved, the improvement is higher than for the majority class. Missing classwise performance on APTOS19: Due to limited space, we present the classwise performance for ISIC18 only. It is more relevant since it is larger, has more classes and has stronger data imbalance. Moreover, we get the same behavior for both datasets. Why is there no comparison to [21]? Since the idea of Huang et al. [21] is an extension of the triplet loss, which has been clearly outperformed by many recent methods, we restricted the comparison to LDAM, one of the most powerful recent methods that relies on a similar concept. back to top" />
<meta property="og:description" content="Paper Info Reviews Meta-review(s) Author Feedback Authors Yassine Marrakchi, Osama Makansi, Thomas Brox Abstract Medical image datasets are hard to collect, expensive to label, and often highly imbalanced. The last issue is underestimated, as typical average metrics hardly reveal that the often very important minority classes have a very low accuracy. In this paper, we address this problem by a feature embedding that balances the classes using contrastive learning as an alternative to the common cross-entropy loss. The approach is largely orthogonal to existing sampling methods and can be easily combined with those. We show on the challenging ISIC2018 and APTOS2019 datasets that the approach improves especially the accuracy of minority classes without negatively affecting the majority ones. Link to paper https://doi.org/10.1007/978-3-030-87199-4_44 Link to the code repository https://github.com/YMarrakchi/CICL Link to the dataset(s) https://www.kaggle.com/c/aptos2019-blindness-detection/data https://isic-challenge-data.s3.amazonaws.com/2018/ISIC2018_Task3_Training_Input.zip Reviews Review #1 Please describe the contribution of the paper The authors address the problem of imbalanced distribution of classes in medical datasets. They propose a framework based on contrastive learning to better arrange the feature space for minority and majority classes. The feature space is explicitly separated into different clusters by minimizing the distance between samples from the same class and maximizing the distance between samples from different classes. The proposed method was evaluated on the ISIC2018 lesion diagnosis dataset which contains 7 predefined categories and on the APTOS2019 diabetic retinopathy dataset which contains 5 classes. A comparison with different model-based approaches used for addressing the imbalanced classes was also performed. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The paper is well written and well organized. The implementation details are well described. The validation protocol is appropriate and a quantitative evaluation was performed on two different datasets for different applications; skin lesion classification and diabetic retinopathy grading. The results were well discussed. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Relevant details are missing in the description of the methodology. How the positive samples and the negative ones are generated in each batch? For the oversampling strategy, how the original dataset is extended from minority classes to get an artificially balanced dataset? Diabetic Retinopathy has been widely researched and there are many more DR-related dataset (FGADR,Messidor, EyePacs…) that could have been used to evaluate the ability of the proposed architecture to generalize on other datasets. The improvement of the F-score evaluation on the minority classes of diabetic retinopathy is missing. Overall, the improvement of the accuracy with respect to the baseline and the previous methods is not significant. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The implementation details are included in the paper. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html The comparison with the baseline should include a quantitative evaluation of the accuracy on the minority classes in the two datasets. The authors should justify why the resampling harms the performance as shown in table 2. The authors claim that the performance of the proposed method is much better than the cross-entropy baseline across all classes but it is not clear from Figure 3. Please state your overall opinion of the paper borderline accept (6) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The contribution is not original and the results are not convincing. What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Very confident Review #2 Please describe the contribution of the paper Address the imbalanced datasets by using novel contrastive learning framework to better arrange feature space while accounting for majority/minority classes. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Excellent introduction clearly setting up problem, need, and solution Great overview of previous work to provide context. Intuitive approach, well-explained difference between contrastive and cross-entropy loss training Reasonable experimental design with different permutations and comparative strategies Results show clear advantages conferred via CL training in different settings and different classes Intuitive results from ablation study Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Fig 2 could be a little more intuitive in illustrating the flow No statistical testing reported Improvements over comparative strategies appear minor Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Data and code will be made available. Detailed design and settings No statistical analysis Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Are there significant differences in performance in Table 2 and 3? Please fix Table 2 to be consistent with decimals/scientific notation Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Well written, comprehensive experiments to validate approach. While resulting improvements are marginal, core idea is of interest and addressing a key problem. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 4 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper studies the problem of image classification under class imbalances, in particular in the setting of dermatology, and proposes a method based on a representation learning with contrastive learning followed by a standard classifier. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The problem addressed in this manuscript is timely and important The presented solution is intuitive, building on extensions of other literature Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The paper strongly argues that learning under class imbalances has not been greatly studied. While I agree that more work is needed (and this manuscript contributes to that), there’s extensive work that the authors would like to refer to. Besides the works the authors mention, there exist a another approach to learning in these settings, basically by minimizing a loss that is not sensitive to the class imbalance (such as the AUC). See e.g. Zhao, Peilin, et al. “Online AUC maximization.” (2011): 233., and Wang, Guanjin, Kok Wai Wong, and Jie Lu. “AUC-based extreme learning machines for supervised and semi-supervised imbalanced classification.” IEEE Transactions on Systems, Man, and Cybernetics: Systems (2020). Parts of the manuscript are unclear. For example, the text around Eq. (1) that explains their approach is confusing. E.g. “z_i is the normalized feature vector of an image x_i, c_i is the positive set for sample i and corresponds to all samples in the batch with the same class label as i’. I’m confused as to the meaning of “sample i”: is it the image x_i? is it a batch of examples? The numerical results are somewhat unclear: While the proposed method seems to provide benefits in one of the studied datasets, in the other their method does not improve on methods which do not explicitly try to compensate for class imbalance. More importantly, the authors argue that their method provides greater advantage for the minority class, in Figure 3. However, this does not appear to be the case: the largest improvements are obtained for some of the majority classes; and in fact for the most extreme minority case, the method deteriorates w.r.t. to the baseline which does not compensate for class imbalance, which is very strange. Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Based on my comments regarding the lack of clarity on the presentation of their method, I believe that the potential for reproducibility is only mild, so implementation details (in terms of hyperparameters and training details) are provided. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html I think the work in [21, in authors’ references] is the conceptually the closest to this work. Is there a reason the authors chose not to compare with them? The difference in general trends among the two datasets is somewhat surprising. Can the authors provide more details about the level of imbalance in one and other case? The authors comment that “Besides the common average accuracy metric which is not sensitive to data imbalance…”. This comment is probably inaccurate, as accuracy is precisely very sensitive to class imbalance (consider e.g. the case where a minority, negative, class is simply 1% of the sample, and a constant classifier that predicts always the majority, positive, class). The authors talk about “disentanglement” in the learned representations. The authors might want to rephrase this, as disentanglement is typically used to refer to representations where input features are coded by almost independent components in feature space, and not just a class separation. See e.g. Tran, Luan, Xi Yin, and Xiaoming Liu. “Disentangled representation learning gan for pose-invariant face recognition.” Proceedings of the IEEE conference on computer vision and pattern recognition. 2017. Please state your overall opinion of the paper probably reject (4) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The novelty of the approach is somewhat limited, and the experimental comparison is unclear, as are some parts of the methodology. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 4 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. This paper tackles the issue of class imbalance for medical image classificaiton using contrastive learning. The paper seems well written for the most part. However, there are a few clarifications that need to addressed in the final manuscript regarding: including relevant references as suggested by the reviewers discussion on trends observed in results clarification about figures requested by reviewers other writing clarifications requested by reviewers What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback We will revise the text to avoid the sources of confusion spotted by some reviewers, extend the related work section to refer to previous works mentioned by reviewer 3, and will discuss the points that were highlighted by the reviewers and that we addressed in the detailed response below. We must see how we balance these extensions with the other content because of the rather tight page limit. The method is not new: The supervised contrastive loss itself is not new, but its value for classification under data imbalance has not been studied before and our paper focuses specifically on this aspect. Moreover, data imbalance is often ignored in medical imaging, and we highlight its relevance and strategies to fight it. The reviewer is right in the sense that we do not present a new fundamental method, but the paper contributes scientific insights on class imbalance and how to best work with it. We will include the relevant references suggested by reviewer 3. Methodology: How are positives and negatives defined? How does oversampling work? Both questions are addressed in Section 3. We will reformulate the definition of positives and negatives and will fix the typo mentioned by reviewer 3. Given a sample image, all other images of the same class in the same batch build the set of positives while all images in the batch that belong to a different class form the set of negatives. Oversampling creates copies from samples of the underrepresented classes, so that the classes are balanced. Why do we not consider another diabetic retinopathy related dataset? Since we are mainly interested in validating the concept, we chose to evaluate on two datasets belonging to different domains. In this way, we guarantee that the reported benefit is due to the method and not to a domain-specific cue. Studying the generalization across datasets from the same domain remains an interesting aspect for further investigation. Since we will provide the code, the approach can be run on other datasets, also non-public ones. Sensitivity of accuracy metric to class imbalance We agree that the formulation of the statement can be confusing and will reformulate it. We meant exactly the same as the reviewer gives as example. There are different improvements on the two datasets in comparison with DANIL, OHEM, MTL and CANet. We point out that all those methods start from a backbone pretrained on ImageNet. Therefore, their performance depends on how well ImageNet fits to the target domain. All those methods fail to even outperform the baseline on ISIC18, while they give a significant improvement on APTOS19. Our method does not have this dependency on a matching pretraining dataset. It rather learns domain specific features from scratch and performs on par or better than those methods. Why does resampling harm the performance in Table 2? We think the drop in performance on APTOS19 is mainly due to the small size of the dataset. Thus, making copies from the very few samples results in overfitting to those. Why is there a decrease in performance for the class of lowest frequency? Our method does not give any guarantee of improvement for all the classes. Given that the 4 least frequent classes have roughly the same number of samples, we get the expected behavior for 3 of them. For all 5 non-major classes that get improved, the improvement is higher than for the majority class. Missing classwise performance on APTOS19: Due to limited space, we present the classwise performance for ISIC18 only. It is more relevant since it is larger, has more classes and has stronger data imbalance. Moreover, we get the same behavior for both datasets. Why is there no comparison to [21]? Since the idea of Huang et al. [21] is an extension of the triplet loss, which has been clearly outperformed by many recent methods, we restricted the comparison to LDAM, one of the most powerful recent methods that relies on a similar concept. back to top" />
<link rel="canonical" href="https://kittywong.github.io/kittywong/0343/12/31/Paper1234" />
<meta property="og:url" content="https://kittywong.github.io/kittywong/0343/12/31/Paper1234" />
<meta property="og:site_name" content="MICCAI 2021 - Accepted Papers and Reviews" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0343-12-31T23:58:56-05:17" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fighting Class Imbalance with Contrastive Learning" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://kittywong.github.io/kittywong/0343/12/31/Paper1234"},"@type":"BlogPosting","url":"https://kittywong.github.io/kittywong/0343/12/31/Paper1234","headline":"Fighting Class Imbalance with Contrastive Learning","dateModified":"0344-01-02T00:00:00-05:17","datePublished":"0343-12-31T23:58:56-05:17","description":"Paper Info Reviews Meta-review(s) Author Feedback Authors Yassine Marrakchi, Osama Makansi, Thomas Brox Abstract Medical image datasets are hard to collect, expensive to label, and often highly imbalanced. The last issue is underestimated, as typical average metrics hardly reveal that the often very important minority classes have a very low accuracy. In this paper, we address this problem by a feature embedding that balances the classes using contrastive learning as an alternative to the common cross-entropy loss. The approach is largely orthogonal to existing sampling methods and can be easily combined with those. We show on the challenging ISIC2018 and APTOS2019 datasets that the approach improves especially the accuracy of minority classes without negatively affecting the majority ones. Link to paper https://doi.org/10.1007/978-3-030-87199-4_44 Link to the code repository https://github.com/YMarrakchi/CICL Link to the dataset(s) https://www.kaggle.com/c/aptos2019-blindness-detection/data https://isic-challenge-data.s3.amazonaws.com/2018/ISIC2018_Task3_Training_Input.zip Reviews Review #1 Please describe the contribution of the paper The authors address the problem of imbalanced distribution of classes in medical datasets. They propose a framework based on contrastive learning to better arrange the feature space for minority and majority classes. The feature space is explicitly separated into different clusters by minimizing the distance between samples from the same class and maximizing the distance between samples from different classes. The proposed method was evaluated on the ISIC2018 lesion diagnosis dataset which contains 7 predefined categories and on the APTOS2019 diabetic retinopathy dataset which contains 5 classes. A comparison with different model-based approaches used for addressing the imbalanced classes was also performed. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The paper is well written and well organized. The implementation details are well described. The validation protocol is appropriate and a quantitative evaluation was performed on two different datasets for different applications; skin lesion classification and diabetic retinopathy grading. The results were well discussed. Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Relevant details are missing in the description of the methodology. How the positive samples and the negative ones are generated in each batch? For the oversampling strategy, how the original dataset is extended from minority classes to get an artificially balanced dataset? Diabetic Retinopathy has been widely researched and there are many more DR-related dataset (FGADR,Messidor, EyePacs…) that could have been used to evaluate the ability of the proposed architecture to generalize on other datasets. The improvement of the F-score evaluation on the minority classes of diabetic retinopathy is missing. Overall, the improvement of the accuracy with respect to the baseline and the previous methods is not significant. Please rate the clarity and organization of this paper Very Good Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance The implementation details are included in the paper. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html The comparison with the baseline should include a quantitative evaluation of the accuracy on the minority classes in the two datasets. The authors should justify why the resampling harms the performance as shown in table 2. The authors claim that the performance of the proposed method is much better than the cross-entropy baseline across all classes but it is not clear from Figure 3. Please state your overall opinion of the paper borderline accept (6) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The contribution is not original and the results are not convincing. What is the ranking of this paper in your review stack? 2 Number of papers in your stack 5 Reviewer confidence Very confident Review #2 Please describe the contribution of the paper Address the imbalanced datasets by using novel contrastive learning framework to better arrange feature space while accounting for majority/minority classes. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. Excellent introduction clearly setting up problem, need, and solution Great overview of previous work to provide context. Intuitive approach, well-explained difference between contrastive and cross-entropy loss training Reasonable experimental design with different permutations and comparative strategies Results show clear advantages conferred via CL training in different settings and different classes Intuitive results from ablation study Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. Fig 2 could be a little more intuitive in illustrating the flow No statistical testing reported Improvements over comparative strategies appear minor Please rate the clarity and organization of this paper Excellent Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Data and code will be made available. Detailed design and settings No statistical analysis Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html Are there significant differences in performance in Table 2 and 3? Please fix Table 2 to be consistent with decimals/scientific notation Please state your overall opinion of the paper strong accept (9) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? Well written, comprehensive experiments to validate approach. While resulting improvements are marginal, core idea is of interest and addressing a key problem. What is the ranking of this paper in your review stack? 1 Number of papers in your stack 4 Reviewer confidence Very confident Review #3 Please describe the contribution of the paper This paper studies the problem of image classification under class imbalances, in particular in the setting of dermatology, and proposes a method based on a representation learning with contrastive learning followed by a standard classifier. Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting. The problem addressed in this manuscript is timely and important The presented solution is intuitive, building on extensions of other literature Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work. The paper strongly argues that learning under class imbalances has not been greatly studied. While I agree that more work is needed (and this manuscript contributes to that), there’s extensive work that the authors would like to refer to. Besides the works the authors mention, there exist a another approach to learning in these settings, basically by minimizing a loss that is not sensitive to the class imbalance (such as the AUC). See e.g. Zhao, Peilin, et al. “Online AUC maximization.” (2011): 233., and Wang, Guanjin, Kok Wai Wong, and Jie Lu. “AUC-based extreme learning machines for supervised and semi-supervised imbalanced classification.” IEEE Transactions on Systems, Man, and Cybernetics: Systems (2020). Parts of the manuscript are unclear. For example, the text around Eq. (1) that explains their approach is confusing. E.g. “z_i is the normalized feature vector of an image x_i, c_i is the positive set for sample i and corresponds to all samples in the batch with the same class label as i’. I’m confused as to the meaning of “sample i”: is it the image x_i? is it a batch of examples? The numerical results are somewhat unclear: While the proposed method seems to provide benefits in one of the studied datasets, in the other their method does not improve on methods which do not explicitly try to compensate for class imbalance. More importantly, the authors argue that their method provides greater advantage for the minority class, in Figure 3. However, this does not appear to be the case: the largest improvements are obtained for some of the majority classes; and in fact for the most extreme minority case, the method deteriorates w.r.t. to the baseline which does not compensate for class imbalance, which is very strange. Please rate the clarity and organization of this paper Satisfactory Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance Based on my comments regarding the lack of clarity on the presentation of their method, I believe that the potential for reproducibility is only mild, so implementation details (in terms of hyperparameters and training details) are provided. Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: https://miccai2021.org/en/REVIEWER-GUIDELINES.html I think the work in [21, in authors’ references] is the conceptually the closest to this work. Is there a reason the authors chose not to compare with them? The difference in general trends among the two datasets is somewhat surprising. Can the authors provide more details about the level of imbalance in one and other case? The authors comment that “Besides the common average accuracy metric which is not sensitive to data imbalance…”. This comment is probably inaccurate, as accuracy is precisely very sensitive to class imbalance (consider e.g. the case where a minority, negative, class is simply 1% of the sample, and a constant classifier that predicts always the majority, positive, class). The authors talk about “disentanglement” in the learned representations. The authors might want to rephrase this, as disentanglement is typically used to refer to representations where input features are coded by almost independent components in feature space, and not just a class separation. See e.g. Tran, Luan, Xi Yin, and Xiaoming Liu. “Disentangled representation learning gan for pose-invariant face recognition.” Proceedings of the IEEE conference on computer vision and pattern recognition. 2017. Please state your overall opinion of the paper probably reject (4) Please justify your recommendation. What were the major factors that led you to your overall score for this paper? The novelty of the approach is somewhat limited, and the experimental comparison is unclear, as are some parts of the methodology. What is the ranking of this paper in your review stack? 4 Number of papers in your stack 4 Reviewer confidence Confident but not absolutely certain Meta-Review(s) Primary Meta-Review Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal. This paper tackles the issue of class imbalance for medical image classificaiton using contrastive learning. The paper seems well written for the most part. However, there are a few clarifications that need to addressed in the final manuscript regarding: including relevant references as suggested by the reviewers discussion on trends observed in results clarification about figures requested by reviewers other writing clarifications requested by reviewers What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers). 2 Author Feedback We will revise the text to avoid the sources of confusion spotted by some reviewers, extend the related work section to refer to previous works mentioned by reviewer 3, and will discuss the points that were highlighted by the reviewers and that we addressed in the detailed response below. We must see how we balance these extensions with the other content because of the rather tight page limit. The method is not new: The supervised contrastive loss itself is not new, but its value for classification under data imbalance has not been studied before and our paper focuses specifically on this aspect. Moreover, data imbalance is often ignored in medical imaging, and we highlight its relevance and strategies to fight it. The reviewer is right in the sense that we do not present a new fundamental method, but the paper contributes scientific insights on class imbalance and how to best work with it. We will include the relevant references suggested by reviewer 3. Methodology: How are positives and negatives defined? How does oversampling work? Both questions are addressed in Section 3. We will reformulate the definition of positives and negatives and will fix the typo mentioned by reviewer 3. Given a sample image, all other images of the same class in the same batch build the set of positives while all images in the batch that belong to a different class form the set of negatives. Oversampling creates copies from samples of the underrepresented classes, so that the classes are balanced. Why do we not consider another diabetic retinopathy related dataset? Since we are mainly interested in validating the concept, we chose to evaluate on two datasets belonging to different domains. In this way, we guarantee that the reported benefit is due to the method and not to a domain-specific cue. Studying the generalization across datasets from the same domain remains an interesting aspect for further investigation. Since we will provide the code, the approach can be run on other datasets, also non-public ones. Sensitivity of accuracy metric to class imbalance We agree that the formulation of the statement can be confusing and will reformulate it. We meant exactly the same as the reviewer gives as example. There are different improvements on the two datasets in comparison with DANIL, OHEM, MTL and CANet. We point out that all those methods start from a backbone pretrained on ImageNet. Therefore, their performance depends on how well ImageNet fits to the target domain. All those methods fail to even outperform the baseline on ISIC18, while they give a significant improvement on APTOS19. Our method does not have this dependency on a matching pretraining dataset. It rather learns domain specific features from scratch and performs on par or better than those methods. Why does resampling harm the performance in Table 2? We think the drop in performance on APTOS19 is mainly due to the small size of the dataset. Thus, making copies from the very few samples results in overfitting to those. Why is there a decrease in performance for the class of lowest frequency? Our method does not give any guarantee of improvement for all the classes. Given that the 4 least frequent classes have roughly the same number of samples, we get the expected behavior for 3 of them. For all 5 non-major classes that get improved, the improvement is higher than for the majority class. Missing classwise performance on APTOS19: Due to limited space, we present the classwise performance for ISIC18 only. It is more relevant since it is larger, has more classes and has stronger data imbalance. Moreover, we get the same behavior for both datasets. Why is there no comparison to [21]? Since the idea of Huang et al. [21] is an extension of the triplet loss, which has been clearly outperformed by many recent methods, we restricted the comparison to LDAM, one of the most powerful recent methods that relies on a similar concept. back to top","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<meta
  name="keywords"
  content="Marrakchi, Yassine,Makansi, Osama,Brox, Thomas" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<link
  rel="alternate"
  type="application/rss+xml"
  title="MICCAI 2021 - Accepted Papers and Reviews - "
  href="kittywong/feed.xml" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/base.css" />
<link
  rel="stylesheet"
  type="text/css"
  href="kittywong/assets/css/highlight.css" />

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async>
</script>


<script src="/assets/scripts/jekyllpaper.js" async></script>
<script
  src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"
  onload="javascript:loadMermaid();"
  async>
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
    //,
    //displayAlign: "left",
    //displayIndent: "2em"
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  </head>
  <body>
    <div class="container-wrapper">
      <header class="container-header">
        <div class="header-info">
  <!-- Added by Elvis Chen -->
  <img src="https://kittywong.github.io/assets/images/miccai2021header.jpg" alt="MICCAI banner">
  <!-- END Added by Elvis Chen -->
  <span class="header-info-name">MICCAI 2021 - Accepted Papers and Reviews</span>
  <span class="header-info-desc"></span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
    <h2>
    
    <li class="header-main-nav-item">
      <a href="kittywong/">
        
          <b>List of Papers</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/categories">
        
          <b>By topics</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/tags">
        
          <b>Author List</b>
        
      </a>
    </li>
      
    <li class="header-main-nav-item">
      <a href="kittywong/about">
        
          <b>About</b>
        
      </a>
    </li>
      
    </h2>
  </ul>
</nav>
      </header>
      <main class="container-main">
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<article class="container-post">
  <div class="post-title">
    <h1><span style="color:#1040a7"><b>Fighting Class Imbalance with Contrastive Learning</b></span></h1>
  </div>
  
  <div class="post-author print-post-author">
    <span>Kitty K. Wong</span>
  </div>
  <hr>
    
   
  <div class="post-content">
    <!--
    <div class="post-categories">
      <h2><span style="color:#1040a7">Paper Topic(s):</span></h2> 
      
      
      <a 
        href="kittywong/categories#Machine Learning - Interpretability / Explainability"
        class="post-category">
        Machine Learning - Interpretability / Explainability
      </a>
      
      <a 
        href="kittywong/categories#Clinical applications - Dermatology"
        class="post-category">
        Clinical applications - Dermatology
      </a>
      
      <a 
        href="kittywong/categories#Clinical applications - Ophthalmology"
        class="post-category">
        Clinical applications - Ophthalmology
      </a>
      
    
    </div>
    <div class="post-tags">
      
      <h2><span style="color:#1040a7">Author(s):</span></h2> 
      
      <a href="kittywong/tags#Marrakchi, Yassine"
        class="post-tags">
        Marrakchi, Yassine
      </a> |  
      
      <a href="kittywong/tags#Makansi, Osama"
        class="post-tags">
        Makansi, Osama
      </a> |  
      
      <a href="kittywong/tags#Brox, Thomas"
        class="post-tags">
        Brox, Thomas
      </a> |  
      
    </div>
  -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

    .sidenav {
      width: 200px;
      position: fixed;
      z-index: 1;
      top: 150px;
      left: 50px;
      background: #eee;
      overflow-x: hidden;
      padding: 0px 0;
    }
  
    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 16px;
      color: #2196F3;
      color: #FF4500;
      display: block;
    }
  
    .sidenav a:hover {
      color: #064579;
    }
    </style>
  </head>

  <div class="sidenav">
    <a href="#author-id">Paper Info</a>
    <a href="#review-id">Reviews</a>
    <a href="#metareview-id">Meta-Review(s)</a>
    <a href="#authorFeedback-id">Author Feedback</a>
    <a href="">Back to top</a>
    <a href="https://kittywong.github.io">Back to List of papers</a>
  </div>

    <table>
  <tbody>
    <tr>
      <td><a href="#author-id"><span style="color:#ff9900"><b>Paper Info</b></span></a></td>
      <td><a href="#review-id"><span style="color:#ff9900"><b>Reviews</b></span></a></td>
      <td><a href="#metareview-id"><span style="color:#ff9900"><b>Meta-review(s)</b></span></a></td>
      <td><a href="#authorFeedback-id"><span style="color:#ff9900"><b>Author Feedback</b></span></a></td>
    </tr>
  </tbody>
</table>

<h1 id="author-id">Authors</h1>
<p>Yassine Marrakchi, Osama Makansi, Thomas Brox
<br /><br /></p>

<h1 id="abstract-id">Abstract</h1>
<p>Medical image datasets are hard to collect, expensive to label, and often highly imbalanced. The last issue is underestimated, as typical average metrics hardly reveal that the often very important minority classes have a very low accuracy. In this paper, we address this problem by a feature embedding that balances the classes using contrastive learning as an alternative to the common cross-entropy loss. The approach is largely orthogonal to existing sampling methods and can be easily combined with those.  We show on the challenging ISIC2018 and APTOS2019 datasets that the approach improves especially the accuracy of minority classes without negatively affecting the majority ones. 
<br /><br /></p>

<h1 id="link-id">Link to paper</h1>
<p><a href="https://doi.org/10.1007/978-3-030-87199-4_44">https://doi.org/10.1007/978-3-030-87199-4_44</a>
<br /><br /></p>

<h1 id="code-id">Link to the code repository</h1>
<p>https://github.com/YMarrakchi/CICL
<br /><br /></p>

<h1 id="dataset-id">Link to the dataset(s)</h1>
<p>https://www.kaggle.com/c/aptos2019-blindness-detection/data
https://isic-challenge-data.s3.amazonaws.com/2018/ISIC2018_Task3_Training_Input.zip
<br /><br /></p>

<hr />
<h1 id="review-id">Reviews</h1>

<h3 id="review-1">Review #1</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>The authors address the problem of imbalanced distribution of classes in medical datasets. They propose a framework based on contrastive learning to better arrange the feature space for minority and majority classes. The feature space is explicitly separated into different clusters by minimizing the distance between samples from the same class and maximizing the distance between samples from different classes. The proposed method was evaluated on the ISIC2018 lesion diagnosis dataset which contains 7 predefined categories and on the APTOS2019 diabetic retinopathy dataset which contains 5 classes. A comparison with different model-based approaches used for addressing the imbalanced classes was also performed.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <p>The paper is well written and well organized.
The implementation details are well described.
The validation protocol is appropriate and a quantitative evaluation was performed on two different datasets for different applications; skin lesion classification and diabetic retinopathy grading. The results were well discussed.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <p>Relevant details are missing in the description of the methodology. How the positive samples and the negative ones are generated in each batch?
For the oversampling strategy, how the original dataset is extended from minority classes to get an artificially balanced dataset?
Diabetic Retinopathy has been widely researched and there are many more DR-related dataset (FGADR,Messidor, EyePacs…) that could have been used to evaluate the ability of the proposed architecture to generalize on other datasets.
The improvement of the F-score evaluation on the minority classes of diabetic retinopathy is missing.
Overall, the improvement of the accuracy with respect to the baseline and the previous methods is not significant.</p>

    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Very Good</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <p>The implementation details are included in the paper.</p>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <p>The comparison with the baseline should include a quantitative evaluation of the accuracy on the minority classes in the two datasets.
The authors should justify why the resampling harms the performance as shown in table 2.
The authors claim that the performance of the proposed method is much better than the cross-entropy baseline across all classes but it is not clear from Figure 3.</p>

    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>borderline accept (6)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>The contribution is not original and the results are not convincing.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>2</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>5</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Very confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-2">Review #2</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>Address the imbalanced datasets by using novel contrastive learning framework to better arrange feature space while accounting for majority/minority classes.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ul>
        <li>Excellent introduction clearly setting up problem, need, and solution</li>
        <li>Great overview of previous work to provide context.</li>
        <li>Intuitive approach, well-explained difference between contrastive and cross-entropy loss training</li>
        <li>Reasonable experimental design with different permutations and comparative strategies</li>
        <li>Results show clear advantages conferred via CL training in different settings and different classes</li>
        <li>Intuitive results from ablation study</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <ul>
        <li>Fig 2 could be a little more intuitive in illustrating the flow</li>
        <li>No statistical testing reported</li>
        <li>Improvements over comparative strategies appear minor</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Excellent</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <ul>
        <li>Data and code will be made available.</li>
        <li>Detailed design and settings</li>
        <li>No statistical analysis</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <ul>
        <li>Are there significant differences in performance in Table 2 and 3?</li>
        <li>Please fix Table 2 to be consistent with decimals/scientific notation</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>strong accept (9)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>Well written, comprehensive experiments to validate approach. While resulting improvements are marginal, core idea is of interest and addressing a key problem.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>1</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Very confident</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<h3 id="review-3">Review #3</h3>

<ul>
  <li><strong>Please describe the contribution of the paper</strong>
    <blockquote>
      <p>This paper studies the problem of image classification under class imbalances, in particular in the setting of dermatology, and proposes a method based on a representation learning with contrastive learning followed by a standard classifier.</p>
    </blockquote>
  </li>
  <li><strong>Please list the main strengths of the paper; you should write about a novel formulation, an original way to use data, demonstration of clinical feasibility, a novel application, a particularly strong evaluation, or anything else that is a strong aspect of this work. Please provide details, for instance, if a method is novel, explain what aspect is novel and why this is interesting.</strong>
    <blockquote>
      <ul>
        <li>The problem addressed in this manuscript is timely and important</li>
        <li>The presented solution is intuitive, building on extensions of other literature</li>
      </ul>

    </blockquote>
  </li>
  <li><strong>Please list the main weaknesses of the paper. Please provide details, for instance, if you think a method is not novel, explain why and provide a reference to prior work.</strong>
    <blockquote>
      <ul>
        <li>The paper strongly argues that learning under class imbalances has not been greatly studied. While I agree that more work is needed (and this manuscript contributes to that), there’s extensive work that the authors would like to refer to. Besides the works the authors mention, there exist a another approach to learning in these settings, basically by minimizing a loss that is not sensitive to the class imbalance (such as the AUC). See e.g. Zhao, Peilin, et al. “Online AUC maximization.” (2011): 233., and Wang, Guanjin, Kok Wai Wong, and Jie Lu. “AUC-based extreme learning machines for supervised and semi-supervised imbalanced classification.” IEEE Transactions on Systems, Man, and Cybernetics: Systems (2020).</li>
        <li>Parts of the manuscript are unclear. For example, the text around Eq. (1) that explains their approach is confusing. E.g. “z_i is the normalized feature vector of an image x_i, c_i is the positive set for sample i and corresponds to all samples in the batch with the same class label as i’. I’m confused as to the meaning of “sample i”: is it the image x_i? is it a batch of examples?</li>
        <li>The numerical results are somewhat unclear: While the proposed method seems to provide benefits in one of the studied datasets, in the other their method does not improve on methods which do not explicitly try to compensate for class imbalance. More importantly, the authors argue that their method provides greater advantage for the minority class, in Figure 3. However, this does not appear to be the case: the largest improvements are obtained for some of the majority classes; and in fact for the most extreme minority case, the method deteriorates w.r.t. to the baseline which does not compensate for class imbalance, which is very strange.</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please rate the clarity and organization of this paper</strong>
    <blockquote>
      <p>Satisfactory</p>
    </blockquote>
  </li>
  <li><strong>Please comment on the reproducibility of the paper. Note, that authors have filled out a reproducibility checklist upon submission. Please be aware that authors are not required to meet all criteria on the checklist - for instance, providing code and data is a plus, but not a requirement for acceptance</strong>
    <blockquote>
      <ul>
        <li>Based on my comments regarding the lack of clarity on the presentation of their method, I believe that the potential for reproducibility is only mild, so implementation details (in terms of hyperparameters and training details) are provided.</li>
      </ul>

    </blockquote>
  </li>
  <li><strong>Please provide detailed and constructive comments for the authors. Please also refer to our Reviewer’s guide on what makes a good review: <a href="https://miccai2021.org/en/REVIEWER-GUIDELINES.html">https://miccai2021.org/en/REVIEWER-GUIDELINES.html</a></strong>
    <blockquote>
      <ul>
        <li>I think the work in [21, in authors’ references] is the conceptually the closest to this work. Is there a reason the authors chose not to compare with them?</li>
        <li>The difference in general trends among the two datasets is somewhat surprising. Can the authors provide more details about the level of imbalance in one and other case?</li>
        <li>The authors comment that “Besides the common average accuracy metric which is not sensitive to data imbalance…”. This comment is probably inaccurate, as accuracy is precisely very sensitive to class imbalance (consider e.g. the case where a minority, negative, class is simply 1% of the sample, and a constant classifier that predicts always the majority, positive, class).</li>
        <li>The authors talk about “disentanglement” in the learned representations. The authors might want to rephrase this, as disentanglement is typically used to refer to representations where input features are coded by almost independent components in feature space, and not just a class separation. See e.g. Tran, Luan, Xi Yin, and Xiaoming Liu. “Disentangled representation learning gan for pose-invariant face recognition.” Proceedings of the IEEE conference on computer vision and pattern recognition. 2017.</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>Please state your overall opinion of the paper</strong>
    <blockquote>
      <p>probably reject (4)</p>
    </blockquote>
  </li>
  <li><strong>Please justify your recommendation. What were the major factors that led you to your overall score for this paper?</strong>
    <blockquote>
      <p>The novelty of the approach is somewhat limited, and the experimental comparison is unclear, as are some parts of the methodology.</p>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your review stack?</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Number of papers in your stack</strong>
    <blockquote>
      <p>4</p>
    </blockquote>
  </li>
  <li><strong>Reviewer confidence</strong>
    <blockquote>
      <p>Confident but not absolutely certain</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="metareview-id">Meta-Review(s)</h1>

<h2 id="primary-meta-review">Primary Meta-Review</h2>
<ul>
  <li><strong>Please provide your assessment of this work, taking into account all reviews. Summarize the key strengths and weaknesses of the paper and justify your recommendation. In case you deviate from the reviewers’ recommendations, explain in detail the reasons why. In case of an invitation for rebuttal, clarify which points are important to address in the rebuttal.</strong>
    <blockquote>
      <p>This paper tackles the issue of class imbalance for medical image classificaiton using contrastive learning. The paper seems well written for the most part. However, there are a few clarifications that need to addressed in the final manuscript regarding:</p>
      <ul>
        <li>including relevant references as suggested by the reviewers</li>
        <li>discussion on trends observed in results</li>
        <li>clarification about figures requested by reviewers</li>
        <li>other writing clarifications requested by reviewers</li>
      </ul>
    </blockquote>
  </li>
  <li><strong>What is the ranking of this paper in your stack? Use a number between 1 (best paper in your stack) and n (worst paper in your stack of n papers).</strong>
    <blockquote>
      <p>2</p>
    </blockquote>
  </li>
</ul>

<p><br /><br /></p>

<hr />
<h1 id="authorFeedback-id">Author Feedback</h1>
<blockquote>
  <p>We will revise the text to avoid the sources of confusion spotted by some reviewers, extend the related work section to refer to previous works mentioned by reviewer 3, and will discuss the points that were highlighted by the reviewers and that we addressed in the detailed response below. We must see how we balance these extensions with the other content because of the rather tight page limit.</p>

  <ul>
    <li>
      <p>The method is not new:
The supervised contrastive loss itself is not new, but its value for  classification under data imbalance has not been studied before and our paper focuses specifically on this aspect. Moreover, data imbalance is often ignored in medical imaging, and we highlight its relevance and strategies to fight it. The reviewer is right in the sense that we do not present a new fundamental method, but the paper contributes scientific insights on class imbalance and how to best work with it. We will include the relevant references suggested by reviewer 3.</p>
    </li>
    <li>
      <p>Methodology: How are positives and negatives defined? How does oversampling work?
Both questions are addressed in Section 3. We will reformulate the definition of positives and negatives and will fix the typo mentioned by reviewer 3.<br />
Given a sample image, all other images of the same class in the same batch build the set of positives while all images in the batch that belong to a different class form the set of negatives. Oversampling creates copies from samples of the underrepresented classes, so that the classes are balanced.</p>
    </li>
    <li>
      <p>Why do we not consider another diabetic retinopathy related dataset?
Since we are mainly interested in validating the concept, we chose to evaluate on two datasets belonging to different domains. In this way, we guarantee that the reported benefit is due to the method and not to a domain-specific cue. Studying the generalization across datasets from the same domain remains an interesting aspect for further investigation. Since we will provide the code, the approach can be run on other datasets, also non-public ones.</p>
    </li>
    <li>
      <p>Sensitivity of accuracy metric to class imbalance
We agree that the formulation of the statement can be confusing and will reformulate it. We meant exactly the same as the reviewer gives as example.</p>
    </li>
    <li>
      <p>There are different improvements on the two datasets in comparison with DANIL, OHEM, MTL and CANet. 
We point out that all those methods start from a backbone pretrained on ImageNet. Therefore, their performance depends on how well ImageNet fits to the target domain. All those methods fail to even outperform the baseline on ISIC18, while they give a significant improvement on APTOS19. Our method does not have this dependency on a matching pretraining dataset. It rather learns domain specific features from scratch and performs on par or better than those methods.</p>
    </li>
    <li>
      <p>Why does resampling harm the performance in Table 2?
We think the drop in performance on APTOS19 is mainly due to the small size of the dataset. Thus, making copies from the very few samples results in overfitting to those.</p>
    </li>
    <li>
      <p>Why is there a decrease in performance for the class of lowest frequency?
Our method does not give any guarantee of improvement for all the classes. Given that the 4 least frequent classes have roughly the same number of samples, we get the expected behavior for 3 of them. For all 5 non-major classes that get improved, the improvement is higher than for the majority class.</p>
    </li>
    <li>
      <p>Missing classwise performance on APTOS19: 
Due to limited space, we present the classwise performance for ISIC18 only.  It is more relevant since it is larger, has more classes and has stronger data imbalance. Moreover, we get the same behavior for both datasets.</p>
    </li>
    <li>
      <p>Why is there no comparison to [21]?
Since the idea of Huang et al. [21] is an extension of the triplet loss, which has been clearly outperformed by many recent methods, we restricted the comparison to LDAM, one of the most powerful recent methods that relies on a similar concept.</p>
    </li>
  </ul>

</blockquote>

<p><br /><br />
<a href=""><span style="color:#ff9900"><b>back to top</b></span></a></p>

<hr />


  </div>

  <div class="post-info">
    <!--
    <div class="post-date">
      Poster presentation date:  
      0343-12-31
      -->
      <!--
      
        ,
        updated at 
        0344-01-01
      
      .
      
    </div>
    -->
    <!--
    
    <div class="post-author">
      Author: Kitty K. Wong
    </div>
    
    -->
    <div class="post-categories">
      <span><b>Topic(s): </b></span>
      
      <a 
        href="kittywong/categories#Machine Learning - Interpretability / Explainability"
        class="post-category">
        Machine Learning - Interpretability / Explainability
      </a> |
      
      <a 
        href="kittywong/categories#Clinical applications - Dermatology"
        class="post-category">
        Clinical applications - Dermatology
      </a> |
      
      <a 
        href="kittywong/categories#Clinical applications - Ophthalmology"
        class="post-category">
        Clinical applications - Ophthalmology
      </a> |
      
    </div>
    <div class="post-tags">
      <!--<span>Author List</span>-->
      <span><b> Author(s): </b></span>
      
      <a href="kittywong/tags#Marrakchi, Yassine"
        class="post-category">
        Marrakchi, Yassine
      </a> |  
      
      <a href="kittywong/tags#Makansi, Osama"
        class="post-category">
        Makansi, Osama
      </a> |  
      
      <a href="kittywong/tags#Brox, Thomas"
        class="post-category">
        Brox, Thomas
      </a> |  
      
    </div>
    <div class="post-other">
      
      <div>
        <span><b>
          Next paper: 
        </b>
        </span>
        <a href="/0344/12/31/Paper1243">
          Interpretable gender classification from retinal fundus images using BagNets
        </a>
      </div>
      
      
      <div>
        <span><b>
          Previous paper: 
        </b>
        </span>
        <a href="/0342/12/31/Paper0996">
          The Power of Proxy Data and Proxy Networks for Hyper-Parameter Optimization for Medical Image Segmentation
        </a>
      </div>
      
    </div>
    
  </div>
</article>

      </main>
      <footer class="container-footer">
        <div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. Kitty K. Wong, The MICCAI Society
  </span>
</div>
<!--
<div class="footer-copyright">
  <span class="footer-copyright-text float-left">
    Copyright &copy; 2021. example.com.
  </span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>, themed by <a href="https://github.com/ghosind/Jekyll-Paper-Github">Jekyll-Paper-Github</a>.
  </span>
</div>
-->

      </footer>
    </div>
  </body>
</html>
